"use strict";(self.webpackChunkidle_dashboard_new=self.webpackChunkidle_dashboard_new||[]).push([[1973,2734,6124],{63330:function(e,t,n){n.r(t),n.d(t,{AssetPage:function(){return U},useAssetPageProvider:function(){return Z}});var a=n(1413),s=n(29439),i=n(76566),r=n(16120),o=n(95173),l=n(98428),c=n(66288),d=n(67041),u=n(3717),p=n(86698),m=n(61617),x=n(29482),f=n(97901),g=n(96362),v=n(15542),h=n(98365),j=n(85267),b=n(1669),y=n(75712),S=n(7276),C=n(20910),k=n(61925),w=n(88089),A=n(3498),M=n(37658),T=n(28645),I=n(45263),D={stakingEnabled:!1,setStakingEnabled:function(){},toggleStakingEnabled:function(){}},E=function(){var e=(0,b.w)().selectors,t=e.selectVaultsByType,n=e.selectAssetById,a=(0,S.useMemo)((function(){var e;return t&&(null===(e=t("STK"))||void 0===e?void 0:e[0])}),[t]),s=(0,S.useMemo)((function(){return n&&a&&n(a.id)}),[n,a]);return(0,I.jsx)(y.AssetProvider,{wrapFlex:!1,assetId:s.id,children:(0,I.jsx)(d.Stake,{itemIndex:0,chainIds:[T.zS]})})},P=S.createContext(D),Z=function(){return S.useContext(P)},U=function(){var e=(0,o.s0)(),t=(0,c.X)(),n=t.isMobile,d=t.environment,D=(0,j.m)(),Z=D.params,U=D.location,z=D.searchParams,F=(0,S.useState)(0),Y=(0,s.Z)(F,2),_=Y[0],O=Y[1],B=(0,S.useState)(!1),L=(0,s.Z)(B,2),N=L[0],H=L[1],G=(0,S.useState)(0),q=(0,s.Z)(G,2),R=q[0],V=q[1],W=(0,S.useState)(),K=(0,s.Z)(W,2),X=K[0],$=K[1],Q=(0,S.useMemo)((function(){return z}),[z]),J=(0,s.Z)(Q,2),ee=J[0],te=J[1],ne=(0,S.useState)({startDate:null,endDate:null}),ae=(0,s.Z)(ne,2),se=ae[0],ie=ae[1],re=(0,S.useState)(T.WE["6MONTHS"]),oe=(0,s.Z)(re,2),le=oe[0],ce=oe[1],de=(0,S.useMemo)((function(){return!!se.startDate&&!!se.endDate}),[se]);(0,S.useEffect)((function(){de&&ce(void 0)}),[de,ce]),(0,S.useEffect)((function(){le&&ie({endDate:null,startDate:null})}),[le,ie]);var ue=(0,b.w)(),pe=ue.isPortfolioLoaded,me=ue.portfolioTimestamp,xe=ue.assetsDataTimestamp,fe=ue.isPortfolioAccountReady,ge=ue.selectors,ve=ge.selectAssetById,he=ge.selectVaultById,je=ge.selectVaultGauge,be=ge.selectAssetBalance,ye=ge.selectAssetPriceUsd,Se=(0,S.useMemo)((function(){return ve&&ve(Z.asset)}),[ve,Z.asset]),Ce=(0,S.useMemo)((function(){return he&&he(Z.asset)}),[he,Z.asset]),ke=(0,S.useCallback)((function(){return H((function(e){return!e}))}),[H]);(0,S.useEffect)((function(){Se&&V(Date.now())}),[Se]);var we=(0,S.useMemo)((function(){if(!Se||!be||null===Se||void 0===Se||!Se.underlyingId||!ye)return(0,C.gA)(0);var e=be(Se.underlyingId),t=ye(Se.underlyingId);return(0,C.d5)(e).times((0,C.d5)(t))}),[Se,be,ye]),Ae=(0,S.useMemo)((function(){return je&&je(Z.asset)}),[je,Z.asset]),Me=(0,S.useMemo)((function(){return Ae&&ve&&ve(Ae.id)}),[ve,Ae]),Te=(0,S.useMemo)((function(){var e;return Me&&"gaugeData"in Me&&null!==(e=Me.gaugeData)&&void 0!==e&&e.rewards?Object.values(Me.gaugeData.rewards).reduce((function(e,t){return e.plus((0,C.d5)(t.balance))}),(0,C.gA)(0)):(0,C.gA)(0)}),[Me]);(0,S.useEffect)((function(){if(pe&&ve&&U&&R)return Se?void 0:e(U.pathname.replace("/".concat(Z.asset),""))}),[pe,ve,R,Se,Z.asset,U,e]),(0,S.useEffect)((function(){!(fe&&Se&&X!==(null===Se||void 0===Se?void 0:Se.id)&&me&&xe)||me>xe||xe>R||((0,C.AV)(Se,we),$(Se.id))}),[Se,me,we,xe,fe,R,X,$]);var Ie=(0,S.useMemo)((function(){var e=[{type:"deposit",component:f.Deposit,label:"common.deposit",steps:[{type:"approve",component:g.Approve,label:"modals.approve.header"}]},{type:"withdraw",label:"common.withdraw",component:h.Withdraw,steps:[]}];N&&e.push({type:"stake",component:E,label:"common.stake",chainIds:[T.zS],steps:[{type:"approve",component:g.Approve,props:{amountUsd:null},label:"modals.approve.header"}]});var t=[{id:"earn",label:"navBar.earn",component:i.Earn,actions:e}],n=Ae&&"enabled"in Ae&&!Ae.enabled;Ae&&(!n||(0,C.d5)(null===Me||void 0===Me?void 0:Me.balance).gt(0)||(0,C.d5)(Te).gt(0))&&t.push({id:"gauge",label:"navBar.gauge",component:r.GaugeStaking,icon:n&&((0,C.gA)(null===Me||void 0===Me?void 0:Me.balance).gt(0)||(0,C.d5)(Te).gt(0))?{src:"".concat(T.pm,"vaults/deprecated.png"),tooltip:"trade.vaults.GG.disabled",props:{width:5,height:5}}:null,actions:[{type:"stake",component:f.Deposit,label:"common.stake",steps:[{type:"approve",component:g.Approve,label:"modals.approve.header"}]},{type:"unstake",label:"common.unstake",component:h.Withdraw,steps:[]}]});var a=!(null!==Ce&&void 0!==Ce&&Ce.flags)||void 0===Ce.flags.statsEnabled||Ce.flags.statsEnabled;return(0,C.xW)("stats",d)&&a&&t.push({id:"stats",label:"navBar.stats",component:p.AssetStats,componentProps:{timeframe:le,dateRange:se,assetOnly:!0,showHeader:!1,showAssetStrategy:!0}}),t}),[Ce,Ae,Me,le,se,d,Te,N]),De=(0,S.useMemo)((function(){return ee.get("tab")}),[ee]);(0,S.useEffect)((function(){if(De){var e=Ie.find((function(e){return e.id.toString()===De.toString()}));if(e){var t=Ie.indexOf(e);O(t)}else O(0)}else O(0)}),[Ie,De,O]);var Ee=(0,S.useMemo)((function(){return Ie[_]&&"gauge"===Ie[_].id&&Ae?Ae.id:null===Se||void 0===Se?void 0:Se.id}),[Ie,_,Se,Ae]),Pe=(0,S.useMemo)((function(){return Ie[_]}),[Ie,_]),Ze=(0,S.useMemo)((function(){return Pe.component}),[Pe]),Ue=(0,S.useCallback)((function(e){var t=Ie[e];t&&te("?tab=".concat(t.id))}),[Ie,te]),ze=(0,S.useMemo)((function(){return(0,I.jsx)(w.mQ,{variant:"unstyled",index:_,width:["100%","auto"],children:(0,I.jsx)(w.td,{children:Ie.map((function(e,t){return(0,I.jsx)(l.IconTab,{width:["".concat(100/Ie.length,"%"),"auto"],icon:e.icon,onClick:function(){return Ue(t)},children:(0,I.jsx)(v.Translation,{translation:e.label})},"tab_".concat(t))}))})})}),[Ie,Ue,_]),Fe=(0,S.useMemo)((function(){return Pe.actions?(0,I.jsx)(M.InteractiveComponent,{vaultId:null===Se||void 0===Se?void 0:Se.id,assetId:Ee,actions:Pe.actions}):null}),[Pe,Se,Ee]),Ye=(0,S.useMemo)((function(){return(0,I.jsxs)(A.Ug,{mb:[0,"3 !important"],spacing:4,pl:[0,"stats"===Pe.id?5:0],justifyContent:["center","flex-end"],borderLeft:n||"stats"!==Pe.id?"none":"1px solid",borderLeftColor:"divider",children:[(0,I.jsxs)(A.Ug,{spacing:1,children:[(0,I.jsx)(x.ProductTag,{type:null===Se||void 0===Se?void 0:Se.type,fontSize:"md",h:8}),(0,I.jsx)(y.AssetProvider.Strategies,{h:8,w:8})]}),(0,I.jsx)(A.Ug,{pl:4,borderLeft:"1px solid",borderLeftColor:"divider",children:(0,I.jsx)(y.AssetProvider.Protocols,{tooltipDisabled:!0,size:"sm",children:(0,I.jsx)(y.AssetProvider.ProtocolIcon,{size:"sm"})})})]})}),[Pe,Se,n]),_e=(0,S.useMemo)((function(){return(0,I.jsxs)(A.Kq,{spacing:[0,5],direction:["column","row"],children:["stats"===Pe.id&&(0,I.jsxs)(A.Kq,{spacing:2,mt:[3,"-15px"],width:["full","auto"],direction:["column","row"],alignItems:["auto","center"],justifyContent:["flex-start","center"],children:[(0,I.jsx)(k.TimeframeSelector,{variant:"button",timeframe:le,setTimeframe:ce,width:["100%","auto"],justifyContent:["center","initial"]}),(0,I.jsx)(u.DatePicker,{selected:de,setDateRange:ie})]}),!n&&Ye]})}),[Pe,n,le,ce,de,ie,Ye]);return(0,I.jsx)(P.Provider,{value:{stakingEnabled:N,setStakingEnabled:H,toggleStakingEnabled:ke},children:(0,I.jsx)(y.AssetProvider,{wrapFlex:!0,assetId:Z.asset,children:(0,I.jsxs)(A.xu,{width:"100%",children:[(0,I.jsx)(A.kC,{my:[10,14],width:"100%",id:"asset-top-header",direction:["column","row"],justifyContent:["center","space-between"],children:(0,I.jsxs)(A.Kq,{width:"100%",spacing:[4,8],alignItems:"center",justifyContent:"center",direction:["column","row"],children:[(0,I.jsxs)(A.Ug,{spacing:2,alignItems:"center",children:[(0,I.jsx)(m.AssetLabel,{assetId:Z.asset,fontSize:"h2"}),(0,I.jsx)(y.AssetProvider.ChainIcon,{width:6,height:6})]}),n&&Ye,(0,I.jsxs)(A.Kq,{flex:1,spacing:0,width:["100%","auto"],justifyContent:"space-between",borderBottom:[0,"1px solid"],direction:["column","row"],borderColor:["divider","divider"],children:[(0,I.jsx)(A.Ug,{width:["full","auto"],borderBottom:["1px solid",0],borderColor:"divider",children:ze}),_e]})]})}),(0,I.jsxs)(A.Ug,{width:"100%",spacing:[0,10],alignItems:"space-between",children:[(0,I.jsx)(A.Kq,{flex:1,mb:[20,0],spacing:10,width:["100%",.7],children:(0,I.jsx)(Ze,(0,a.Z)({},Ie[_].componentProps))}),Fe]})]})})})}},16120:function(e,t,n){n.r(t),n.d(t,{GaugeStaking:function(){return h}});var a=n(29439),s=n(54447),i=n(28645),r=n(86059),o=n(7276),l=n(15542),c=n(1669),d=n(85267),u=n(20910),p=n(75712),m=n(3148),x=n(72258),f=n(3498),g=n(30422),v=n(45263),h=function(){var e,t,n,h,j,b=(0,d.m)().params,y=(0,o.useState)(0),S=(0,a.Z)(y,2),C=S[0],k=S[1],w=(0,o.useState)(),A=(0,a.Z)(w,2),M=A[0],T=A[1],I=(0,c.w)(),D=I.portfolioTimestamp,E=I.assetsDataTimestamp,P=I.isPortfolioAccountReady,Z=I.selectors,U=Z.selectAssetById,z=Z.selectVaultGauge,F=Z.selectAssetBalance,Y=Z.selectAssetPriceUsd,_=(0,o.useMemo)((function(){return U&&U(b.asset)}),[U,b.asset]),O=(0,o.useMemo)((function(){return _&&z&&z(_.id)}),[z,_]),B=(0,o.useMemo)((function(){return U&&O&&U(O.id)}),[O,U]),L=(0,o.useMemo)((function(){return Object.keys(i.A2).find((function(e){return i.A2[e].route===b.strategy}))}),[b]),N=(0,o.useMemo)((function(){return L&&i.A2[L].color}),[L]),H=(0,o.useMemo)((function(){if(!O)return null;var e=i.A2[O.type];return null!==e&&void 0!==e&&e.carouselItems?(0,v.jsx)(g.StrategyDescriptionCarousel,{color:N,strategy:O.type,delay:1e4}):null}),[O,N]),G=(0,o.useMemo)((function(){var e;return(null===B||void 0===B?void 0:B.vaultPosition)&&(0,u.gA)(null===B||void 0===B||null===(e=B.vaultPosition)||void 0===e?void 0:e.underlying.redeemable).div(B.totalSupply)}),[B]),q=(0,o.useMemo)((function(){if(!B||null===B||void 0===B||!B.underlyingId||!F||!Y)return(0,u.gA)(0);var e=F(B.underlyingId),t=Y(B.underlyingId);return(0,u.d5)(e).times((0,u.d5)(t))}),[B,F,Y]),R=(0,o.useMemo)((function(){return O&&"description"in O&&O.description?(0,v.jsx)(s.Card.Dark,{children:(0,v.jsx)(f.xv,{dangerouslySetInnerHTML:{__html:O.description}})}):null}),[O]);return(0,o.useEffect)((function(){B&&k(Date.now())}),[B]),(0,o.useEffect)((function(){!(P&&B&&M!==(null===B||void 0===B?void 0:B.id)&&D&&E)||D>E||E>C||((0,u.AV)(B,q),T(B.id))}),[B,D,q,E,P,C,M,T]),(0,v.jsxs)(f.gC,{spacing:10,width:"100%",children:[R,B.vaultPosition&&(0,v.jsx)(p.AssetProvider,{wrapFlex:!1,assetId:O.id,children:(0,v.jsxs)(f.MI,{width:"100%",columns:[2,4],spacing:[10,14],alignItems:"flex-start",children:[(0,v.jsxs)(f.gC,{spacing:2,justifyContent:"center",children:[(0,v.jsx)(l.Translation,{component:f.xv,translation:"defi.deposited",textStyle:"titleSmall"}),(0,v.jsxs)(f.Ug,{spacing:1,alignItems:"baseline",children:[(0,v.jsx)(p.AssetProvider.Deposited,{textStyle:"heading",fontSize:"h3"}),(0,v.jsx)(p.AssetProvider.Name,{textStyle:"heading",fontSize:"h3"})]})]}),(0,v.jsxs)(f.gC,{spacing:2,justifyContent:"center",children:[(0,v.jsx)(l.Translation,{component:f.xv,translation:"defi.share",textStyle:"titleSmall"}),(0,v.jsx)(p.AssetProvider.GaugeShare,{minValue:.01,textStyle:"heading",fontSize:"h3"})]}),(0,v.jsxs)(f.gC,{spacing:2,justifyContent:"center",children:[(0,v.jsx)(l.Translation,{component:f.xv,translation:"defi.idleDistribution",textStyle:"titleSmall"}),(0,v.jsxs)(f.Ug,{spacing:1,alignItems:"baseline",children:[(0,v.jsx)(p.AssetProvider.GaugeUserDistribution,{suffix:" ".concat(null===(e=O.rewardToken)||void 0===e?void 0:e.token),textStyle:"heading",fontSize:"h3"}),(0,v.jsx)(l.Translation,{component:f.xv,translation:["/","common.day"],textStyle:"captionSmall",textTransform:"lowercase"})]})]}),(0,v.jsxs)(f.gC,{spacing:2,justifyContent:"center",children:[(0,v.jsx)(l.Translation,{component:f.xv,translation:"defi.additionalRewards",textStyle:"titleSmall"}),(0,v.jsx)(f.gC,{spacing:2,children:(null===(t=O.multiRewardsTokens)||void 0===t?void 0:t.length)>0&&B.gaugeData?Object.keys(null===(n=B.gaugeData)||void 0===n?void 0:n.rewards).map((function(e){var t=B.gaugeData.rewards[e];if(e===O.rewardToken.address)return null;var n=U(e);return(0,v.jsxs)(f.Ug,{spacing:1,alignItems:"baseline",children:[(0,v.jsx)(r.Amount,{value:t.rate.times(G),suffix:" ".concat(n.token),textStyle:"heading",fontSize:"h3"}),(0,v.jsx)(l.Translation,{component:f.xv,translation:["/","common.day"],textStyle:"captionSmall",textTransform:"lowercase"})]},"reward_".concat(e))})):(0,v.jsx)(f.xv,{textStyle:"heading",fontSize:"h3",children:"-"})})]})]})}),(0,v.jsxs)(f.gC,{spacing:6,width:"100%",alignItems:"flex-start",children:[(0,v.jsx)(l.Translation,{component:f.X6,as:"h3",size:"md",translation:"defi.rewards"}),(0,v.jsx)(f.gC,{spacing:4,width:"100%",children:(0,u.xb)(null===(h=B.gaugeData)||void 0===h?void 0:h.rewards)?null:Object.keys(null===(j=B.gaugeData)||void 0===j?void 0:j.rewards).map((function(e){var t=B.gaugeData.rewards[e],n=O.getClaimRewardsContractSendMethod(e);return(0,v.jsx)(p.AssetProvider,{wrapFlex:!1,assetId:e,children:(0,v.jsx)(s.Card,{p:6,px:8,width:"100%",children:(0,v.jsxs)(f.Kq,{width:"100%",spacing:[4,0],alignItems:"center",direction:["column","row"],justifyContent:"space-between",children:[(0,v.jsxs)(f.MI,{width:"100%",spacing:[6,0],columns:[2,4],children:[(0,v.jsxs)(f.gC,{spacing:2,alignItems:"flex-start",justifyContent:"flex-start",children:[(0,v.jsx)(l.Translation,{component:f.xv,translation:"defi.asset",textStyle:"captionSmall"}),(0,v.jsx)(p.AssetProvider.GeneralData,{size:"xs",field:"asset"})]}),(0,v.jsxs)(f.gC,{spacing:2,alignItems:"flex-start",justifyContent:"flex-start",children:[(0,v.jsx)(l.Translation,{component:f.xv,translation:"defi.apy",textStyle:"captionSmall"}),(0,v.jsx)(r.Amount.Percentage,{textStyle:"tableCell",value:t.apr})]}),(0,v.jsxs)(f.gC,{spacing:2,alignItems:"flex-start",justifyContent:"flex-start",children:[(0,v.jsx)(l.Translation,{component:f.xv,translation:"defi.dailyDistribution",textStyle:"captionSmall"}),(0,v.jsxs)(f.Ug,{spacing:1,width:"100%",children:[(0,v.jsx)(r.Amount,{textStyle:"tableCell",value:t.rate}),(0,v.jsx)(p.AssetProvider.Name,{textStyle:"tableCell"})]})]}),(0,v.jsxs)(f.gC,{spacing:2,alignItems:"flex-start",justifyContent:"flex-start",children:[(0,v.jsx)(l.Translation,{component:f.xv,translation:"defi.claimable",textStyle:"captionSmall"}),(0,v.jsxs)(f.Ug,{spacing:1,width:"100%",children:[(0,v.jsx)(r.Amount,{textStyle:"tableCell",value:t.balance}),(0,v.jsx)(p.AssetProvider.Name,{textStyle:"tableCell"})]})]})]}),(0,v.jsx)(x.TransactionButton,{text:"defi.claim",vaultId:_.id,assetId:e,contractSendMethod:n,actionType:"claim",amount:t.balance.toString(),width:["100%","150px"],disabled:t.balance.lte(0)})]})})},"reward_".concat(e))}))})]}),(0,v.jsx)(m.AssetGeneralData,{assetId:null===O||void 0===O?void 0:O.id}),H]})}},98428:function(e,t,n){n.r(t),n.d(t,{IconTab:function(){return m}});var a=n(1413),s=n(7276),i=n(79681),r=n(88089),o=n(96699),l=n(43127),c=n(3498),d=n(70820),u=n(2092),p=n(45263),m=s.forwardRef((function(e,t){var n=(0,i.qM)(),s=(0,r.xD)((0,a.Z)((0,a.Z)({},e),{},{ref:t})),m=(0,o.jC)("Tabs",(0,a.Z)((0,a.Z)({},s),{},{variant:"unstyled"}));return(0,p.jsx)(l.zx,(0,a.Z)((0,a.Z)({background:"transparent",borderRadius:0,__css:m.tab},s),{},{children:(0,p.jsxs)(c.Ug,{spacing:2,width:"full",justifyContent:"center",children:[s.children,e.icon&&(0,p.jsx)(d.u,{hasArrow:!0,placement:"top",label:e.icon.tooltip?n(e.icon.tooltip):"",children:(0,p.jsx)(u.Ee,(0,a.Z)({src:e.icon.src},e.icon.props))})]})}))}))},52734:function(e,t,n){n.r(t),n.d(t,{InputDate:function(){return d}});var a=n(1413),s=n(45987),i=(n(7276),n(20910)),r=n(3498),o=n(3497),l=n(45263),c=["inputHeight","value","setValue"],d=function(e){var t=e.inputHeight,n=e.value,d=e.setValue,u=(0,s.Z)(e,c);return(0,l.jsx)(r.Ug,{width:"100%",justifyContent:"space-between",children:(0,l.jsx)(o.II,(0,a.Z)({type:"date",height:t,flex:1,placeholder:"",variant:"balance",value:n||"",onChange:function(e){var t=e.target.value,n=(0,i.qF)(t).isValid()?(0,i.qF)(t):null;d(n)}},u))})}},37658:function(e,t,n){n.r(t),n.d(t,{InteractiveComponent:function(){return m}});var a=n(29439),s=n(7276),i=n(55967),r=n(66288),o=n(15542),l=n(3498),c=n(43127),d=n(18147),u=n(4710),p=n(45263),m=function(e){var t=e.assetId,n=e.vaultId,m=e.actions,x=(0,r.X)().isMobile,f=(0,s.useState)(!1),g=(0,a.Z)(f,2),v=g[0],h=g[1],j=(0,s.useState)(!1),b=(0,a.Z)(j,2),y=b[0],S=b[1];return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)(l.gC,{left:0,zIndex:[40,0],spacing:[0,6],id:"right-side",width:["100vw","27em"],height:["100vh","auto"],position:["fixed","relative"],top:[v?0:"100vh",0],bg:x?"rgba(0, 0, 0, 0.5)":void 0,sx:x?{transition:"top 0.3s ease-in-out"}:{},children:[(0,p.jsxs)(l.gC,{bottom:0,spacing:0,width:"100%",height:["100vh","auto"],position:["fixed","relative"],top:[v?0:"100vh",0],sx:x?{transition:"top 0.3s ease-in-out"}:{},children:[x&&(0,p.jsxs)(l.Ug,{px:4,py:2,bg:"card.bg",width:"100%",borderBottom:"1px solid",borderBottomColor:"divider",justifyContent:"space-between",children:[(0,p.jsx)(o.Translation,{alignItems:"center",display:"flex",variant:"unstyled",translation:"common.exit",component:c.zx,leftIcon:(0,p.jsx)(i.sG8,{size:24}),onClick:function(){return h(!1)}}),(0,p.jsx)(o.Translation,{alignItems:"center",display:"flex",variant:"unstyled",translation:["common.show","navBar.transactions"],component:c.zx,onClick:function(){return S(!0)}})]}),(0,p.jsx)(u.OperativeComponent,{flex:1,minHeight:x?"auto":"590px",borderRadius:x?0:void 0,assetId:t,actions:m})]}),(0,p.jsxs)(l.gC,{flex:1,bottom:0,spacing:0,width:"100%",height:["100vh","auto"],position:["fixed","relative"],top:[y?0:"100vh",0],sx:x?{transition:"top 0.3s ease-in-out"}:{},children:[x&&(0,p.jsxs)(l.Ug,{px:4,py:2,bg:"card.bg",width:"100%",borderBottom:"1px solid",borderBottomColor:"divider",justifyContent:"space-between",children:[(0,p.jsx)(o.Translation,{alignItems:"center",display:"flex",variant:"unstyled",translation:"common.back",component:c.zx,leftIcon:(0,p.jsx)(i.sG8,{size:24}),onClick:function(){return S(!1)}}),(0,p.jsx)(o.Translation,{textStyle:"ctaStatic",translation:"assets.assetDetails.assetHistory.transactionHistory",component:l.xv})]}),(0,p.jsx)(d.TransactionList,{assetIds:[n],fullHeightOnMobile:!0,maxH:["100%",600]})]})]}),x&&(0,p.jsx)(l.kC,{p:4,left:0,bottom:0,border:0,width:"100%",zIndex:[10,0],bg:"card.bgDark",position:"fixed",children:(0,p.jsx)(o.Translation,{component:c.zx,translation:["common.start","common.deposit"],variant:"ctaFull",onClick:function(){return h(!0)}})})]})}},96362:function(e,t,n){n.r(t),n.d(t,{Approve:function(){return S}});var a=n(74165),s=n(15861),i=n(29439),r=n(54447),o=n(20910),l=n(87099),c=n(55967),d=n(82172),u=n(7276),p=n(15542),m=n(1128),x=n(23023),f=n(3498),g=n(65984),v=n(43127),h=n(78951),j=n(4710),b=n(75712),y=n(45263),S=function(e){var t=e.amountUsd,n=e.itemIndex,S=(0,d.Y)().account,C=(0,j.useOperativeComponent)(),k=C.defaultAmount,w=C.dispatch,A=C.activeItem,M=(0,u.useState)(k),T=(0,i.Z)(M,2),I=T[0],D=T[1],E=(0,b.useAssetProvider)(),P=E.underlyingAsset,Z=E.vault,U=E.translate,z=E.theme,F=(0,u.useState)(!1),Y=(0,i.Z)(F,2),_=Y[0],O=Y[1],B=(0,u.useState)(k),L=(0,i.Z)(B,2),N=L[0],H=L[1],G=(0,x.R)(),q=G.sendTransaction,R=G.setGasLimit;(0,u.useEffect)((function(){D(k)}),[k]);var V=(0,u.useCallback)((0,s.Z)((0,a.Z)().mark((function e(){var t,n,s,i;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Z&&"getAllowanceContractSendMethod"in Z&&"getAllowanceParams"in Z){e.next=2;break}return e.abrupt("return");case 2:if(t={from:null===S||void 0===S?void 0:S.address},n=Z.getAllowanceParams(l.Uf),s=Z.getAllowanceContractSendMethod(n)){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,(0,o.$K)(s,t);case 9:return i=e.sent,e.abrupt("return",i);case 11:case"end":return e.stop()}}),e)}))),[S,Z]),W=(0,u.useCallback)((function(){if(Z&&"getAllowanceContractSendMethod"in Z&&"getAllowanceParams"in Z){var e=Z.getAllowanceParams(N),t=Z.getAllowanceContractSendMethod(e);t&&q(Z.id,null===P||void 0===P?void 0:P.id,t)}}),[N,Z,P,q]);return(0,u.useEffect)((function(){var e=_?I:l.Uf;H(e),A===n&&w({type:"SET_AMOUNT",payload:e})}),[_,I,w,A,n]),(0,u.useEffect)((function(){A===n&&(0,s.Z)((0,a.Z)().mark((function e(){var t;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V();case 2:t=e.sent,R(t);case 4:case"end":return e.stop()}}),e)})))()}),[A,n,V,R]),(0,y.jsxs)(f.gC,{flex:1,width:"full",alignItems:"flex-start",children:[(0,y.jsx)(f.kC,{p:14,pt:20,flex:1,children:(0,y.jsxs)(f.gC,{spacing:6,children:[(0,y.jsx)(c.PG4,{size:72}),(0,y.jsx)(p.Translation,{component:f.xv,prefix:"".concat(U("modals.approve.routerName")," "),translation:"modals.approve.body",params:{asset:null===P||void 0===P?void 0:P.name},textStyle:"heading",fontSize:"h3",textAlign:"center"}),(0,y.jsxs)(f.gC,{width:"100%",spacing:6,children:[(0,y.jsxs)(f.Ug,{py:2,width:"100%",justifyContent:"space-between",borderTop:"1px solid ".concat(z.colors.divider),borderBottom:"1px solid ".concat(z.colors.divider),children:[(0,y.jsx)(p.Translation,{component:f.xv,translation:"trade.allowance",textStyle:"captionSmall"}),(0,y.jsxs)(f.Ug,{spacing:1,children:[(0,y.jsx)(p.Translation,{component:f.xv,translation:"trade.unlimited",textStyle:["captionSmall","clickable"],fontWeight:700,color:_?"ctaDisabled":"primary",onClick:function(){return O(!1)}}),(0,y.jsx)(g.r,{size:"sm",isChecked:_,onChange:function(e){return O(e.target.checked)}}),(0,y.jsx)(p.Translation,{component:f.xv,translation:"trade.exact",textStyle:["captionSmall","clickable"],fontWeight:700,color:_?"primary":"ctaDisabled",onClick:function(){return O(!0)}})]})]}),_&&(0,y.jsxs)(f.Ug,{children:[(0,y.jsx)(b.AssetProvider.Icon,{size:"sm"}),(0,y.jsx)(r.Card,{px:4,py:2,layerStyle:"cardLight",children:(0,y.jsx)(m.InputAmount,{inputHeight:6,amount:I,amountUsd:t,setAmount:D})})]})]}),(0,y.jsx)(p.Translation,{component:v.zx,translation:"common.approve",onClick:W,variant:"ctaFull"})]})}),(0,y.jsx)(h.EstimatedGasFees,{})]})}},97901:function(e,t,n){n.r(t),n.d(t,{Deposit:function(){return U}});var a=n(74165),s=n(15861),i=n(29439),r=n(5128),o=n(54447),l=n(4432),c=n(13708),d=n(28645),u=n(82172),p=n(61617),m=n(15542),x=n(39177),f=n(1128),g=n(85267),v=n(1669),h=n(63330),j=n(7276),b=n(23023),y=n(78951),S=n(4710),C=n(96124),k=n(43127),w=n(52486),A=n(3498),M=n(2092),T=n(47238),I=n(66624),D=n(86393),E=n(75712),P=n(20910),Z=n(45263),U=function(e){var t=e.itemIndex,n=(0,j.useState)(""),U=(0,i.Z)(n,2),z=U[0],F=U[1],Y=(0,j.useState)("0"),_=(0,i.Z)(Y,2),O=_[0],B=_[1],L=(0,j.useState)(0),N=(0,i.Z)(L,2),H=N[0],G=N[1],q=(0,h.useAssetPageProvider)(),R=q.stakingEnabled,V=q.setStakingEnabled,W=(0,g.m)().searchParams,K=(0,u.Y)(),X=K.account,$=K.isNetworkCorrect,Q=(0,b.R)(),J=Q.sendTransaction,ee=Q.setGasLimit,te=Q.state.transaction,ne=(0,v.w)().selectors,ae=ne.selectAssetPriceUsd,se=ne.selectAssetBalance,ie=(0,E.useAssetProvider)(),re=ie.asset,oe=ie.vault,le=ie.underlyingAsset,ce=ie.translate,de=(0,S.useOperativeComponent)(),ue=de.dispatch,pe=de.activeItem,me=de.activeStep,xe=de.executeAction,fe=de.setActionIndex,ge=de.depositAmount,ve=(0,j.useMemo)((function(){return W}),[W]),he=(0,i.Z)(ve,1)[0],je=(0,j.useMemo)((function(){var e;return oe&&"flags"in oe&&(null===(e=oe.flags)||void 0===e?void 0:e.referralEnabled)}),[oe]),be=(0,j.useMemo)((function(){var e;return oe&&"flags"in oe&&(null===(e=oe.flags)||void 0===e?void 0:e.depositsDisabled)}),[oe]),ye=(0,j.useMemo)((function(){if(je){var e=he.get("_referral");if((0,P.fF)(e)&&e!==d.r_)return e}}),[je,he]),Se=(0,j.useMemo)((function(){return se?se(null===le||void 0===le?void 0:le.id):(0,P.gA)(0)}),[se,null===le||void 0===le?void 0:le.id]);(0,j.useEffect)((function(){if(ae&&le){var e=ae(le.id),t=parseFloat((0,P.gA)(O).times(e).toString())||0;G(t)}}),[le,O,ae,ue]),(0,j.useEffect)((function(){xe||me!==t||"success"!==te.status||B("")}),[xe,te.status,me,t]);var Ce=(0,j.useMemo)((function(){return re&&!!re.epochData}),[re]),ke=(0,j.useMemo)((function(){return re&&Ce&&!1===re.vaultIsOpen}),[re,Ce]),we=(0,j.useMemo)((function(){return oe&&(!("enabled"in oe)||oe.enabled)&&re&&"deprecated"!==(null===re||void 0===re?void 0:re.status)}),[oe,re]),Ae=(0,j.useMemo)((function(){return(0,P.d5)(null===re||void 0===re?void 0:re.limit).lt(d.jq)?(0,P.d5)(null===re||void 0===re?void 0:re.limit):(0,P.gA)(0)}),[re]),Me=(0,j.useMemo)((function(){return!!Ae.gt(0)&&(0,P.gA)(null===re||void 0===re?void 0:re.totalTvl).gte(Ae)}),[re,Ae]),Te=(0,j.useMemo)((function(){if(F(""),Me||!we||be||"paused"===(null===re||void 0===re?void 0:re.status)||ke)return!0;if((0,P.gA)(O).isNaN()||(0,P.gA)(O).lte(0))return!0;if((0,P.gA)(O).gt(Se))return F(ce("trade.errors.insufficientFundsForAmount",{symbol:null===le||void 0===le?void 0:le.name})),!0;if(Ae.gt(0)&&(0,P.gA)(null===re||void 0===re?void 0:re.totalTvl).plus(O).gt(Ae)){var e=Ae.minus((0,P.gA)(null===re||void 0===re?void 0:re.totalTvl));return F(ce("trade.errors.limitCapReached",{limit:e.toFixed(2),symbol:null===le||void 0===le?void 0:le.name})),!0}return"started"===te.status}),[re,O,Ae,Me,ke,we,te,be,Se,le,ce]),Ie=(0,j.useCallback)((0,s.Z)((0,a.Z)().mark((function e(){var t,n,s;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(le&&oe&&"getAllowanceContract"in oe){e.next=2;break}return e.abrupt("return",(0,P.gA)(0));case 2:if(null!==X&&void 0!==X&&X.address){e.next=4;break}return e.abrupt("return",(0,P.gA)(0));case 4:if(t=oe.getAllowanceContract()){e.next=7;break}return e.abrupt("return",(0,P.gA)(0));case 7:return n=(0,P.WP)(oe),e.next=10,(0,P.RC)(t,X.address,n);case 10:return s=e.sent,e.abrupt("return",(0,P.I0)(s,le.decimals));case 12:case"end":return e.stop()}}),e)}))),[le,oe,null===X||void 0===X?void 0:X.address]),De=(0,j.useCallback)((function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0,n=t||O;if(X&&(!Te||t)&&!(0,P.d5)(n).gt(Se)&&oe&&"getDepositContractSendMethod"in oe&&"getDepositParams"in oe)return R&&!t?(ue({type:"SET_DEPOSIT_AMOUNT",payload:n}),ue({type:"SET_ASSET",payload:le}),fe(2)):void(0,s.Z)((0,a.Z)().mark((function t(){var s,i,r;return(0,a.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e){t.next=6;break}return t.next=3,Ie();case 3:t.t0=t.sent,t.next=7;break;case 6:t.t0=(0,P.gA)(n);case 7:t.t0.gte(n)?(i=ye&&"flags"in oe&&null!==(s=oe.flags)&&void 0!==s&&s.referralEnabled?oe.getDepositParams(n,ye):oe.getDepositParams(n),r=oe.getDepositContractSendMethod(i),(0,c.tM)(re,H),J(oe.id,null===le||void 0===le?void 0:le.id,r)):ue({type:"SET_ACTIVE_STEP",payload:1});case 9:case"end":return t.stop()}}),t)})))()}),[X,Te,ye,O,H,Se,oe,re,le,R,ue,fe,Ie,J]),Ee=(0,j.useCallback)((function(){null!==le&&void 0!==le&&le.balance&&B(le.balance.toString())}),[le]),Pe=(0,j.useCallback)((0,s.Z)((0,a.Z)().mark((function e(){var t,n,s,i,o,l,c,d,u;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(oe&&$&&"getDepositContractSendMethod"in oe&&"getDepositParams"in oe){e.next=2;break}return e.abrupt("return");case 2:return n=oe.getMethodDefaultGasLimit("deposit"),e.next=5,Ie();case 5:if(s=e.sent,X&&!Se.lte(0)&&!s.lte(0)){e.next=8;break}return e.abrupt("return",n);case 8:return i=r.Z.minimum(Se,s),o={from:null===X||void 0===X?void 0:X.address},l=i.toFixed(),c=ye&&"flags"in oe&&null!==(t=oe.flags)&&void 0!==t&&t.referralEnabled?oe.getDepositParams(l,ye):oe.getDepositParams(l),d=oe.getDepositContractSendMethod(c),e.next=15,(0,P.$K)(d,o);case 15:if(e.t0=e.sent,e.t0){e.next=18;break}e.t0=n;case 18:return u=e.t0,e.abrupt("return",u);case 20:case"end":return e.stop()}}),e)}))),[X,$,oe,ye,Ie,Se]);(0,j.useEffect)((function(){pe===t&&(0,s.Z)((0,a.Z)().mark((function e(){var t;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Pe();case 2:(t=e.sent)&&ee(t);case 4:case"end":return e.stop()}}),e)})))()}),[pe,t,Pe,ee]),(0,j.useEffect)((function(){pe===t&&xe&&R&&!(0,P.d5)(ge).lte(0)&&(ue({type:"SET_AMOUNT",payload:ge}),ue({type:"SET_DEFAULT_AMOUNT",payload:ge}),ue({type:"SET_ASSET",payload:le}),B(ge),V(!1),De(!0,ge),ue({type:"SET_EXECUTE_ACTION",payload:!1}))}),[ge,B,pe,ue,De,t,le,R,V,xe]),(0,j.useEffect)((function(){pe===t&&(ue({type:"SET_AMOUNT",payload:O}),ue({type:"SET_DEFAULT_AMOUNT",payload:O}),ue({type:"SET_ASSET",payload:le}),xe&&(De(!1),ue({type:"SET_EXECUTE_ACTION",payload:!1})))}),[O,pe,le,t,ue,xe,De]);var Ze=(0,j.useMemo)((function(){return X?(0,Z.jsx)(m.Translation,{component:k.zx,translation:R?"common.stakeDeposit":"common.deposit",disabled:Te,onClick:function(){return De(!0)},variant:"ctaFull",children:"started"===te.status&&(0,Z.jsx)(w.$,{size:"sm"})}):(0,Z.jsx)(D.ConnectWalletButton,{variant:"ctaFull"})}),[X,Te,te,De,R]),Ue=(0,j.useMemo)((function(){return ye?(0,Z.jsx)(o.Card.Dark,{py:2,pl:3,pr:2,border:0,children:(0,Z.jsxs)(A.gC,{spacing:1,children:[(0,Z.jsx)(m.Translation,{textStyle:"captionSmaller",translation:"defi.depositWithReferral"}),(0,Z.jsx)(x.AddressLink,{address:ye,text:ye,fontSize:"sm"})]})}):null}),[ye]),ze=(0,j.useMemo)((function(){return oe&&"messages"in oe?oe.messages:void 0}),[oe]),Fe=(0,j.useMemo)((function(){return we?Ce?(0,Z.jsx)(E.AssetProvider,{width:"full",wrapFlex:!1,assetId:null===re||void 0===re?void 0:re.id,children:(0,Z.jsx)(C.EpochVaultMessage,{})}):re&&"production"!==(null===re||void 0===re?void 0:re.status)?(0,Z.jsx)(o.Card.Dark,{p:2,border:0,children:(0,Z.jsx)(A.gC,{spacing:2,width:"full",justifyContent:"center",children:(0,Z.jsx)(m.Translation,{textStyle:"captionSmaller",translation:"trade.actions.deposit.messages.".concat(re.status),textAlign:"center"})})}):Me?(0,Z.jsx)(o.Card.Dark,{py:2,pl:4,pr:2,border:0,children:(0,Z.jsxs)(A.Ug,{spacing:4,width:"full",children:[(0,Z.jsx)(M.Ee,{src:"".concat(l.pm,"vaults/experimental.png"),width:7,height:7}),(0,Z.jsx)(m.Translation,{textStyle:"captionSmaller",translation:"trade.actions.deposit.messages.limitCapReached",isHtml:!0,params:{limit:"".concat(Ae.toFixed(0)," ").concat(null===le||void 0===le?void 0:le.token)},textAlign:"left"})]})}):(null===ze||void 0===ze?void 0:ze.deposit)&&(0,Z.jsx)(o.Card.Dark,{p:2,border:0,children:(0,Z.jsx)(m.Translation,{textStyle:"captionSmaller",translation:ze.deposit,isHtml:!0,textAlign:"center"})}):(0,Z.jsx)(o.Card.Dark,{py:2,pl:3,pr:2,border:0,children:(0,Z.jsxs)(A.Ug,{spacing:3,width:"full",children:[(0,Z.jsx)(M.Ee,{src:"".concat(l.pm,"vaults/deprecated.png"),width:6,height:6}),(0,Z.jsx)(m.Translation,{textStyle:"captionSmaller",translation:null!==re&&void 0!==re&&re.status&&"production"!==re.status?"trade.actions.deposit.messages.".concat(null===re||void 0===re?void 0:re.status):"trade.vaults.".concat(null===re||void 0===re?void 0:re.type,".disabled"),textAlign:"left"}),Se.gt(0)&&(0,Z.jsx)(m.Translation,{component:k.zx,translation:"trade.vaults.".concat(null===re||void 0===re?void 0:re.type,".disabledCta"),fontSize:"xs",height:"auto",width:"auto",py:3,px:7,onClick:function(){return fe(1)}})]})})}),[re,Ce,Me,Ae,le,we,Se,ze,fe]);return(0,Z.jsx)(E.AssetProvider,{flex:1,width:"full",assetId:null===re||void 0===re?void 0:re.underlyingId,children:(0,Z.jsxs)(A.gC,{pt:8,flex:1,spacing:6,height:"100%",id:"deposit-container",alignItems:"space-between",justifyContent:"flex-start",children:[(0,Z.jsxs)(A.gC,{flex:1,spacing:6,width:"100%",alignItems:"flex-start",children:[(0,Z.jsxs)(A.Ug,{width:"100%",spacing:[3,4],alignItems:"flex-start",children:[(0,Z.jsx)(A.xu,{pt:8,children:(0,Z.jsx)(p.AssetLabel,{assetId:null===re||void 0===re?void 0:re.id})}),(0,Z.jsxs)(A.gC,{spacing:1,width:"100%",alignItems:"flex-start",children:[(0,Z.jsx)(o.Card,{px:4,py:2,layerStyle:"cardLight",children:(0,Z.jsxs)(A.gC,{spacing:2,alignItems:"flex-start",children:[(0,Z.jsx)(f.InputAmount,{amount:O,amountUsd:H,setAmount:B}),(0,Z.jsxs)(A.Ug,{width:"100%",justifyContent:"space-between",children:[(0,Z.jsxs)(A.Ug,{spacing:1,children:[(0,Z.jsx)(m.Translation,{component:A.xv,translation:"common.balance",textStyle:"captionSmaller"}),(0,Z.jsx)(E.AssetProvider.Balance,{abbreviate:!0,decimals:4,textStyle:"captionSmaller",color:"primary"})]}),(0,Z.jsx)(k.zx,{variant:"selector",onClick:Ee,children:"MAX"})]})]})}),z&&(0,Z.jsx)(A.xv,{textStyle:"captionSmaller",color:"orange",children:z})]})]}),Ue,Fe,(0,Z.jsx)(I.DynamicActionFields,{assetId:null===re||void 0===re?void 0:re.id,action:"deposit",amount:O,amountUsd:H}),(0,Z.jsx)(T.FeeDiscountToggler,{assetId:null===re||void 0===re?void 0:re.id})]}),(0,Z.jsxs)(A.gC,{spacing:4,id:"footer",alignItems:"flex-start",children:[(0,Z.jsx)(y.EstimatedGasFees,{}),Ze]})]})})}},96124:function(e,t,n){n.r(t),n.d(t,{EpochVaultMessage:function(){return p}});var a=n(7276),s=n(20910),i=n(54447),r=n(3498),o=n(29564),l=n(15542),c=n(43098),d=n(75712),u=n(45263),p=function(){var e,t,n=(0,d.useAssetProvider)().asset,p=(0,o.R)().locale,m=(0,a.useMemo)((function(){return n&&!!n.epochData}),[n]),x=(0,a.useMemo)((function(){return m&&n&&!1===n.vaultIsOpen}),[n,m]);return m?(0,u.jsx)(i.Card.Dark,{p:2,border:0,children:(0,u.jsxs)(r.Ug,{spacing:3,width:"full",justifyContent:"flex-start",children:[(0,u.jsx)(r.xu,{pl:2,children:x?(0,u.jsx)(c.MpP,{size:24}):(0,u.jsx)(c.$ge,{size:24})}),(0,u.jsx)(l.Translation,{textStyle:"captionSmaller",translation:"trade.actions.deposit.messages.".concat(x?"vaultLocked":"vaultOpen"),isHtml:!0,params:{epochStart:(0,s.Jb)((null===n||void 0===n||null===(e=n.epochData)||void 0===e?void 0:e.start)||0,p),epochEnd:(0,s.Jb)((null===n||void 0===n||null===(t=n.epochData)||void 0===t?void 0:t.end)||0,p)},textAlign:"left"})]})}):null}},47238:function(e,t,n){n.r(t),n.d(t,{FeeDiscountLink:function(){return j},FeeDiscountToggler:function(){return b}});var a=n(1413),s=n(20910),i=n(7276),r=n(43098),o=n(54447),l=n(39807),c=n(87099),d=n(15542),u=n(1669),p=n(63330),m=n(76590),x=n(3498),f=n(73131),g=n(23214),v=n(61838),h=n(45263),j=function(e){var t=(0,l.f)().openModal,n={cta:"common.close",subtitle:"feeDiscount.table.header",body:(0,h.jsx)(v.FeeDiscountTable,{showHeader:!1})};return(0,h.jsx)(d.Translation,(0,a.Z)((0,a.Z)({translation:"feeDiscount.op.viewDiscountTable",textStyle:"linkBlue",textDecoration:"underline",fontSize:"sm"},e),{},{onClick:function(){return t(n,"2xl")}}))},b=function(e){var t=e.assetId,n=(0,p.useAssetPageProvider)(),a=n.stakingEnabled,l=n.toggleStakingEnabled,v=(0,u.w)(),b=v.stakingData,y=v.selectors,S=y.selectVaultById,C=y.selectAssetById,k=y.selectAssetBalance,w=(0,i.useMemo)((function(){return t&&S?S(t):null}),[t,S]),A=(0,i.useMemo)((function(){var e=(0,g.Z)(c.zS,c.MI);return e?C(null===e||void 0===e?void 0:e.address):null}),[C]),M=(0,i.useMemo)((function(){var e;return w&&"flags"in w&&!(null===(e=w.flags)||void 0===e||!e.feeDiscountEnabled)}),[w]),T=(0,i.useMemo)((function(){return A?k(A.id):(0,s.gA)(0)}),[k,A]);if(!M)return null;var I=Object.values(m.S).pop();return(0,h.jsxs)(x.gC,{spacing:2,width:"full",alignItems:"flex-start",children:[(null===b||void 0===b?void 0:b.feeDiscount.lte(0))&&(0,h.jsxs)(x.Ug,{pl:4,spacing:1,children:[(0,h.jsx)(d.Translation,{translation:"defi.feeDiscount",textStyle:"bodyTitle",fontSize:"xs",fontWeight:600}),(0,h.jsx)(r.nfF,{size:16,color:"orange"})]}),(0,h.jsx)(o.Card.Light,{py:2,px:4,sx:!a&&T.gt(0)?{opacity:.8,":hover":{opacity:1}}:{},children:(0,h.jsx)(x.Ug,{spacing:2,justifyContent:T.gt(0)?"flex-start":"center",children:T.lte(0)?(0,h.jsx)(d.Translation,{py:1,textAlign:"center",translation:"feeDiscount.op.ctaNoIDLE",fontSize:"xs",color:"primary",isHtml:!0,params:{discount:I}}):(0,h.jsx)(f.XZ,{size:"md",isChecked:a,onChange:function(){return l()},children:(0,h.jsx)(d.Translation,{translation:null!==b&&void 0!==b&&b.feeDiscount.gt(0)?"feeDiscount.op.ctaIncrease":"feeDiscount.op.cta",fontSize:"xs",color:"primary",isHtml:!0,params:{discount:I}})})})}),(0,h.jsx)(j,{pl:4})]})}},67041:function(e,t,n){n.r(t),n.d(t,{Stake:function(){return F}});var a=n(93433),s=n(74165),i=n(15861),r=n(29439),o=n(5128),l=n(20910),c=n(54447),d=n(55967),u=n(28645),p=n(42828),m=n(13708),x=n(13461),f=n(33482),g=n(52734),v=n(82172),h=n(61617),j=n(15542),b=n(1128),y=n(1669),S=n(76590),C=n(7276),k=n(23023),w=n(4710),A=n(78951),M=n(47238),T=n(66624),I=n(86393),D=n(75712),E=n(87099),P=n(43127),Z=n(3498),U=n(88089),z=n(45263),F=function(e){var t=e.itemIndex,n=e.chainIds,F=void 0===n?[]:n,Y=(0,C.useState)(""),_=(0,r.Z)(Y,2),O=_[0],B=_[1],L=(0,C.useState)("0"),N=(0,r.Z)(L,2),H=N[0],G=N[1],q=(0,C.useState)(""),R=(0,r.Z)(q,2),V=R[0],W=R[1],K=(0,C.useState)(0),X=(0,r.Z)(K,2),$=X[0],Q=X[1],J=(0,C.useState)(null),ee=(0,r.Z)(J,2),te=ee[0],ne=ee[1],ae=(0,x.x)().web3,se=(0,v.Y)(),ie=se.account,re=se.setChainId,oe=se.checkChainEnabled,le=(0,D.useAssetProvider)(),ce=le.asset,de=le.vault,ue=le.underlyingAsset,pe=le.translate,me=(0,y.w)(),xe=me.stakingData,fe=me.selectors,ge=fe.selectAssetBalance,ve=fe.selectAssetPriceUsd,he=(0,w.useOperativeComponent)(),je=he.dispatch,be=he.activeItem,ye=he.activeStep,Se=he.executeAction,Ce=he.setActionIndex,ke=he.depositAmount,we=(0,k.R)(),Ae=we.sendTransaction,Me=we.setGasLimit,Te=we.state,Ie=Te.transaction,De=Te.block,Ee=(0,C.useMemo)((function(){return oe(F)}),[F,oe]),Pe=(0,C.useMemo)((function(){return ge?ge(null===ue||void 0===ue?void 0:ue.id):(0,l.gA)(0)}),[ge,null===ue||void 0===ue?void 0:ue.id]),Ze=(0,C.useMemo)((function(){if(ve&&ue){var e=ve(ue.id);return(0,l.d5)(H).times(e)}}),[ue,H,ve]),Ue=(0,C.useMemo)((function(){return[{type:"amount",action:"increaseAmount",label:"staking.increaseAmount"},{type:"time",action:"increaseTime",label:"staking.increaseTime"}]}),[]),ze=(0,C.useMemo)((function(){var e,t;return!(null===xe||void 0===xe||null===(e=xe.position)||void 0===e||!e.lockEnd||!De)&&(0,l.qF)(null===xe||void 0===xe||null===(t=xe.position)||void 0===t?void 0:t.lockEnd).isSameOrBefore((0,l.qF)(1e3*De.timestamp))}),[xe,De]),Fe=(0,C.useMemo)((function(){var e;return null===xe||void 0===xe||null===(e=xe.position)||void 0===e?void 0:e.deposited.gt(0)}),[xe]),Ye=(0,C.useMemo)((function(){return Fe?Ue[$]:null}),[Fe,Ue,$]),_e=(0,C.useMemo)((function(){return Ye?Ye.type:null}),[Ye]),Oe=(0,C.useMemo)((function(){return Ye?Ye.action:"stake"}),[Ye]),Be=(0,C.useMemo)((function(){var e,t;return null!==xe&&void 0!==xe&&null!==(e=xe.position)&&void 0!==e&&e.lockEnd?(0,l.qF)(null===xe||void 0===xe||null===(t=xe.position)||void 0===t?void 0:t.lockEnd).add(E.Bv,"second"):(0,l.qF)().add(E.z1,"second")}),[xe]),Le=(0,C.useMemo)((function(){return(0,l.qF)().add(E.$O,"second")}),[]),Ne=(0,C.useMemo)((function(){var e;if("amount"===_e&&null!==xe&&void 0!==xe&&null!==(e=xe.position)&&void 0!==e&&e.lockEnd)return Math.round(xe.position.lockEnd/1e3);var t=(0,l.qF)(),n=te&&te.set("hour",t.hour()).set("minute",t.minute()).set("second",t.second());return n?Math.round(n.toDate().getTime()/1e3):0}),[_e,xe,te]),He=(0,C.useMemo)((function(){return(0,l.DH)(Ne)}),[Ne]),Ge=(0,C.useMemo)((function(){var e;return(0,l.d5)(null===xe||void 0===xe||null===(e=xe.position)||void 0===e?void 0:e.deposited)}),[xe]),qe=(0,C.useMemo)((function(){var e,t;return"time"===_e&&null!==xe&&void 0!==xe&&xe.position?(0,l.am)(null===xe||void 0===xe||null===(t=xe.position)||void 0===t?void 0:t.deposited,He):(0,l.d5)(null===xe||void 0===xe||null===(e=xe.position)||void 0===e?void 0:e.balance).plus((0,l.am)(H,He))}),[_e,xe,He,H]);(0,C.useEffect)((function(){var e;null!==xe&&void 0!==xe&&null!==(e=xe.position)&&void 0!==e&&e.lockEnd&&"time"===_e&&ne(Be)}),[xe,ne,_e,Be]);var Re=(0,C.useCallback)((function(){return te&&te.startOf("day").isSameOrAfter(Be.startOf("day"))&&te.startOf("day").isSameOrBefore(Le.startOf("day"))}),[te,Be,Le]),Ve=(0,C.useMemo)((function(){return[{label:"staking.6months",value:6,timeframe:"month"},{label:"staking.1year",value:1,timeframe:"year"},{label:"staking.4years",value:E.$O,timeframe:"second"}]}),[]),We=(0,C.useMemo)((function(){B(""),W("");var e=(0,l.SL)(qe);if(!_e||"amount"===_e){if((0,l.gA)(H).isNaN()||(0,l.gA)(H).lte(0))return!0;if((0,l.gA)(H).gt(Pe))return B(pe("trade.errors.insufficientFundsForAmount",{symbol:null===ue||void 0===ue?void 0:ue.name})),!0}return _e&&"time"!==_e||Re()?(e.lte(0)&&("time"===_e||(0,l.gA)(H).gte(Pe)?W(pe("trade.errors.stakingNotEnoughForFeeDiscount")):B(pe("trade.errors.stakingNotEnoughForFeeDiscount"))),!1):(W(pe("time"===_e?"trade.errors.stakingIncreaseLockEndDateNotCorrect":"trade.errors.stakingLockEndDateNotCorrect")),!0)}),[H,qe,_e,Re,Pe,ue,pe]),Ke=(0,C.useCallback)((0,i.Z)((0,s.Z)().mark((function e(){var t,n,a;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(ue&&de&&"getAllowanceContract"in de){e.next=2;break}return e.abrupt("return",(0,l.gA)(0));case 2:if(null!==ie&&void 0!==ie&&ie.address){e.next=4;break}return e.abrupt("return",(0,l.gA)(0));case 4:if(t=de.getAllowanceContract()){e.next=7;break}return e.abrupt("return",(0,l.gA)(0));case 7:return n=(0,l.WP)(de),e.next=10,(0,l.RC)(t,ie.address,n);case 10:return a=e.sent,e.abrupt("return",(0,l.I0)(a,ue.decimals));case 12:case"end":return e.stop()}}),e)}))),[ue,de,null===ie||void 0===ie?void 0:ie.address]),Xe=(0,C.useCallback)((function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];ie&&!We&&de&&"getDepositContractSendMethod"in de&&"getDepositParams"in de&&de instanceof f.y&&(0,i.Z)((0,s.Z)().mark((function t(){var n,i,r,o,c,d,u,p,x,f,g,v;return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(Fe){t.next=26;break}if(!e){t.next=7;break}return t.next=4,Ke();case 4:t.t0=t.sent,t.next=8;break;case 7:t.t0=(0,l.gA)(H);case 8:if(!t.t0.gte(H)){t.next=23;break}if(n=Ne,i=(0,a.Z)(Ve).pop(),(null===te||void 0===te?void 0:te.format("YYYY-MM-DD"))!==(0,l.qF)().add(i.value,i.timeframe).format("YYYY-MM-DD")){t.next=17;break}return t.next=15,(0,l.Qg)(ae);case 15:(r=t.sent)&&(n=+r.timestamp+E.$O);case 17:(0,m.tM)(ce,Ze),o=de.getDepositParams(H,n),c=de.getDepositContractSendMethod(o),Ae(de.id,null===ue||void 0===ue?void 0:ue.id,c,Oe),t.next=24;break;case 23:je({type:"SET_ACTIVE_STEP",payload:1});case 24:t.next=51;break;case 26:t.t1=_e,t.next="amount"===t.t1?29:"time"===t.t1?39:50;break;case 29:if(!e){t.next=35;break}return t.next=32,Ke();case 32:t.t2=t.sent,t.next=36;break;case 35:t.t2=(0,l.gA)(H);case 36:return t.t2.gte(H)?(d=de.getIncreaseAmountParams(H),u=de.getIncreaseAmountContractSendMethod(d),Ae(de.id,null===ue||void 0===ue?void 0:ue.id,u,Oe)):je({type:"SET_ACTIVE_STEP",payload:1}),t.abrupt("break",51);case 39:if(p=Ne,x=(0,a.Z)(Ve).pop(),(null===te||void 0===te?void 0:te.format("YYYY-MM-DD"))!==(0,l.qF)().add(x.value,x.timeframe).format("YYYY-MM-DD")){t.next=46;break}return t.next=44,(0,l.Qg)(ae);case 44:(f=t.sent)&&(p=+f.timestamp+E.$O);case 46:return g=de.getIncreaseTimeParams(p),v=de.getIncreaseTimeContractSendMethod(g),Ae(de.id,null===ue||void 0===ue?void 0:ue.id,v,Oe,(0,l.p6)(te,"YYYY-MM-DD HH:mm",!0)),t.abrupt("break",51);case 50:return t.abrupt("break",51);case 51:case"end":return t.stop()}}),t)})))()}),[ie,ce,Fe,Oe,_e,We,H,Ze,Ve,ae,te,Ne,de,ue,je,Ke,Ae]);(0,C.useEffect)((function(){Se||ye!==t||"success"!==Ie.status||G("")}),[Se,Ie.status,ye,t]);var $e=(0,C.useCallback)((function(){null!==ue&&void 0!==ue&&ue.balance&&G(ue.balance.toString())}),[ue]),Qe=(0,C.useCallback)((0,i.Z)((0,s.Z)().mark((function e(){var t,n,a,i,r,c,d,u,p;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(de&&"getDepositContractSendMethod"in de&&"getDepositParams"in de&&de instanceof f.y){e.next=2;break}return e.abrupt("return");case 2:if(t=de.getMethodDefaultGasLimit("stake"),ie&&!Pe.lte(0)&&Re()){e.next=5;break}return e.abrupt("return",t);case 5:return e.next=7,Ke();case 7:if(!(n=e.sent).lte(0)){e.next=10;break}return e.abrupt("return",t);case 10:if(a=o.Z.minimum(Pe,n),i={from:null===ie||void 0===ie?void 0:ie.address},r=null,Fe?"amount"===_e?(d=de.getIncreaseAmountParams(a.toFixed()),r=de.getIncreaseAmountContractSendMethod(d)):"time"===_e&&(u=de.getIncreaseTimeParams(Ne),r=de.getIncreaseTimeContractSendMethod(u)):(c=de.getDepositParams(a.toFixed(),Ne),r=de.getDepositContractSendMethod(c)),r){e.next=16;break}return e.abrupt("return",t);case 16:return e.next=18,(0,l.$K)(r,i);case 18:if(e.t0=e.sent,e.t0){e.next=21;break}e.t0=t;case 21:return p=e.t0,e.abrupt("return",p);case 23:case"end":return e.stop()}}),e)}))),[ie,Fe,_e,de,Re,Ne,Ke,Pe]);(0,C.useEffect)((function(){be===t&&(0,i.Z)((0,s.Z)().mark((function e(){var t;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qe();case 2:t=e.sent,Me(t);case 4:case"end":return e.stop()}}),e)})))()}),[be,t,Qe,Me]),(0,C.useEffect)((function(){be===t&&(je({type:"SET_AMOUNT",payload:H}),je({type:"SET_DEFAULT_AMOUNT",payload:H}),je({type:"SET_ASSET",payload:ue}),Se&&(0,l.d5)(H).gt(0)&&(Xe(!1),(0,l.d5)(ke).lte(0)&&je({type:"SET_EXECUTE_ACTION",payload:!1})))}),[H,be,ue,t,je,Se,Xe,ke]);var Je=(0,C.useMemo)((function(){return ie?(0,z.jsx)(j.Translation,{component:P.zx,translation:"staking.".concat(Oe),disabled:We,onClick:Xe,variant:"ctaFull"}):(0,z.jsx)(I.ConnectWalletButton,{variant:"ctaFull"})}),[ie,We,Oe,Xe]),et=(0,C.useCallback)((function(e,t){var n=(0,l.dU)((0,l.dk)((0,l.qF)().add(e,t),Be),Le);ne(n)}),[ne,Be,Le]),tt=(0,C.useCallback)((function(e){Q(e)}),[Q]),nt=(0,C.useMemo)((function(){return Fe&&"amount"!==_e?null:(0,z.jsxs)(Z.Ug,{width:"full",spacing:[3,4],alignItems:"flex-start",children:[(0,z.jsx)(Z.xu,{pt:8,width:"110px",children:(0,z.jsx)(h.AssetLabel,{assetId:null===ce||void 0===ce?void 0:ce.id})}),(0,z.jsxs)(Z.gC,{flex:1,spacing:1,alignItems:"flex-start",children:[(0,z.jsx)(c.Card,{px:4,py:2,layerStyle:"cardLight",children:(0,z.jsxs)(Z.gC,{spacing:2,alignItems:"flex-start",children:[(0,z.jsx)(b.InputAmount,{amount:H,amountUsd:null,setAmount:G}),(0,z.jsxs)(Z.Ug,{width:"full",justifyContent:"space-between",children:[(0,z.jsxs)(Z.Ug,{spacing:1,children:[(0,z.jsx)(j.Translation,{component:Z.xv,translation:"common.balance",textStyle:"captionSmaller"}),(0,z.jsx)(D.AssetProvider.Balance,{abbreviate:!0,decimals:4,textStyle:"captionSmaller",color:"primary"})]}),(0,z.jsx)(P.zx,{variant:"selector",onClick:$e,children:"MAX"})]})]})}),O&&(0,z.jsx)(Z.xv,{textStyle:"captionSmaller",color:"orange",children:O})]})]})}),[ce,H,G,O,$e,Fe,_e]),at=(0,C.useMemo)((function(){return Fe&&"time"!==_e?null:(0,z.jsxs)(Z.Ug,{spacing:4,width:"full",alignItems:"flex-start",children:[(0,z.jsx)(Z.xu,{pt:8,width:"110px",children:(0,z.jsx)(j.Translation,{translation:"staking.lockEnd",textStyle:"titleSmall",fontSize:"md",color:"primary",whiteSpace:"nowrap"})}),(0,z.jsxs)(Z.gC,{flex:1,spacing:1,alignItems:"flex-start",children:[(0,z.jsx)(c.Card,{px:4,py:2,layerStyle:"cardLight",children:(0,z.jsxs)(Z.gC,{spacing:2,alignItems:"flex-start",children:[(0,z.jsx)(g.InputDate,{value:null===te||void 0===te?void 0:te.format("YYYY-MM-DD"),setValue:ne,min:Be.format("YYYY-MM-DD"),max:Le.format("YYYY-MM-DD")}),(0,z.jsx)(Z.MI,{spacing:1,width:"full",columns:Ve.length,justifyContent:"space-between",children:Ve.map((function(e){var t=(null===te||void 0===te?void 0:te.format("YYYY-MM-DD"))===(0,l.qF)().add(e.value,e.timeframe).format("YYYY-MM-DD");return(0,z.jsx)(j.Translation,{translation:e.label,component:P.zx,variant:"selector","aria-selected":t,onClick:function(){return et(e.value,e.timeframe)}},"option_".concat(e.label))}))})]})}),V&&(0,z.jsx)(Z.xv,{textStyle:"captionSmaller",color:"orange",children:V})]})]})}),[Fe,_e,te,ne,Be,Le,Ve,et,V]),st=(0,C.useMemo)((function(){var e=Object.entries(S.S).pop();return e?(0,z.jsx)(c.Card.Dark,{p:2,border:0,children:(0,z.jsx)(j.Translation,{textAlign:"center",translation:"strategies.staking.op.feeDiscount",params:{amount:"\u2265 ".concat(e[0]),discount:e[1]},isHtml:!0,textStyle:"captionSmaller"})}):null}),[]);return(0,z.jsx)(D.AssetProvider,{flex:1,width:"full",assetId:null===ce||void 0===ce?void 0:ce.underlyingId,children:Ee?ze?(0,z.jsx)(Z.M5,{px:10,flex:1,width:"full",children:(0,z.jsxs)(Z.gC,{spacing:6,children:[(0,z.jsx)(d.ppH,{size:72}),(0,z.jsxs)(Z.gC,{spacing:4,children:[(0,z.jsx)(j.Translation,{component:Z.xv,translation:"staking.lockExpired",textStyle:"heading",fontSize:"h3",textAlign:"center"}),(0,z.jsx)(j.Translation,{component:Z.xv,translation:"staking.canWithdrawLock",params:{amount:(0,l.dm)(Ge),asset:null===ce||void 0===ce?void 0:ce.name},textStyle:"captionSmall",textAlign:"center"}),(0,z.jsx)(j.Translation,{component:P.zx,translation:"common.unstake",onClick:function(){return Ce(1)},variant:"ctaPrimary",px:10})]})]})}):(0,z.jsxs)(Z.gC,{pt:8,flex:1,spacing:6,height:"full",id:"deposit-container",alignItems:"space-between",justifyContent:"flex-start",children:[(0,z.jsxs)(Z.gC,{flex:1,spacing:6,width:"full",alignItems:"flex-start",children:[st,Fe&&(0,z.jsx)(U.mQ,{width:"full",defaultIndex:0,variant:"buttonTertiary",onChange:tt,children:(0,z.jsx)(U.td,{width:"full",children:(0,z.jsx)(Z.MI,{spacing:2,width:"full",columns:Ue.length,children:Ue.map((function(e){return(0,z.jsx)(j.Translation,{component:U.OK,translation:e.label},"option_".concat(e.label))}))})})}),nt,at,(0,z.jsxs)(Z.gC,{spacing:2,width:"full",alignItems:"flex-start",children:[(0,z.jsx)(T.DynamicActionFields,{assetId:null===ce||void 0===ce?void 0:ce.id,action:Oe,amount:qe.toFixed(),amountUsd:qe.toFixed(),stakingPower:He}),(0,z.jsx)(M.FeeDiscountLink,{pl:4})]})]}),(0,z.jsxs)(Z.gC,{spacing:4,id:"footer",alignItems:"flex-start",children:[(0,z.jsx)(A.EstimatedGasFees,{}),Je]})]}):(0,z.jsx)(Z.M5,{px:10,flex:1,width:"full",children:(0,z.jsxs)(Z.gC,{spacing:6,children:[(0,z.jsx)(p.p8b,{size:72}),(0,z.jsxs)(Z.gC,{spacing:4,children:[(0,z.jsx)(j.Translation,{component:Z.xv,translation:"staking.networkNotSupported",textStyle:"heading",fontSize:"h3",textAlign:"center"}),(0,z.jsx)(j.Translation,{component:Z.xv,translation:"staking.switchToMainnet",textStyle:"captionSmall",textAlign:"center"}),(0,z.jsx)(j.Translation,{component:P.zx,translation:"common.switchNetwork",onClick:function(){return re(u.zS)},variant:"ctaPrimary",px:10})]})]})})})}}}]);