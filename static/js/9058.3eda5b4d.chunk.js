"use strict";(self.webpackChunkidle_dashboard_new=self.webpackChunkidle_dashboard_new||[]).push([[9058],{59058:function(t,n,e){e.r(n),e.d(n,{Unstake:function(){return j}});var i=e(74165),a=e(15861),o=e(33482),s=e(55967),r=e(82172),l=e(7276),c=e(43127),d=e(3498),u=e(15542),x=e(1669),p=e(23023),h=e(78951),v=e(53465),f=e(67360),m=e(86393),g=e(75712),k=e(23537),w=e(45263),j=function(t){var n,e,j,S=t.itemIndex,C=t.chainIds,E=void 0===C?[]:C,y=(0,g.useAssetProvider)(),T=y.asset,b=y.vault,M=(0,r.Y)(),A=M.account,I=M.checkChainEnabled,W=(0,v.useOperativeComponent)(),P=W.dispatch,Z=W.activeItem,z=W.setActionIndex,_=(0,x.w)(),F=_.stakingData,D=_.selectors.selectVaultPrice,L=(0,p.R)(),U=L.sendTransaction,Y=L.setGasLimit,B=L.state.block,N=(0,l.useMemo)((function(){return I(E)}),[E,I]),O=(0,l.useMemo)((function(){var t;return(0,k.d5)(null===F||void 0===F||null===(t=F.position)||void 0===t?void 0:t.deposited)}),[F]),G=(0,l.useMemo)((function(){var t,n;return!(null===F||void 0===F||null===(t=F.position)||void 0===t||!t.lockEnd||!B)&&(0,k.qF)(null===F||void 0===F||null===(n=F.position)||void 0===n?void 0:n.lockEnd).isSameOrBefore((0,k.qF)(1e3*B.timestamp))}),[F,B]),H=(0,l.useMemo)((function(){var t,n;return null!==F&&void 0!==F&&null!==(t=F.position)&&void 0!==t&&t.lockEnd?(0,k.p6)(null===F||void 0===F||null===(n=F.position)||void 0===n?void 0:n.lockEnd,"YYYY-MM-DD HH:mm",!0):null}),[F]),q=(0,l.useCallback)((function(){A&&G&&b&&"getWithdrawContractSendMethod"in b&&"getWithdrawParams"in b&&b instanceof o.y&&(0,a.Z)((0,i.Z)().mark((function t(){var n,e;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=b.getWithdrawParams(),e=b.getWithdrawContractSendMethod(n),U(b.id,b.id,e);case 3:case"end":return t.stop()}}),t)})))()}),[A,G,b,U]),K=(0,l.useCallback)((0,a.Z)((0,i.Z)().mark((function t(){var n,e,a,s,r;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(b&&"getWithdrawContractSendMethod"in b&&"getWithdrawParams"in b&&b instanceof o.y){t.next=2;break}return t.abrupt("return");case 2:if(n=b.getMethodDefaultGasLimit("unstake"),A&&G){t.next=5;break}return t.abrupt("return",n);case 5:return e={from:null===A||void 0===A?void 0:A.address},a=b.getWithdrawParams(),s=b.getWithdrawContractSendMethod(a),t.next=10,(0,k.$K)(s,e);case 10:if(t.t0=t.sent,t.t0){t.next=13;break}t.t0=n;case 13:return r=t.t0,t.abrupt("return",r);case 15:case"end":return t.stop()}}),t)}))),[A,b,G]);(0,l.useEffect)((function(){Z===S&&(0,a.Z)((0,i.Z)().mark((function t(){var n;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,K();case 2:n=t.sent,Y(n);case 4:case"end":return t.stop()}}),t)})))()}),[Z,S,K,Y]),(0,l.useEffect)((function(){Z===S&&(P({type:"SET_ASSET",payload:T}),D&&b&&(P({type:"SET_AMOUNT",payload:(0,k.gA)(O).toString()}),P({type:"SET_DEFAULT_AMOUNT",payload:(0,k.gA)(O).toString()})))}),[b,T,O,D,Z,S,P,q]);var R=(0,l.useMemo)((function(){return!N&&T?(0,w.jsx)(f.SwitchNetworkButton,{chainId:T.chainId,width:"full"}):A?(0,w.jsx)(u.Translation,{component:c.zx,translation:"common.withdraw",disabled:!G,onClick:q,variant:"ctaFull"}):(0,w.jsx)(m.ConnectWalletButton,{variant:"ctaFull"})}),[A,G,q,N,T]);return(0,w.jsx)(g.AssetProvider,{flex:1,width:"100%",assetId:null===T||void 0===T?void 0:T.id,children:(0,w.jsxs)(d.gC,{flex:1,spacing:6,width:"100%",height:"100%",id:"withdraw-container",alignItems:"space-between",justifyContent:"flex-start",pt:N&&null!==F&&void 0!==F&&null!==(n=F.position)&&void 0!==n&&n.lockEnd?8:0,children:[(0,w.jsx)(d.gC,{flex:1,spacing:0,id:"confirm-on-wallet",alignItems:"flex-start",children:null!==F&&void 0!==F&&null!==(e=F.position)&&void 0!==e&&e.lockEnd?G?(0,w.jsx)(d.M5,{py:14,flex:1,px:[4,10],width:"100%",children:(0,w.jsxs)(d.gC,{spacing:6,children:[(0,w.jsx)(s.ppH,{size:72}),(0,w.jsxs)(d.gC,{spacing:4,children:[(0,w.jsx)(u.Translation,{component:d.xv,translation:"staking.lockExpired",textStyle:"heading",fontSize:"h3",textAlign:"center"}),(0,w.jsx)(u.Translation,{component:d.xv,translation:"staking.canWithdrawLock",params:{amount:(0,k.dm)(O),asset:null===T||void 0===T?void 0:T.name},textStyle:"captionSmall",textAlign:"center"})]})]})}):(0,w.jsxs)(d.gC,{py:20,flex:1,spacing:6,px:[6,10],width:"100%",children:[(0,w.jsx)(s.FKe,{size:72}),(0,w.jsxs)(d.gC,{spacing:4,children:[(0,w.jsx)(u.Translation,{component:d.xv,translation:"staking.lockNotExpired",textStyle:"heading",fontSize:"h3",textAlign:"center"}),(0,w.jsx)(u.Translation,{component:d.xv,translation:"staking.waitUntilLockExpired",params:{lockEndDate:H},textStyle:"captionSmall",textAlign:"center"}),(0,w.jsx)(u.Translation,{component:c.zx,translation:"staking.increaseLock",onClick:function(){return z(0)},variant:"ctaPrimary",px:10})]})]}):(0,w.jsx)(d.M5,{px:6,flex:1,width:"100%",children:(0,w.jsxs)(d.gC,{spacing:5,children:[(0,w.jsx)(u.Translation,{component:d.xv,translation:"staking.noStake",textStyle:"heading",fontSize:"h3",textAlign:"center"}),(0,w.jsx)(u.Translation,{component:d.xv,translation:"staking.stakeBeforeUnstake",textStyle:"captionSmall",textAlign:"center"}),(0,w.jsx)(u.Translation,{component:c.zx,translation:"common.stake",onClick:function(){return z(0)},variant:"ctaPrimary",px:10})]})})}),(null===F||void 0===F||null===(j=F.position)||void 0===j?void 0:j.lockEnd)&&G&&(0,w.jsxs)(d.gC,{spacing:4,id:"footer",alignItems:"flex-start",children:[G&&(0,w.jsx)(h.EstimatedGasFees,{}),R]})]})})}}}]);