"use strict";(self.webpackChunkidle_dashboard_new=self.webpackChunkidle_dashboard_new||[]).push([[6765],{56765:function(e,t,n){n.r(t),n.d(t,{Stats:function(){return M}});var s=n(4942),i=n(93433),a=n(1413),l=n(29439),r=n(5128),o=n(55967),c=n(54447),d=n(79681),u=n(65963),g=n(95173),x=n(86059),p=n(12056),f=n(66288),h=n(75349),y=n(7276),v=n(61617),m=n(58316),j=n(29482),A=n(15542),w=n(1669),C=n(85267),b=n(75712),S=n(23537),U=n(96699),I=n(3498),P=n(2092),B=n(89030),O=n(43127),R=n(3497),k=n(45263),M=function(){var e=(0,g.s0)(),t=(0,C.m)().location,n=(0,w.w)(),M=n.assetsData,T=n.isPortfolioLoaded,L=n.selectors,Z=L.selectAssetById,H=L.selectVaultById,_=(0,U.Fg)(),z=(0,d.qM)(),E=(0,f.X)().isMobile,N=(0,y.useState)(""),D=(0,l.Z)(N,2),G=D[0],K=D[1],V=(0,y.useState)(null),q=(0,l.Z)(V,2),F=q[0],J=q[1],W=(0,y.useState)(null),Y=(0,l.Z)(W,2),Q=Y[0],X=Y[1],$=(0,y.useCallback)((function(n){return n?e("".concat(null===t||void 0===t?void 0:t.pathname.replace(/\/$/,""),"/").concat(n)):null}),[e,t]),ee=(0,y.useMemo)((function(){return Object.values(M)}),[M]),te=(0,y.useMemo)((function(){return T?ee.reduce((function(e,t){var n;if(!("type"in t))return e;if("flags"in t&&!1===(null===(n=t.flags)||void 0===n?void 0:n.statsEnabled))return e;var l=p.A[t.type];return l&&"strategy"in l?(e[l.strategy]||(e[l.strategy]=[]),(0,a.Z)((0,a.Z)({},e),{},(0,s.Z)({},l.strategy,[].concat((0,i.Z)(e[l.strategy]),[t])))):e}),{}):{}}),[ee,T]),ne=(0,y.useMemo)((function(){return Object.keys(te).filter((function(e){return!F||F===e})).reduce((function(e,t){return te[t].filter((function(e){return"deprecated"!==e.status&&(!G.trim().length||e.name.toLowerCase().includes(G.toLowerCase()))})).forEach((function(n){var s=Z(n.underlyingId);if(s){var i="".concat(s.name,"_").concat(t);e[i]?n.apy&&(e[i].apyRange.minApy?e[i].apyRange.minApy=r.O.minimum(e[i].apyRange.minApy,n.apy):e[i].apyRange.minApy=(0,S.gA)(n.apy),e[i].apyRange.maxApy?e[i].apyRange.maxApy=r.O.maximum(e[i].apyRange.maxApy,n.apy):e[i].apyRange.maxApy=(0,S.gA)(n.apy)):(e[i]=(0,a.Z)({},s),e[i].chains=[],e[i].subRows=[],e[i].strategy=t,e[i].apyRange={minApy:n.apy||null,maxApy:n.apy||null}),e[i].tvlUsd=(0,S.d5)(e[i].tvlUsd).plus((0,S.d5)(n.tvlUsd)),n.chainId&&-1===e[i].chains.indexOf(+n.chainId)&&e[i].chains.push(+n.chainId);var l=H(n.id);if(l)if("tranches"===t){var o=l.cdoConfig,c=e[i].subRows.find((function(e){var t=H(e.id);return"cdoConfig"in t&&t.cdoConfig.address===o.address&&e.id!==n.id}));c?c.tvlUsd=(0,S.d5)(c.tvlUsd).plus((0,S.d5)(n.tvlUsd)):e[i].subRows.push((0,a.Z)({},n))}else e[i].subRows.push((0,a.Z)({},n))}})),e}),{})}),[te,Z,H,F,G]),se=(0,y.useMemo)((function(){return Object.values(ee).filter((function(e){var t;return!(null===(t=p.A[e.type])||void 0===t||!t.visible)}))}),[ee]),ie=(0,y.useMemo)((function(){return Object.values(se).reduce((function(e,t){return e.plus((0,S.d5)(null===t||void 0===t?void 0:t.tvlUsd))}),(0,S.gA)(0))}),[se]),ae=(0,y.useMemo)((function(){return Object.values(se).reduce((function(e,t){return e.plus((0,S.d5)(null===t||void 0===t?void 0:t.tvlUsd).times(r.O.minimum(9999,(0,S.d5)(null===t||void 0===t?void 0:t.apy))))}),(0,S.gA)(0))}),[se]).div(ie),le=(0,y.useMemo)((function(){return[{Header:"#",accessor:"id",display:"none"},{id:"asset",width:"30%",accessor:"id",Header:z("defi.asset"),Cell:function(e){var t=e.value,n=e.row;return"AA"===n.original.type||"BB"===n.original.type?(0,k.jsx)(I.kC,{pl:4,children:(0,k.jsx)(b.AssetProvider,{assetId:t,children:(0,k.jsx)(b.AssetProvider.GeneralData,{field:"vaultOperatorOrProtocol",size:"xs"})})}):"BY"===n.original.type?(0,k.jsx)(b.AssetProvider,{assetId:t,children:(0,k.jsx)(I.kC,{pl:4,width:["auto","40%"],children:(0,k.jsx)(b.AssetProvider.GeneralData,{field:"protocols",size:"xs"})})}):(0,k.jsxs)(I.Ug,{width:"full",spacing:[10,0],children:[(0,k.jsx)(I.kC,{width:["auto","40%"],children:(0,k.jsx)(v.AssetLabel,{assetId:t,textStyle:"tableCell",fontSize:"md"})}),(0,k.jsx)(j.ProductTag,{type:n.original.strategy})]})}},{id:"chain",width:"10%",accessor:"id",Header:z("defi.chains"),Cell:function(e){var t=e.value,n=e.row;return"underlying"===n.original.type?(0,k.jsx)(I.Ug,{spacing:-1,width:"full",alignItems:"center",justifyContent:"flex-start",children:n.original.chains.map((function(e){return(0,k.jsx)(P.Ee,{src:u.Q[e].icon,width:8,height:8},"chain_".concat(e))}))}):(0,k.jsx)(I.Ug,{width:"full",alignItems:"center",justifyContent:"flex-start",children:(0,k.jsx)(b.AssetProvider,{assetId:t,children:(0,k.jsx)(b.AssetProvider.GeneralData,{field:"chainId",width:6,height:6})})})},sortType:S._O},{width:"30%",accessor:"tvlUsd",Header:z("defi.tvl"),Cell:function(e){var t=e.value,n=e.row;return(0,k.jsx)(B.N2,{noOfLines:1,isLoaded:!!t,children:"AA"===n.original.type||"BB"===n.original.type?(0,k.jsx)(b.AssetProvider,{assetId:n.original.id,children:(0,k.jsxs)(I.Ug,{spacing:6,width:"full",children:[(0,k.jsxs)(I.Ug,{minW:"fit-content",width:["auto","25%"],children:[(0,k.jsx)(P.Ee,{src:"images/strategies/AA.svg"}),(0,k.jsx)(b.AssetProvider.SeniorPoolUsd,{color:p.A.AA.color,textStyle:"tableCell"})]}),(0,k.jsxs)(I.Ug,{children:[(0,k.jsx)(P.Ee,{src:"images/strategies/BB.svg"}),(0,k.jsx)(b.AssetProvider.JuniorPoolUsd,{color:p.A.BB.color,textStyle:"tableCell"})]})]})}):(0,k.jsx)(x.Amount.Usd,{abbreviate:!1,decimals:0,value:t,textStyle:"tableCell"})})},sortType:S._O},{width:"30%",accessor:"apyRange",Header:z("stats.apyRange"),Cell:function(e){var t=e.value,n=e.row;return"AA"===n.original.type||"BB"===n.original.type?(0,k.jsx)(b.AssetProvider,{assetId:n.original.id,children:(0,k.jsxs)(I.Ug,{spacing:6,width:"full",children:[(0,k.jsxs)(I.Ug,{minW:"fit-content",width:["auto","25%"],children:[(0,k.jsx)(P.Ee,{src:"images/strategies/AA.svg"}),(0,k.jsx)(b.AssetProvider.SeniorApy,{color:p.A.AA.color,textStyle:"tableCell"})]}),(0,k.jsxs)(I.Ug,{children:[(0,k.jsx)(P.Ee,{src:"images/strategies/BB.svg"}),(0,k.jsx)(b.AssetProvider.JuniorApy,{color:p.A.BB.color,textStyle:"tableCell"})]})]})}):"BY"===n.original.type?(0,k.jsx)(b.AssetProvider,{assetId:n.original.id,children:(0,k.jsx)(b.AssetProvider.Apy,{showTooltip:!1,textStyle:"tableCell"})}):(0,k.jsx)(I.Ug,{spacing:1,children:1===n.original.subRows.length&&"best"===n.original.strategy?(0,k.jsx)(x.Amount.Percentage,{value:(null===t||void 0===t?void 0:t.maxApy)||null,textStyle:"tableCell"}):(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(x.Amount.Percentage,{value:(null===t||void 0===t?void 0:t.minApy)||null,textStyle:"tableCell"}),(0,k.jsx)(I.xv,{children:"-"}),(0,k.jsx)(x.Amount.Percentage,{value:(null===t||void 0===t?void 0:t.maxApy)||null,textStyle:"tableCell"})]})})},sortType:function(e,t,n){var s=(0,S.KS)(e.original,n),i=(0,S.KS)(t.original,n);if(!s||!i)return 1;var a=(0,S.gA)(s.maxApy).isNaN()?(0,S.gA)(-1):(0,S.gA)(s.maxApy),l=(0,S.gA)(i.maxApy).isNaN()?(0,S.gA)(-1):(0,S.gA)(i.maxApy);return a.gt(l)?-1:1}}]}),[z]),re=(0,y.useMemo)((function(){return Object.values(ne)}),[ne]),oe=(0,y.useMemo)((function(){return{sortBy:[{id:"tvlUsd",desc:!1}]}}),[]),ce=(0,y.useCallback)((function(e){var t=e.target.value;K(t)}),[K]),de=(0,y.useMemo)((function(){var e=z("common.search");return(0,k.jsxs)(I.Ug,{spacing:2,width:"full",justifyContent:"space-between",children:[(0,k.jsxs)(I.Ug,{children:[(0,k.jsx)(A.Translation,{component:O.zx,variant:"tab",translation:"common.all","aria-selected":!F,onClick:function(){return J(null)}}),Object.keys(te).map((function(e){return(0,k.jsx)(A.Translation,{component:O.zx,variant:"tab",translation:"strategies.".concat(e,".label"),"aria-selected":F===e,onClick:function(){return J(e)}},e)}))]}),!E&&(0,k.jsx)(I.Ug,{children:(0,k.jsxs)(R.BZ,{children:[(0,k.jsx)(R.II,{type:"text",placeholder:e,variant:"search",onChange:ce}),(0,k.jsx)(R.xH,{children:(0,k.jsx)(o.vU7,{size:24,color:_.colors.cta})})]})})]})}),[F,E,z,te,J,_,ce]),ue=(0,y.useMemo)((function(){return E?(0,k.jsxs)(I.gC,{spacing:4,width:"100%",alignItems:"flex-start",children:[de,re.map((function(e,t){return(0,k.jsx)(h.VaultCard.Stats,{asset:e,onRowClick:function(e){return $(e.id)},handleClick:function(e){return X(e)},isOpen:Q===e},t)}))]}):(0,k.jsx)(c.Card,{children:(0,k.jsxs)(I.gC,{spacing:6,width:"full",alignItems:"flex-start",children:[de,(0,k.jsx)(m.ReactTable,{data:re,columns:le,initialState:oe,onRowClick:function(e){return $(e.original.id)}})]})})}),[E,de,re,le,oe,$,Q,X]);return(0,k.jsxs)(I.gC,{mt:14,width:"full",spacing:[4,10],alignItems:"flex-start",children:[(0,k.jsxs)(I.Kq,{width:"full",spacing:[4,0],justifyContent:"space-between",alignItems:["flex-start","flex-end"],direction:["column-reverse","row"],children:[(0,k.jsx)(A.Translation,{translation:"defi.chooseAsset",textStyle:"heading",fontSize:"xl"}),(0,k.jsxs)(I.Ug,{pr:[0,8],spacing:[0,10],width:["full","auto"],justifyContent:["space-between","flex-end"],children:[(0,k.jsxs)(I.gC,{spacing:1,alignItems:"flex-start",display:["none","flex"],children:[(0,k.jsx)(A.Translation,{translation:"defi.avgApy",textStyle:"captionSmall"}),(0,k.jsx)(B.N2,{noOfLines:2,isLoaded:!!T,children:(0,k.jsx)(x.Amount.Percentage,{value:ae,textStyle:"h2",lineHeight:"normal"})})]}),(0,k.jsxs)(I.gC,{spacing:1,alignItems:"flex-start",children:[(0,k.jsx)(A.Translation,{translation:"stats.totalTVL",textStyle:"captionSmall"}),(0,k.jsx)(B.N2,{noOfLines:2,isLoaded:!!T,children:(0,k.jsx)(x.Amount.Usd,{value:ie,textStyle:"h2",lineHeight:"normal"})})]})]})]}),ue]})}}}]);