"use strict";(self.webpackChunkidle_dashboard_new=self.webpackChunkidle_dashboard_new||[]).push([[1309],{63330:function(t,e,n){n.r(e),n.d(e,{AssetPage:function(){return M}});var s=n(1413),a=n(29439),i=n(76566),r=n(16120),o=n(95173),l=n(98428),c=n(66288),d=n(3717),u=n(86698),m=n(61617),x=n(29482),p=n(97901),f=n(96362),g=n(15542),v=n(98365),h=n(85267),j=n(1669),w=n(75712),b=n(7276),y=n(99594),S=n(61925),C=n(88089),A=n(3498),I=n(37658),k=n(40398),T=n(45263),M=function(){var t=(0,o.s0)(),e=(0,c.X)(),n=e.isMobile,M=e.environment,D=(0,h.m)(),P=D.params,Z=D.location,B=D.searchParams,U=(0,b.useState)(0),E=(0,a.Z)(U,2),z=E[0],G=E[1],F=(0,b.useState)(0),L=(0,a.Z)(F,2),_=L[0],O=L[1],H=(0,b.useState)(),R=(0,a.Z)(H,2),N=R[0],W=R[1],V=(0,b.useMemo)((function(){return B}),[B]),K=(0,a.Z)(V,2),q=K[0],X=K[1],$=(0,b.useState)({startDate:null,endDate:null}),Y=(0,a.Z)($,2),Q=Y[0],J=Y[1],tt=(0,b.useState)(k.WE["6MONTHS"]),et=(0,a.Z)(tt,2),nt=et[0],st=et[1],at=(0,b.useMemo)((function(){return!!Q.startDate&&!!Q.endDate}),[Q]);(0,b.useEffect)((function(){at&&st(void 0)}),[at,st]),(0,b.useEffect)((function(){nt&&J({endDate:null,startDate:null})}),[nt,J]);var it=(0,j.w)(),rt=it.isPortfolioLoaded,ot=it.portfolioTimestamp,lt=it.assetsDataTimestamp,ct=it.isPortfolioAccountReady,dt=it.selectors,ut=dt.selectAssetById,mt=dt.selectVaultById,xt=dt.selectVaultGauge,pt=dt.selectAssetBalance,ft=dt.selectAssetPriceUsd,gt=(0,b.useMemo)((function(){return ut&&ut(P.asset)}),[ut,P.asset]),vt=(0,b.useMemo)((function(){return mt&&mt(P.asset)}),[mt,P.asset]);(0,b.useEffect)((function(){gt&&O(Date.now())}),[gt]);var ht=(0,b.useMemo)((function(){if(!gt||!pt||null===gt||void 0===gt||!gt.underlyingId||!ft)return(0,y.gA)(0);var t=pt(gt.underlyingId),e=ft(gt.underlyingId);return(0,y.d5)(t).times((0,y.d5)(e))}),[gt,pt,ft]),jt=(0,b.useMemo)((function(){return xt&&xt(P.asset)}),[xt,P.asset]),wt=(0,b.useMemo)((function(){return jt&&ut&&ut(jt.id)}),[ut,jt]),bt=(0,b.useMemo)((function(){var t;return wt&&"gaugeData"in wt&&null!==(t=wt.gaugeData)&&void 0!==t&&t.rewards?Object.values(wt.gaugeData.rewards).reduce((function(t,e){return t.plus((0,y.d5)(e.balance))}),(0,y.gA)(0)):(0,y.gA)(0)}),[wt]);(0,b.useEffect)((function(){if(rt&&ut&&Z&&_)return gt?void 0:t(Z.pathname.replace("/".concat(P.asset),""))}),[rt,ut,_,gt,P.asset,Z,t]),(0,b.useEffect)((function(){!(ct&&gt&&N!==(null===gt||void 0===gt?void 0:gt.id)&&ot&&lt)||ot>lt||lt>_||((0,y.AV)(gt,ht),W(gt.id))}),[gt,ot,ht,lt,ct,_,N,W]);var yt=(0,b.useMemo)((function(){var t=[{id:"earn",label:"navBar.earn",component:i.Earn,actions:[{type:"deposit",component:p.Deposit,label:"common.deposit",steps:[{type:"approve",component:f.Approve,label:"modals.approve.header"}]},{type:"withdraw",label:"common.withdraw",component:v.Withdraw,steps:[]}]}],e=jt&&"enabled"in jt&&!jt.enabled;jt&&(!e||(0,y.d5)(null===wt||void 0===wt?void 0:wt.balance).gt(0)||(0,y.d5)(bt).gt(0))&&t.push({id:"gauge",label:"navBar.gauge",component:r.GaugeStaking,icon:e&&((0,y.gA)(null===wt||void 0===wt?void 0:wt.balance).gt(0)||(0,y.d5)(bt).gt(0))?{src:"".concat(k.pm,"vaults/deprecated.png"),tooltip:"trade.vaults.GG.disabled",props:{width:5,height:5}}:null,actions:[{type:"stake",component:p.Deposit,label:"common.stake",steps:[{type:"approve",component:f.Approve,label:"modals.approve.header"}]},{type:"unstake",label:"common.unstake",component:v.Withdraw,steps:[]}]});var n=!(null!==vt&&void 0!==vt&&vt.flags)||void 0===vt.flags.statsEnabled||vt.flags.statsEnabled;return(0,y.xW)("stats",M)&&n&&t.push({id:"stats",label:"navBar.stats",component:u.AssetStats,componentProps:{timeframe:nt,dateRange:Q,assetOnly:!0,showHeader:!1,showAssetStrategy:!0}}),t}),[vt,jt,wt,nt,Q,M,bt]),St=(0,b.useMemo)((function(){return q.get("tab")}),[q]);(0,b.useEffect)((function(){if(St){var t=yt.find((function(t){return t.id.toString()===St.toString()}));if(t){var e=yt.indexOf(t);G(e)}else G(0)}else G(0)}),[yt,St,G]);var Ct=(0,b.useMemo)((function(){return yt[z]&&"gauge"===yt[z].id&&jt?jt.id:null===gt||void 0===gt?void 0:gt.id}),[yt,z,gt,jt]),At=(0,b.useMemo)((function(){return yt[z]}),[yt,z]),It=(0,b.useMemo)((function(){return At.component}),[At]),kt=(0,b.useCallback)((function(t){var e=yt[t];e&&X("?tab=".concat(e.id))}),[yt,X]),Tt=(0,b.useMemo)((function(){return(0,T.jsx)(C.mQ,{variant:"unstyled",index:z,width:["100%","auto"],children:(0,T.jsx)(C.td,{children:yt.map((function(t,e){return(0,T.jsx)(l.IconTab,{width:["".concat(100/yt.length,"%"),"auto"],icon:t.icon,onClick:function(){return kt(e)},children:(0,T.jsx)(g.Translation,{translation:t.label})},"tab_".concat(e))}))})})}),[yt,kt,z]),Mt=(0,b.useMemo)((function(){return At.actions?(0,T.jsx)(I.InteractiveComponent,{vaultId:null===gt||void 0===gt?void 0:gt.id,assetId:Ct,actions:At.actions}):null}),[At,gt,Ct]),Dt=(0,b.useMemo)((function(){return(0,T.jsxs)(A.Ug,{mb:[0,"3 !important"],spacing:4,pl:[0,"stats"===At.id?5:0],justifyContent:["center","flex-end"],borderLeft:n||"stats"!==At.id?"none":"1px solid",borderLeftColor:"divider",children:[(0,T.jsxs)(A.Ug,{spacing:1,children:[(0,T.jsx)(x.ProductTag,{type:null===gt||void 0===gt?void 0:gt.type,fontSize:"md",h:8}),(0,T.jsx)(w.AssetProvider.Strategies,{h:8,w:8})]}),(0,T.jsx)(A.Ug,{pl:4,borderLeft:"1px solid",borderLeftColor:"divider",children:(0,T.jsx)(w.AssetProvider.Protocols,{tooltipDisabled:!0,size:"sm",children:(0,T.jsx)(w.AssetProvider.ProtocolIcon,{size:"sm"})})})]})}),[At,gt,n]),Pt=(0,b.useMemo)((function(){return(0,T.jsxs)(A.Kq,{spacing:[0,5],direction:["column","row"],children:["stats"===At.id&&(0,T.jsxs)(A.Kq,{spacing:2,mt:[3,"-15px"],width:["full","auto"],direction:["column","row"],alignItems:["auto","center"],justifyContent:["flex-start","center"],children:[(0,T.jsx)(S.TimeframeSelector,{variant:"button",timeframe:nt,setTimeframe:st,width:["100%","auto"],justifyContent:["center","initial"]}),(0,T.jsx)(d.DatePicker,{selected:at,setDateRange:J})]}),!n&&Dt]})}),[At,n,nt,st,at,J,Dt]);return(0,T.jsx)(w.AssetProvider,{wrapFlex:!0,assetId:P.asset,children:(0,T.jsxs)(A.xu,{width:"100%",children:[(0,T.jsx)(A.kC,{my:[10,14],width:"100%",id:"asset-top-header",direction:["column","row"],justifyContent:["center","space-between"],children:(0,T.jsxs)(A.Kq,{width:"100%",spacing:[4,8],alignItems:"center",justifyContent:"center",direction:["column","row"],children:[(0,T.jsx)(A.Ug,{spacing:2,alignItems:"center",children:(0,T.jsx)(m.AssetLabel,{assetId:P.asset,fontSize:"h2",extraFields:["statusBadge"]})}),n&&Dt,(0,T.jsxs)(A.Kq,{flex:1,spacing:0,width:["100%","auto"],justifyContent:"space-between",borderBottom:[0,"1px solid"],direction:["column","row"],borderColor:["divider","divider"],children:[(0,T.jsx)(A.Ug,{width:["full","auto"],borderBottom:["1px solid",0],borderColor:"divider",children:Tt}),Pt]})]})}),(0,T.jsxs)(A.Ug,{width:"100%",spacing:[0,10],alignItems:"space-between",children:[(0,T.jsx)(A.Kq,{flex:1,mb:[20,0],spacing:10,width:["100%",.7],children:(0,T.jsx)(It,(0,s.Z)({},yt[z].componentProps))}),Mt]})]})})}},16120:function(t,e,n){n.r(e),n.d(e,{GaugeStaking:function(){return h}});var s=n(29439),a=n(54447),i=n(40398),r=n(86059),o=n(7276),l=n(15542),c=n(1669),d=n(85267),u=n(99594),m=n(75712),x=n(3148),p=n(72258),f=n(3498),g=n(30422),v=n(45263),h=function(){var t,e,n,h,j,w=(0,d.m)().params,b=(0,o.useState)(0),y=(0,s.Z)(b,2),S=y[0],C=y[1],A=(0,o.useState)(),I=(0,s.Z)(A,2),k=I[0],T=I[1],M=(0,c.w)(),D=M.portfolioTimestamp,P=M.assetsDataTimestamp,Z=M.isPortfolioAccountReady,B=M.selectors,U=B.selectAssetById,E=B.selectVaultGauge,z=B.selectAssetBalance,G=B.selectAssetPriceUsd,F=(0,o.useMemo)((function(){return U&&U(w.asset)}),[U,w.asset]),L=(0,o.useMemo)((function(){return F&&E&&E(F.id)}),[E,F]),_=(0,o.useMemo)((function(){return U&&L&&U(L.id)}),[L,U]),O=(0,o.useMemo)((function(){return Object.keys(i.A2).find((function(t){return i.A2[t].route===w.strategy}))}),[w]),H=(0,o.useMemo)((function(){return O&&i.A2[O].color}),[O]),R=(0,o.useMemo)((function(){if(!L)return null;var t=i.A2[L.type];return null!==t&&void 0!==t&&t.carouselItems?(0,v.jsx)(g.StrategyDescriptionCarousel,{color:H,strategy:L.type,delay:1e4}):null}),[L,H]),N=(0,o.useMemo)((function(){var t;return(null===_||void 0===_?void 0:_.vaultPosition)&&(0,u.gA)(null===_||void 0===_||null===(t=_.vaultPosition)||void 0===t?void 0:t.underlying.redeemable).div(_.totalSupply)}),[_]),W=(0,o.useMemo)((function(){if(!_||null===_||void 0===_||!_.underlyingId||!z||!G)return(0,u.gA)(0);var t=z(_.underlyingId),e=G(_.underlyingId);return(0,u.d5)(t).times((0,u.d5)(e))}),[_,z,G]),V=(0,o.useMemo)((function(){return L&&"description"in L&&L.description?(0,v.jsx)(a.Card.Dark,{children:(0,v.jsx)(f.xv,{dangerouslySetInnerHTML:{__html:L.description}})}):null}),[L]);return(0,o.useEffect)((function(){_&&C(Date.now())}),[_]),(0,o.useEffect)((function(){!(Z&&_&&k!==(null===_||void 0===_?void 0:_.id)&&D&&P)||D>P||P>S||((0,u.AV)(_,W),T(_.id))}),[_,D,W,P,Z,S,k,T]),(0,v.jsxs)(f.gC,{spacing:10,width:"100%",children:[V,_.vaultPosition&&(0,v.jsx)(m.AssetProvider,{wrapFlex:!1,assetId:L.id,children:(0,v.jsxs)(f.MI,{width:"100%",columns:[2,4],spacing:[10,14],alignItems:"flex-start",children:[(0,v.jsxs)(f.gC,{spacing:2,justifyContent:"center",children:[(0,v.jsx)(l.Translation,{component:f.xv,translation:"defi.deposited",textStyle:"titleSmall"}),(0,v.jsxs)(f.Ug,{spacing:1,alignItems:"baseline",children:[(0,v.jsx)(m.AssetProvider.Deposited,{textStyle:"heading",fontSize:"h3"}),(0,v.jsx)(m.AssetProvider.Name,{textStyle:"heading",fontSize:"h3"})]})]}),(0,v.jsxs)(f.gC,{spacing:2,justifyContent:"center",children:[(0,v.jsx)(l.Translation,{component:f.xv,translation:"defi.share",textStyle:"titleSmall"}),(0,v.jsx)(m.AssetProvider.GaugeShare,{minValue:.01,textStyle:"heading",fontSize:"h3"})]}),(0,v.jsxs)(f.gC,{spacing:2,justifyContent:"center",children:[(0,v.jsx)(l.Translation,{component:f.xv,translation:"defi.idleDistribution",textStyle:"titleSmall"}),(0,v.jsxs)(f.Ug,{spacing:1,alignItems:"baseline",children:[(0,v.jsx)(m.AssetProvider.GaugeUserDistribution,{suffix:" ".concat(null===(t=L.rewardToken)||void 0===t?void 0:t.token),textStyle:"heading",fontSize:"h3"}),(0,v.jsx)(l.Translation,{component:f.xv,translation:["/","common.day"],textStyle:"captionSmall",textTransform:"lowercase"})]})]}),(0,v.jsxs)(f.gC,{spacing:2,justifyContent:"center",children:[(0,v.jsx)(l.Translation,{component:f.xv,translation:"defi.additionalRewards",textStyle:"titleSmall"}),(0,v.jsx)(f.gC,{spacing:2,children:(null===(e=L.multiRewardsTokens)||void 0===e?void 0:e.length)>0&&_.gaugeData?Object.keys(null===(n=_.gaugeData)||void 0===n?void 0:n.rewards).map((function(t){var e=_.gaugeData.rewards[t];if(t===L.rewardToken.address)return null;var n=U(t);return(0,v.jsxs)(f.Ug,{spacing:1,alignItems:"baseline",children:[(0,v.jsx)(r.Amount,{value:e.rate.times(N),suffix:" ".concat(n.token),textStyle:"heading",fontSize:"h3"}),(0,v.jsx)(l.Translation,{component:f.xv,translation:["/","common.day"],textStyle:"captionSmall",textTransform:"lowercase"})]},"reward_".concat(t))})):(0,v.jsx)(f.xv,{textStyle:"heading",fontSize:"h3",children:"-"})})]})]})}),(0,v.jsxs)(f.gC,{spacing:6,width:"100%",alignItems:"flex-start",children:[(0,v.jsx)(l.Translation,{component:f.X6,as:"h3",size:"md",translation:"defi.rewards"}),(0,v.jsx)(f.gC,{spacing:4,width:"100%",children:(0,u.xb)(null===(h=_.gaugeData)||void 0===h?void 0:h.rewards)?null:Object.keys(null===(j=_.gaugeData)||void 0===j?void 0:j.rewards).map((function(t){var e=_.gaugeData.rewards[t],n=L.getClaimRewardsContractSendMethod(t);return(0,v.jsx)(m.AssetProvider,{wrapFlex:!1,assetId:t,children:(0,v.jsx)(a.Card,{p:6,px:8,width:"100%",children:(0,v.jsxs)(f.Kq,{width:"100%",spacing:[4,0],alignItems:"center",direction:["column","row"],justifyContent:"space-between",children:[(0,v.jsxs)(f.MI,{width:"100%",spacing:[6,0],columns:[2,4],children:[(0,v.jsxs)(f.gC,{spacing:2,alignItems:"flex-start",justifyContent:"flex-start",children:[(0,v.jsx)(l.Translation,{component:f.xv,translation:"defi.asset",textStyle:"captionSmall"}),(0,v.jsx)(m.AssetProvider.GeneralData,{size:"xs",field:"asset"})]}),(0,v.jsxs)(f.gC,{spacing:2,alignItems:"flex-start",justifyContent:"flex-start",children:[(0,v.jsx)(l.Translation,{component:f.xv,translation:"defi.apy",textStyle:"captionSmall"}),(0,v.jsx)(r.Amount.Percentage,{textStyle:"tableCell",value:e.apr})]}),(0,v.jsxs)(f.gC,{spacing:2,alignItems:"flex-start",justifyContent:"flex-start",children:[(0,v.jsx)(l.Translation,{component:f.xv,translation:"defi.dailyDistribution",textStyle:"captionSmall"}),(0,v.jsxs)(f.Ug,{spacing:1,width:"100%",children:[(0,v.jsx)(r.Amount,{textStyle:"tableCell",value:e.rate}),(0,v.jsx)(m.AssetProvider.Name,{textStyle:"tableCell"})]})]}),(0,v.jsxs)(f.gC,{spacing:2,alignItems:"flex-start",justifyContent:"flex-start",children:[(0,v.jsx)(l.Translation,{component:f.xv,translation:"defi.claimable",textStyle:"captionSmall"}),(0,v.jsxs)(f.Ug,{spacing:1,width:"100%",children:[(0,v.jsx)(r.Amount,{textStyle:"tableCell",value:e.balance}),(0,v.jsx)(m.AssetProvider.Name,{textStyle:"tableCell"})]})]})]}),(0,v.jsx)(p.TransactionButton,{text:"defi.claim",vaultId:F.id,assetId:t,contractSendMethod:n,actionType:"claim",amount:e.balance.toString(),width:["100%","150px"],disabled:e.balance.lte(0)})]})})},"reward_".concat(t))}))})]}),(0,v.jsx)(x.AssetGeneralData,{assetId:null===L||void 0===L?void 0:L.id}),R]})}},98428:function(t,e,n){n.r(e),n.d(e,{IconTab:function(){return x}});var s=n(1413),a=n(7276),i=n(79681),r=n(88089),o=n(96699),l=n(43127),c=n(3498),d=n(70820),u=n(2092),m=n(45263),x=a.forwardRef((function(t,e){var n=(0,i.qM)(),a=(0,r.xD)((0,s.Z)((0,s.Z)({},t),{},{ref:e})),x=(0,o.jC)("Tabs",(0,s.Z)((0,s.Z)({},a),{},{variant:"unstyled"}));return(0,m.jsx)(l.zx,(0,s.Z)((0,s.Z)({background:"transparent",borderRadius:0,__css:x.tab},a),{},{children:(0,m.jsxs)(c.Ug,{spacing:2,width:"full",justifyContent:"center",children:[a.children,t.icon&&(0,m.jsx)(d.u,{hasArrow:!0,placement:"top",label:t.icon.tooltip?n(t.icon.tooltip):"",children:(0,m.jsx)(u.Ee,(0,s.Z)({src:t.icon.src},t.icon.props))})]})}))}))},37658:function(t,e,n){n.r(e),n.d(e,{InteractiveComponent:function(){return x}});var s=n(29439),a=n(7276),i=n(55967),r=n(66288),o=n(15542),l=n(3498),c=n(43127),d=n(18147),u=n(4710),m=n(45263),x=function(t){var e=t.assetId,n=t.vaultId,x=t.actions,p=(0,r.X)().isMobile,f=(0,a.useState)(!1),g=(0,s.Z)(f,2),v=g[0],h=g[1],j=(0,a.useState)(!1),w=(0,s.Z)(j,2),b=w[0],y=w[1];return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)(l.gC,{left:0,zIndex:[40,0],spacing:[0,6],id:"right-side",width:["100vw","27em"],height:["100vh","auto"],position:["fixed","relative"],top:[v?0:"100vh",0],bg:p?"rgba(0, 0, 0, 0.5)":void 0,sx:p?{transition:"top 0.3s ease-in-out"}:{},children:[(0,m.jsxs)(l.gC,{bottom:0,spacing:0,width:"100%",height:["100vh","auto"],position:["fixed","relative"],top:[v?0:"100vh",0],sx:p?{transition:"top 0.3s ease-in-out"}:{},children:[p&&(0,m.jsxs)(l.Ug,{px:4,py:2,bg:"card.bg",width:"100%",borderBottom:"1px solid",borderBottomColor:"divider",justifyContent:"space-between",children:[(0,m.jsx)(o.Translation,{alignItems:"center",display:"flex",variant:"unstyled",translation:"common.exit",component:c.zx,leftIcon:(0,m.jsx)(i.sG8,{size:24}),onClick:function(){return h(!1)}}),(0,m.jsx)(o.Translation,{alignItems:"center",display:"flex",variant:"unstyled",translation:["common.show","navBar.transactions"],component:c.zx,onClick:function(){return y(!0)}})]}),(0,m.jsx)(u.OperativeComponent,{flex:1,minHeight:p?"auto":"590px",borderRadius:p?0:void 0,assetId:e,actions:x})]}),(0,m.jsxs)(l.gC,{flex:1,bottom:0,spacing:0,width:"100%",height:["100vh","auto"],position:["fixed","relative"],top:[b?0:"100vh",0],sx:p?{transition:"top 0.3s ease-in-out"}:{},children:[p&&(0,m.jsxs)(l.Ug,{px:4,py:2,bg:"card.bg",width:"100%",borderBottom:"1px solid",borderBottomColor:"divider",justifyContent:"space-between",children:[(0,m.jsx)(o.Translation,{alignItems:"center",display:"flex",variant:"unstyled",translation:"common.back",component:c.zx,leftIcon:(0,m.jsx)(i.sG8,{size:24}),onClick:function(){return y(!1)}}),(0,m.jsx)(o.Translation,{textStyle:"ctaStatic",translation:"assets.assetDetails.assetHistory.transactionHistory",component:l.xv})]}),(0,m.jsx)(d.TransactionList,{assetIds:[n],fullHeightOnMobile:!0,maxH:["100%",600]})]})]}),p&&(0,m.jsx)(l.kC,{p:4,left:0,bottom:0,border:0,width:"100%",zIndex:[10,0],bg:"card.bgDark",position:"fixed",children:(0,m.jsx)(o.Translation,{component:c.zx,translation:["common.start","common.deposit"],variant:"ctaFull",onClick:function(){return h(!0)}})})]})}},96362:function(t,e,n){n.r(e),n.d(e,{Approve:function(){return S}});var s=n(74165),a=n(15861),i=n(29439),r=n(54447),o=n(99594),l=n(87099),c=n(55967),d=n(39195),u=n(72230),m=n(7276),x=n(15542),p=n(1128),f=n(23023),g=n(3498),v=n(65984),h=n(43127),j=n(78951),w=n(4710),b=n(75712),y=n(45263),S=function(t){var e=t.amountUsd,n=t.goBack,S=t.itemIndex,C=(0,d.Y)().account,A=(0,w.useOperativeComponent)(),I=A.defaultAmount,k=A.dispatch,T=A.activeItem,M=(0,m.useState)(I),D=(0,i.Z)(M,2),P=D[0],Z=D[1],B=(0,b.useAssetProvider)(),U=B.underlyingAsset,E=B.vault,z=B.translate,G=B.theme,F=(0,m.useState)(!1),L=(0,i.Z)(F,2),_=L[0],O=L[1],H=(0,m.useState)(I),R=(0,i.Z)(H,2),N=R[0],W=R[1],V=(0,f.R)(),K=V.sendTransaction,q=V.setGasLimit;(0,m.useEffect)((function(){Z(I)}),[I]);var X=(0,m.useCallback)((0,a.Z)((0,s.Z)().mark((function t(){var e,n,a,i;return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(E&&"getAllowanceContractSendMethod"in E&&"getAllowanceParams"in E){t.next=2;break}return t.abrupt("return");case 2:if(e={from:null===C||void 0===C?void 0:C.address},n=E.getAllowanceParams(l.Uf),a=E.getAllowanceContractSendMethod(n)){t.next=7;break}return t.abrupt("return");case 7:return t.next=9,(0,o.$K)(a,e);case 9:return i=t.sent,t.abrupt("return",i);case 11:case"end":return t.stop()}}),t)}))),[C,E]),$=(0,m.useCallback)((function(){if(E&&"getAllowanceContractSendMethod"in E&&"getAllowanceParams"in E){var t=E.getAllowanceParams(N),e=E.getAllowanceContractSendMethod(t);e&&K(E.id,null===U||void 0===U?void 0:U.id,e)}}),[N,E,U,K]);return(0,m.useEffect)((function(){var t=_?P:l.Uf;W(t),T===S&&k({type:"SET_AMOUNT",payload:t})}),[_,P,k,T,S]),(0,m.useEffect)((function(){T===S&&(0,a.Z)((0,s.Z)().mark((function t(){var e;return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,X();case 2:e=t.sent,q(e);case 4:case"end":return t.stop()}}),t)})))()}),[T,S,X,q]),(0,y.jsxs)(g.gC,{flex:1,width:"100%",alignItems:"flex-start",children:[(0,y.jsx)(u.NavBar,{goBack:n,translation:"modals.approve.header",params:{asset:null===U||void 0===U?void 0:U.name}}),(0,y.jsx)(g.kC,{p:14,pt:20,flex:1,children:(0,y.jsxs)(g.gC,{spacing:6,children:[(0,y.jsx)(c.PG4,{size:72}),(0,y.jsx)(x.Translation,{component:g.xv,prefix:"".concat(z("modals.approve.routerName")," "),translation:"modals.approve.body",params:{asset:null===U||void 0===U?void 0:U.name},textStyle:"heading",fontSize:"h3",textAlign:"center"}),(0,y.jsxs)(g.gC,{width:"100%",spacing:6,children:[(0,y.jsxs)(g.Ug,{py:2,width:"100%",justifyContent:"space-between",borderTop:"1px solid ".concat(G.colors.divider),borderBottom:"1px solid ".concat(G.colors.divider),children:[(0,y.jsx)(x.Translation,{component:g.xv,translation:"trade.allowance",textStyle:"captionSmall"}),(0,y.jsxs)(g.Ug,{spacing:1,children:[(0,y.jsx)(x.Translation,{component:g.xv,translation:"trade.unlimited",textStyle:["captionSmall","clickable"],fontWeight:700,color:_?"ctaDisabled":"primary",onClick:function(){return O(!1)}}),(0,y.jsx)(v.r,{size:"sm",isChecked:_,onChange:function(t){return O(t.target.checked)}}),(0,y.jsx)(x.Translation,{component:g.xv,translation:"trade.exact",textStyle:["captionSmall","clickable"],fontWeight:700,color:_?"primary":"ctaDisabled",onClick:function(){return O(!0)}})]})]}),_&&(0,y.jsxs)(g.Ug,{children:[(0,y.jsx)(b.AssetProvider.Icon,{size:"sm"}),(0,y.jsx)(r.Card,{px:4,py:2,layerStyle:"cardLight",children:(0,y.jsx)(p.InputAmount,{inputHeight:6,amount:P,amountUsd:e,setAmount:Z})})]})]}),(0,y.jsx)(x.Translation,{component:h.zx,translation:"common.approve",onClick:$,variant:"ctaFull"})]})}),(0,y.jsx)(j.EstimatedGasFees,{})]})}},98365:function(t,e,n){n.r(e),n.d(e,{Withdraw:function(){return D}});var s=n(74165),a=n(15861),i=n(29439),r=n(5128),o=n(54447),l=n(86059),c=n(93429),d=n(39195),u=n(99594),m=n(61617),x=n(15542),p=n(1128),f=n(85267),g=n(1669),v=n(7276),h=n(23023),j=n(4710),w=n(78951),b=n(66624),y=n(86393),S=n(75712),C=n(43127),A=n(52486),I=n(3498),k=n(2092),T=n(73131),M=n(45263),D=function(t){var e=t.itemIndex,n=(0,v.useState)("0"),D=(0,i.Z)(n,2),P=D[0],Z=D[1],B=(0,v.useState)(""),U=(0,i.Z)(B,2),E=U[0],z=U[1],G=(0,v.useState)(0),F=(0,i.Z)(G,2),L=F[0],_=F[1],O=(0,v.useState)(!1),H=(0,i.Z)(O,2),R=H[0],N=H[1],W=(0,v.useState)(null),V=(0,i.Z)(W,2),K=V[0],q=V[1],X=(0,v.useState)(!1),$=(0,i.Z)(X,2),Y=$[0],Q=$[1],J=(0,d.Y)().account,tt=(0,f.m)().searchParams,et=(0,j.useOperativeComponent)(),nt=et.dispatch,st=et.activeItem,at=et.activeStep,it=(0,S.useAssetProvider)(),rt=it.asset,ot=it.vault,lt=it.underlyingAsset,ct=it.translate,dt=(0,h.R)(),ut=dt.sendTransaction,mt=dt.setGasLimit,xt=dt.state.transaction,pt=(0,g.w)().selectors,ft=pt.selectAssetPriceUsd,gt=pt.selectVaultPrice,vt=pt.selectAssetBalance,ht=pt.selectVaultGauge,jt=pt.selectAssetById,wt=(0,v.useMemo)((function(){return tt}),[tt]),bt=(0,i.Z)(wt,2)[1],yt=(0,v.useCallback)((function(){return Q((function(t){return!t}))}),[Q]),St=(0,v.useMemo)((function(){return vt?vt(null===ot||void 0===ot?void 0:ot.id):(0,u.gA)(0)}),[vt,null===ot||void 0===ot?void 0:ot.id]),Ct=(0,v.useMemo)((function(){return(null===rt||void 0===rt?void 0:rt.id)&&ht&&ht(rt.id)}),[ht,null===rt||void 0===rt?void 0:rt.id]),At=(0,v.useMemo)((function(){return Ct&&jt&&jt(Ct.id)}),[jt,Ct]),It=(0,v.useMemo)((function(){var t,e;return ot&&"getWithdrawInterestBearingContractSendMethod"in ot&&"paused"===(null===rt||void 0===rt?void 0:rt.status)&&(!("flags"in ot)||void 0===(null===ot||void 0===ot||null===(t=ot.flags)||void 0===t?void 0:t.redeemInterestBearingEnabled)||!(null===ot||void 0===ot||null===(e=ot.flags)||void 0===e||!e.redeemInterestBearingEnabled))}),[ot,rt]),kt=(0,v.useMemo)((function(){return It&&Y?"getWithdrawInterestBearing":"getWithdraw"}),[It,Y]),Tt=(0,v.useMemo)((function(){return"".concat(kt,"Params")}),[kt]),Mt=(0,v.useMemo)((function(){return"".concat(kt,"ContractSendMethod")}),[kt]),Dt=(0,v.useMemo)((function(){if(!vt)return(0,u.gA)(0);var t=vt(null===ot||void 0===ot?void 0:ot.id),e=gt(null===ot||void 0===ot?void 0:ot.id);return t.times(e)}),[vt,gt,null===ot||void 0===ot?void 0:ot.id]),Pt=(0,v.useCallback)((function(){Dt&&Z(Dt.toString())}),[Dt]);(0,v.useEffect)((function(){It&&Y?(Pt(),N(!0)):N(!1)}),[Pt,N,It,Y]);var Zt=(0,v.useMemo)((function(){return z(""),!(!(0,u.gA)(P).isNaN()&&!(0,u.gA)(P).lte(0))||((0,u.gA)(P).gt(Dt)?(z(ct("trade.errors.insufficientFundsForAmount",{symbol:null===lt||void 0===lt?void 0:lt.name})),!0):"started"===xt.status)}),[P,xt,Dt,lt,ct]),Bt=(0,v.useCallback)((function(){J&&!Zt&&ot&&Mt in ot&&Tt in ot&&(0,a.Z)((0,s.Z)().mark((function t(){var e,n,a,i;return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=gt(ot.id),n=r.Z.minimum(St,(0,u.gA)(P).div(e)),a=ot[Tt](n),i=ot[Mt](a),ut(ot.id,ot.id,i);case 5:case"end":return t.stop()}}),t)})))()}),[J,Zt,P,ot,St,gt,ut,Tt,Mt]);(0,v.useEffect)((function(){at===e&&"success"===xt.status&&Z("")}),[xt.status,at,e]),(0,v.useEffect)((function(){if(ft&&gt&&lt&&ot){var t=ft(lt.id),e=parseFloat((0,u.gA)(P).times(t).toString())||0;_(e)}}),[lt,ot,P,gt,ft,nt]);var Ut=(0,v.useCallback)((0,a.Z)((0,s.Z)().mark((function t(){var e,n,a,i,r;return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(ot&&Mt in ot&&Tt in ot){t.next=2;break}return t.abrupt("return");case 2:if(e="getMethodDefaultGasLimit"in ot?ot.getMethodDefaultGasLimit("withdraw"):0,J&&!St.lte(0)){t.next=5;break}return t.abrupt("return",e);case 5:return n={from:null===J||void 0===J?void 0:J.address},a=ot[Tt](St.toFixed()),i=ot[Mt](a),t.next=10,(0,u.$K)(i,n);case 10:if(t.t0=t.sent,t.t0){t.next=13;break}t.t0=e;case 13:return r=t.t0,t.abrupt("return",r);case 15:case"end":return t.stop()}}),t)}))),[J,St,ot,Tt,Mt]);(0,v.useEffect)((function(){q(null),st===e&&(0,a.Z)((0,s.Z)().mark((function t(){var e,n,a,i,r,o;return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Ut();case 3:e=t.sent,mt(e),t.next=15;break;case 7:t.prev=7,t.t0=t.catch(0),n=t.t0.message?t.t0.message.toString().split("\n")[0]:"",a=(0,u.en)(t.t0),r=ct("trade.actions.withdraw.messages.decoded.".concat(i=a||n)),o=r!=="trade.actions.withdraw.messages.decoded.".concat(i)?r:i,q(o);case 15:case"end":return t.stop()}}),t,null,[[0,7]])})))()}),[st,ct,e,Ut,mt,q]),(0,v.useEffect)((function(){st===e&&(nt({type:"SET_ASSET",payload:rt}),gt&&ot&&(nt({type:"SET_AMOUNT",payload:(0,u.gA)(P).toString()}),nt({type:"SET_DEFAULT_AMOUNT",payload:(0,u.gA)(P).toString()})))}),[ot,rt,P,gt,st,e,nt,Bt]);var Et=(0,v.useMemo)((function(){return J?(0,M.jsx)(x.Translation,{component:C.zx,translation:Y?"common.withdrawInterestBearing":"common.withdraw",disabled:Zt,onClick:Bt,variant:"ctaFull",children:"started"===xt.status&&(0,M.jsx)(A.$,{size:"sm"})}):(0,M.jsx)(y.ConnectWalletButton,{variant:"ctaFull"})}),[J,Zt,xt,Bt,Y]),zt=(0,v.useMemo)((function(){return ot&&"messages"in ot?ot.messages:void 0}),[ot]),Gt=(0,v.useMemo)((function(){return!It||St.lte(0)?null:(0,M.jsx)(o.Card.Dark,{px:2,py:3,border:0,children:(0,M.jsxs)(I.gC,{spacing:2,width:"full",justifyContent:"center",children:[(0,M.jsx)(k.Ee,{src:"images/vaults/deprecated.png",width:6,height:6}),(0,M.jsx)(x.Translation,{textAlign:"center",textStyle:"captionSmaller",translation:"trade.actions.redeemInterestBearing.description"}),(0,M.jsx)(x.Translation,{component:T.XZ,size:"md",sx:{">span":{fontSize:"sm"}},translation:"trade.actions.redeemInterestBearing.label",isChecked:Y,onChange:function(){return yt()}})]})})}),[St,Y,yt,It]),Ft=(0,v.useMemo)((function(){return null!==rt&&void 0!==rt&&rt.interestBearingTokens&&null!==rt&&void 0!==rt&&rt.vaultPosition&&ot&&ot instanceof c.H?(0,M.jsxs)(I.gC,{spacing:2,width:"100%",alignItems:"flex-start",children:[(0,M.jsx)(x.Translation,{mb:1,component:I.xv,translation:"dynamicActionFields.stkIDLE",suffix:":",textStyle:"titleSmall"}),Object.keys(null===rt||void 0===rt?void 0:rt.interestBearingTokens).map((function(t){var e,n,s=jt(t)||ot.tokenConfig.protocols.find((function(e){return e.address===t})),a=(0,u.d5)(null===rt||void 0===rt||null===(e=rt.interestBearingTokens)||void 0===e?void 0:e[t]).times((0,u.d5)(null===rt||void 0===rt||null===(n=rt.vaultPosition)||void 0===n?void 0:n.poolShare));return(0,M.jsxs)(I.Ug,{pb:2,px:4,width:"100%",alignItems:"center",borderBottom:"1px solid",borderBottomColor:"divider",justifyContent:"space-between",children:[(0,M.jsx)(I.xv,{textStyle:"captionSmall",children:null===s||void 0===s?void 0:s.token}),(0,M.jsx)(l.Amount,{value:a,textStyle:"titleSmall",color:"primary"})]},"assetField_".concat(t))}))]}):null}),[rt,ot,jt]);return(0,M.jsx)(S.AssetProvider,{flex:1,width:"100%",assetId:null===rt||void 0===rt?void 0:rt.id,children:(0,M.jsxs)(I.gC,{pt:8,flex:1,spacing:6,width:"100%",height:"100%",id:"withdraw-container",alignItems:"space-between",justifyContent:"flex-start",children:[(0,M.jsxs)(I.gC,{flex:1,spacing:6,width:"100%",alignItems:"flex-start",children:[(0,M.jsxs)(I.Ug,{width:"100%",spacing:[3,4],alignItems:"flex-start",children:[(0,M.jsx)(I.xu,{pt:8,children:(0,M.jsx)(m.AssetLabel,{assetId:null===rt||void 0===rt?void 0:rt.id})}),(0,M.jsxs)(I.gC,{spacing:1,width:"100%",alignItems:"flex-start",children:[(0,M.jsx)(o.Card,{px:4,py:2,layerStyle:"cardLight",children:(0,M.jsxs)(I.gC,{spacing:2,alignItems:"flex-start",children:[(0,M.jsx)(p.InputAmount,{amount:P,amountUsd:L,setAmount:Z,isDisabled:R}),(0,M.jsxs)(I.Ug,{width:"100%",justifyContent:"space-between",children:[(0,M.jsxs)(I.Ug,{spacing:1,children:[(0,M.jsx)(x.Translation,{component:I.xv,translation:"common.balance",textStyle:"captionSmaller"}),(0,M.jsx)(S.AssetProvider.VaultBalance,{abbreviate:!0,decimals:4,textStyle:"captionSmaller",color:"primary"})]}),(0,M.jsx)(C.zx,{variant:"selector",onClick:Pt,children:"MAX"})]})]})}),E&&(0,M.jsx)(I.xv,{textStyle:"captionSmaller",color:"orange",children:E})]})]}),K?(0,M.jsx)(o.Card.Dark,{p:2,border:0,children:(0,M.jsx)(x.Translation,{textStyle:"captionSmaller",translation:"trade.actions.withdraw.messages.gasEstimateError",params:{supportLink:'<a href="https://discord.com/channels/606071749657755668/606073687799627776">Discord channel</a>',error:K},isHtml:!0,textAlign:"center"})}):Dt.gt(0)&&null!==zt&&void 0!==zt&&zt.withdraw?(0,M.jsx)(o.Card.Dark,{p:2,border:0,children:(0,M.jsx)(x.Translation,{textStyle:"captionSmaller",translation:zt.withdraw,isHtml:!0,textAlign:"center"})}):(0,u.gA)(null===At||void 0===At?void 0:At.balance).gt(0)&&(0,M.jsx)(o.Card.Dark,{py:2,pl:3,pr:2,border:0,children:(0,M.jsxs)(I.Ug,{spacing:3,width:"full",children:[(0,M.jsx)(x.Translation,{textStyle:"captionSmaller",translation:"trade.actions.withdraw.messages.unstakeFromGauge",textAlign:"left"}),(0,M.jsx)(x.Translation,{component:C.zx,translation:"common.unstake",fontSize:"xs",height:"auto",width:"auto",py:3,px:7,onClick:function(){return bt("?tab=gauge")}})]})}),It&&Y?Ft:(0,M.jsx)(b.DynamicActionFields,{assetId:null===rt||void 0===rt?void 0:rt.id,action:"withdraw",amount:P,amountUsd:L})]}),(0,M.jsxs)(I.gC,{spacing:4,id:"footer",alignItems:"flex-start",children:[Gt,(0,M.jsx)(w.EstimatedGasFees,{}),Et]})]})})}}}]);