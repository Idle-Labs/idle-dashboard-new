"use strict";(self.webpackChunkidle_dashboard_new=self.webpackChunkidle_dashboard_new||[]).push([[8365,6624],{66624:function(e,t,n){n.r(t),n.d(t,{DynamicActionFields:function(){return x}});var i=n(1413),r=n(45987),a=n(5128),s=n(7276),l=n(12056),o=n(86059),u=n(60062),d=n(99594),c=n(15542),m=n(1669),v=n(3498),p=n(45263),f=["assetId","field","amount","amountUsd","stakingPower"],g=function(e){var t,n,l,c,g,x=e.assetId,h=e.field,y=e.amount,S=e.amountUsd,w=e.stakingPower,A=(0,r.Z)(e,f),j=(0,m.w)(),b=j.stakingData,k=j.helpers.vaultFunctionsHelper,Z=j.selectors,C=Z.selectAssetById,I=Z.selectVaultById,B=Z.selectVaultGauge,M=(0,s.useMemo)((function(){return x&&C&&C(x)}),[x,C]),T=(0,s.useMemo)((function(){return x&&I&&I(x)}),[x,I]),E=(0,s.useMemo)((function(){return x&&B&&B(x)}),[x,B]),P=(0,s.useMemo)((function(){return E&&C&&C(E.id)}),[E,C]),F=(0,s.useMemo)((function(){return(0,d.gA)(M.tvl).plus((0,d.d5)(y))}),[M,y]),D=(0,s.useMemo)((function(){return null===k||void 0===k?void 0:k.getVaultNewApr(M,T,(0,d.gA)(y))}),[M,T,y,k]),U=(0,s.useMemo)((function(){if((0,d.d5)(D).gt(0)){var e=(0,d.Bs)((0,d.d5)(D).div(100)).times(100),t=M.apyBreakdown?Object.keys(M.apyBreakdown||{}).filter((function(e){return"base"!==e})).reduce((function(e,t){switch(t){case"gauge":var n=null===P||void 0===P?void 0:P.gaugeData;if(n){var i=(0,d.d5)(null===n||void 0===n?void 0:n.totalSupply).plus((0,d.d5)(y)),r=(0,d.d5)(null===n||void 0===n?void 0:n.totalSupply).div(i),a=M.apyBreakdown[t].times(r);return e.plus(a)}return e.plus(M.apyBreakdown[t]);case"harvest":var s=(0,d.gA)(M.tvl).div(F),l=M.apyBreakdown[t].times(s);return e.plus(l);default:return e.plus(M.apyBreakdown[t])}}),(0,d.gA)(0)):(0,d.gA)(0);return(0,d.gA)(e).plus(t)}return(0,d.d5)(null===M||void 0===M?void 0:M.apy)}),[M,y,F,P,D]),L=(0,d.d5)(S).gt(0),_=(0,d.d5)(null===M||void 0===M||null===(t=M.vaultPosition)||void 0===t?void 0:t.underlying.redeemable),G=(0,d.d5)(null===M||void 0===M||null===(n=M.vaultPosition)||void 0===n?void 0:n.usd.redeemable),V=a.Z.maximum(0,(0,d.d5)(null===M||void 0===M||null===(l=M.vaultPosition)||void 0===l?void 0:l.usd.earnings)),z=a.Z.minimum(1,(0,d.d5)(S).div(G)),N=a.Z.minimum(V,z.times(V)),O=a.Z.maximum(0,(0,d.d5)(null===M||void 0===M||null===(c=M.vaultPosition)||void 0===c?void 0:c.usd.earnings).times(null===M||void 0===M?void 0:M.fee)),W=a.Z.minimum(O,(0,d.d5)(N).times(null===M||void 0===M?void 0:M.fee));T instanceof u.C&&(V=V.plus(W),N=N.plus(W));var H=L&&(0,d.d5)(y).lte(_);switch(h){case"boost":var X=U&&null!==M&&void 0!==M&&null!==(g=M.baseApr)&&void 0!==g&&g.gt(0)?U.div(null===M||void 0===M?void 0:M.baseApr):(0,d.gA)(0);return(0,p.jsxs)(v.xv,(0,i.Z)((0,i.Z)({},A),{},{textStyle:"titleSmall",color:"primary",children:[X.toFixed(2),"x"]}));case"overperformance":var K=(0,d.d5)(S).times((0,d.gA)(null===M||void 0===M?void 0:M.baseApr).div(100)),R=(0,d.d5)(S).times((0,d.gA)(null===M||void 0===M?void 0:M.apy).div(100)),Y=L?R.minus(K):null;return(0,p.jsx)(o.Amount.Usd,(0,i.Z)((0,i.Z)({textStyle:"titleSmall",color:"primary"},A),{},{value:Y,suffix:"/year"}));case"newApy":return(0,p.jsx)(o.Amount.Percentage,(0,i.Z)((0,i.Z)({textStyle:"titleSmall",color:"primary"},A),{},{value:U}));case"totalGain":return(0,p.jsx)(o.Amount.Usd,(0,i.Z)((0,i.Z)({textStyle:"titleSmall",color:"primary"},A),{},{value:H?N:null}));case"fee":return(0,p.jsx)(o.Amount.Usd,(0,i.Z)((0,i.Z)({textStyle:"titleSmall",color:"primary"},A),{},{value:H?W:null}));case"netGain":var $=a.Z.minimum(V.minus(W),(0,d.d5)(N).minus(W));return(0,p.jsx)(o.Amount.Usd,(0,i.Z)((0,i.Z)({textStyle:"titleSmall",color:"primary"},A),{},{value:H?$:null}));case"coverage":var q=C(null===T||void 0===T?void 0:T.vaultConfig.Tranches.BB.address),J=q.tvl&&F?q.tvl.div(F).times(100):0;return(0,p.jsx)(o.Amount.Percentage,(0,i.Z)((0,i.Z)({textStyle:"titleSmall",color:"primary"},A),{},{value:J}));case"stakingPoolShare":if(!b)return null;var Q=(0,d.d5)(y).div(b.stkIDLE.totalSupply.plus((0,d.d5)(y))).times(100);return(0,p.jsx)(o.Amount.Percentage,(0,i.Z)((0,i.Z)({textStyle:"titleSmall",color:"primary"},A),{},{value:Q}));case"stkIDLE":case"stkIDLEAfterIncrease":return(0,p.jsx)(o.Amount,(0,i.Z)((0,i.Z)({textStyle:"titleSmall",color:"primary",suffix:" stkIDLE"},A),{},{value:y}));case"stakingApy":if(!b)return null;var ee=(0,d.d5)(w).times(b.maxApr);return(0,p.jsx)(o.Amount.Percentage,(0,i.Z)((0,i.Z)({textStyle:"titleSmall",color:"primary"},A),{},{value:ee}));default:return null}},x=function(e){var t,n=(0,m.w)().selectors.selectVaultById,r=e.assetId,a=e.action,o=(0,s.useMemo)((function(){return r&&n&&n(r)}),[r,n]),u=(0,s.useMemo)((function(){return(null===o||void 0===o?void 0:o.type)&&l.A[o.type]}),[o]);if(null===u||void 0===u||null===(t=u.dynamicActionFields)||void 0===t||!t[a])return null;var d=null===u||void 0===u?void 0:u.dynamicActionFields[a];return(0,p.jsx)(v.gC,{spacing:2,width:"100%",children:d.map((function(t){return(0,p.jsxs)(v.Ug,{pb:2,px:4,width:"100%",alignItems:"center",borderBottom:"1px solid",borderBottomColor:"divider",justifyContent:"space-between",children:[(0,p.jsx)(c.Translation,{component:v.xv,translation:"dynamicActionFields.".concat(t),textStyle:"captionSmall"}),(0,p.jsx)(g,(0,i.Z)((0,i.Z)({},e),{},{field:t}))]},"dynamicField_".concat(t))}))})}},98365:function(e,t,n){n.r(t),n.d(t,{Withdraw:function(){return B}});var i=n(74165),r=n(15861),a=n(29439),s=n(5128),l=n(54447),o=n(86059),u=n(93429),d=n(88935),c=n(99594),m=n(61617),v=n(15542),p=n(1128),f=n(85267),g=n(1669),x=n(7276),h=n(23023),y=n(4710),S=n(78951),w=n(43127),A=n(3498),j=n(2092),b=n(73131),k=n(66624),Z=n(86393),C=n(75712),I=n(45263),B=function(e){var t=e.itemIndex,n=(0,x.useState)("0"),B=(0,a.Z)(n,2),M=B[0],T=B[1],E=(0,x.useState)(""),P=(0,a.Z)(E,2),F=P[0],D=P[1],U=(0,x.useState)(0),L=(0,a.Z)(U,2),_=L[0],G=L[1],V=(0,x.useState)(!1),z=(0,a.Z)(V,2),N=z[0],O=z[1],W=(0,x.useState)(null),H=(0,a.Z)(W,2),X=H[0],K=H[1],R=(0,x.useState)(!1),Y=(0,a.Z)(R,2),$=Y[0],q=Y[1],J=(0,d.Y)().account,Q=(0,f.m)().searchParams,ee=(0,y.useOperativeComponent)(),te=ee.dispatch,ne=ee.activeItem,ie=ee.activeStep,re=(0,C.useAssetProvider)(),ae=re.asset,se=re.vault,le=re.underlyingAsset,oe=re.translate,ue=(0,h.R)(),de=ue.sendTransaction,ce=ue.setGasLimit,me=ue.state.transaction,ve=(0,g.w)().selectors,pe=ve.selectAssetPriceUsd,fe=ve.selectVaultPrice,ge=ve.selectAssetBalance,xe=ve.selectVaultGauge,he=ve.selectAssetById,ye=(0,x.useMemo)((function(){return Q}),[Q]),Se=(0,a.Z)(ye,2)[1],we=(0,x.useCallback)((function(){return q((function(e){return!e}))}),[q]),Ae=(0,x.useMemo)((function(){return ge?ge(null===se||void 0===se?void 0:se.id):(0,c.gA)(0)}),[ge,null===se||void 0===se?void 0:se.id]),je=(0,x.useMemo)((function(){return(null===ae||void 0===ae?void 0:ae.id)&&xe&&xe(ae.id)}),[xe,null===ae||void 0===ae?void 0:ae.id]),be=(0,x.useMemo)((function(){return je&&he&&he(je.id)}),[he,je]),ke=(0,x.useMemo)((function(){var e,t;return se&&"getWithdrawInterestBearingContractSendMethod"in se&&"paused"===(null===ae||void 0===ae?void 0:ae.status)&&(!("flags"in se)||void 0===(null===se||void 0===se||null===(e=se.flags)||void 0===e?void 0:e.redeemInterestBearingEnabled)||!(null===se||void 0===se||null===(t=se.flags)||void 0===t||!t.redeemInterestBearingEnabled))}),[se,ae]),Ze=(0,x.useMemo)((function(){return ke&&$?"getWithdrawInterestBearing":"getWithdraw"}),[ke,$]),Ce=(0,x.useMemo)((function(){return"".concat(Ze,"Params")}),[Ze]),Ie=(0,x.useMemo)((function(){return"".concat(Ze,"ContractSendMethod")}),[Ze]),Be=(0,x.useMemo)((function(){if(!ge)return(0,c.gA)(0);var e=ge(null===se||void 0===se?void 0:se.id),t=fe(null===se||void 0===se?void 0:se.id);return e.times(t)}),[ge,fe,null===se||void 0===se?void 0:se.id]),Me=(0,x.useCallback)((function(){Be&&T(Be.toString())}),[Be]);(0,x.useEffect)((function(){ke&&$?(Me(),O(!0)):O(!1)}),[Me,O,ke,$]);var Te=(0,x.useMemo)((function(){return D(""),!(!(0,c.gA)(M).isNaN()&&!(0,c.gA)(M).lte(0))||!!(0,c.gA)(M).gt(Be)&&(D(oe("trade.errors.insufficientFundsForAmount",{symbol:null===le||void 0===le?void 0:le.name})),!0)}),[M,Be,le,oe]),Ee=(0,x.useCallback)((function(){J&&!Te&&se&&Ie in se&&Ce in se&&(0,r.Z)((0,i.Z)().mark((function e(){var t,n,r,a;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=fe(se.id),n=s.Z.minimum(Ae,(0,c.gA)(M).div(t)),r=se[Ce](n),a=se[Ie](r),de(se.id,se.id,a);case 5:case"end":return e.stop()}}),e)})))()}),[J,Te,M,se,Ae,fe,de,Ce,Ie]);(0,x.useEffect)((function(){ie===t&&"success"===me.status&&T("")}),[me.status,ie,t]),(0,x.useEffect)((function(){if(pe&&fe&&le&&se){var e=pe(le.id),t=parseFloat((0,c.gA)(M).times(e).toString())||0;G(t)}}),[le,se,M,fe,pe,te]);var Pe=(0,x.useCallback)((0,r.Z)((0,i.Z)().mark((function e(){var t,n,r,a,s;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(se&&Ie in se&&Ce in se){e.next=2;break}return e.abrupt("return");case 2:if(t="getMethodDefaultGasLimit"in se?se.getMethodDefaultGasLimit("withdraw"):0,J&&!Ae.lte(0)){e.next=5;break}return e.abrupt("return",t);case 5:return n={from:null===J||void 0===J?void 0:J.address},r=se[Ce](Ae.toFixed()),a=se[Ie](r),e.next=10,(0,c.$K)(a,n);case 10:if(e.t0=e.sent,e.t0){e.next=13;break}e.t0=t;case 13:return s=e.t0,e.abrupt("return",s);case 15:case"end":return e.stop()}}),e)}))),[J,Ae,se,Ce,Ie]);(0,x.useEffect)((function(){K(null),ne===t&&(0,r.Z)((0,i.Z)().mark((function e(){var t;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Pe();case 3:t=e.sent,ce(t),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),K(e.t0.message.toString().split("\n")[0]);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()}),[ne,t,Pe,ce,K]),(0,x.useEffect)((function(){ne===t&&(te({type:"SET_ASSET",payload:ae}),fe&&se&&(te({type:"SET_AMOUNT",payload:(0,c.gA)(M).toString()}),te({type:"SET_DEFAULT_AMOUNT",payload:(0,c.gA)(M).toString()})))}),[se,ae,M,fe,ne,t,te,Ee]);var Fe=(0,x.useMemo)((function(){return J?(0,I.jsx)(v.Translation,{component:w.zx,translation:$?"common.withdrawInterestBearing":"common.withdraw",disabled:Te,onClick:Ee,variant:"ctaFull"}):(0,I.jsx)(Z.ConnectWalletButton,{variant:"ctaFull"})}),[J,Te,Ee,$]),De=(0,x.useMemo)((function(){return se&&"messages"in se?se.messages:void 0}),[se]),Ue=(0,x.useMemo)((function(){return!ke||Ae.lte(0)?null:(0,I.jsx)(l.Card.Dark,{px:2,py:3,border:0,children:(0,I.jsxs)(A.gC,{spacing:2,width:"full",justifyContent:"center",children:[(0,I.jsx)(j.Ee,{src:"images/vaults/deprecated.png",width:6,height:6}),(0,I.jsx)(v.Translation,{textAlign:"center",textStyle:"captionSmaller",translation:"trade.actions.redeemInterestBearing.description"}),(0,I.jsx)(v.Translation,{component:b.XZ,size:"md",sx:{">span":{fontSize:"sm"}},translation:"trade.actions.redeemInterestBearing.label",isChecked:$,onChange:function(){return we()}})]})})}),[Ae,$,we,ke]),Le=(0,x.useMemo)((function(){return null!==ae&&void 0!==ae&&ae.interestBearingTokens&&null!==ae&&void 0!==ae&&ae.vaultPosition&&se&&se instanceof u.H?(0,I.jsxs)(A.gC,{spacing:2,width:"100%",alignItems:"flex-start",children:[(0,I.jsx)(v.Translation,{mb:1,component:A.xv,translation:"dynamicActionFields.stkIDLE",suffix:":",textStyle:"titleSmall"}),Object.keys(null===ae||void 0===ae?void 0:ae.interestBearingTokens).map((function(e){var t,n,i=he(e)||se.tokenConfig.protocols.find((function(t){return t.address===e})),r=(0,c.d5)(null===ae||void 0===ae||null===(t=ae.interestBearingTokens)||void 0===t?void 0:t[e]).times((0,c.d5)(null===ae||void 0===ae||null===(n=ae.vaultPosition)||void 0===n?void 0:n.poolShare));return(0,I.jsxs)(A.Ug,{pb:2,px:4,width:"100%",alignItems:"center",borderBottom:"1px solid",borderBottomColor:"divider",justifyContent:"space-between",children:[(0,I.jsx)(A.xv,{textStyle:"captionSmall",children:null===i||void 0===i?void 0:i.token}),(0,I.jsx)(o.Amount,{value:r,textStyle:"titleSmall",color:"primary"})]},"assetField_".concat(e))}))]}):null}),[ae,se,he]);return(0,I.jsx)(C.AssetProvider,{flex:1,width:"100%",assetId:null===ae||void 0===ae?void 0:ae.id,children:(0,I.jsxs)(A.gC,{pt:8,flex:1,spacing:6,width:"100%",height:"100%",id:"withdraw-container",alignItems:"space-between",justifyContent:"flex-start",children:[(0,I.jsxs)(A.gC,{flex:1,spacing:6,width:"100%",alignItems:"flex-start",children:[(0,I.jsxs)(A.Ug,{width:"100%",spacing:[3,4],alignItems:"flex-start",children:[(0,I.jsx)(A.xu,{pt:8,children:(0,I.jsx)(m.AssetLabel,{assetId:null===ae||void 0===ae?void 0:ae.id})}),(0,I.jsxs)(A.gC,{spacing:1,width:"100%",alignItems:"flex-start",children:[(0,I.jsx)(l.Card,{px:4,py:2,layerStyle:"cardLight",children:(0,I.jsxs)(A.gC,{spacing:2,alignItems:"flex-start",children:[(0,I.jsx)(p.InputAmount,{amount:M,amountUsd:_,setAmount:T,isDisabled:N}),(0,I.jsxs)(A.Ug,{width:"100%",justifyContent:"space-between",children:[(0,I.jsxs)(A.Ug,{spacing:1,children:[(0,I.jsx)(v.Translation,{component:A.xv,translation:"common.balance",textStyle:"captionSmaller"}),(0,I.jsx)(C.AssetProvider.VaultBalance,{abbreviate:!0,decimals:4,textStyle:"captionSmaller",color:"primary"})]}),(0,I.jsx)(w.zx,{variant:"selector",onClick:Me,children:"MAX"})]})]})}),F&&(0,I.jsx)(A.xv,{textStyle:"captionSmaller",color:"orange",children:F})]})]}),X?(0,I.jsx)(l.Card.Dark,{p:2,border:0,children:(0,I.jsx)(v.Translation,{textStyle:"captionSmaller",translation:"trade.actions.withdraw.messages.gasEstimateError",params:{supportLink:'<a href="https://discord.com/channels/606071749657755668/606073687799627776">Discord channel</a>',error:X},isHtml:!0,textAlign:"center"})}):Be.gt(0)&&null!==De&&void 0!==De&&De.withdraw?(0,I.jsx)(l.Card.Dark,{p:2,border:0,children:(0,I.jsx)(v.Translation,{textStyle:"captionSmaller",translation:De.withdraw,textAlign:"center"})}):(0,c.gA)(null===be||void 0===be?void 0:be.balance).gt(0)&&(0,I.jsx)(l.Card.Dark,{py:2,pl:3,pr:2,border:0,children:(0,I.jsxs)(A.Ug,{spacing:3,width:"full",children:[(0,I.jsx)(v.Translation,{textStyle:"captionSmaller",translation:"trade.actions.withdraw.messages.unstakeFromGauge",textAlign:"left"}),(0,I.jsx)(v.Translation,{component:w.zx,translation:"common.unstake",fontSize:"xs",height:"auto",width:"auto",py:3,px:7,onClick:function(){return Se("?tab=gauge")}})]})}),ke&&$?Le:(0,I.jsx)(k.DynamicActionFields,{assetId:null===ae||void 0===ae?void 0:ae.id,action:"withdraw",amount:M,amountUsd:_})]}),(0,I.jsxs)(A.gC,{spacing:4,id:"footer",alignItems:"flex-start",children:[Ue,(0,I.jsx)(S.EstimatedGasFees,{}),Fe]})]})})}}}]);