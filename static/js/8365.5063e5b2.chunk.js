"use strict";(self.webpackChunkidle_dashboard_new=self.webpackChunkidle_dashboard_new||[]).push([[8365,6624],{66624:function(e,t,n){n.r(t),n.d(t,{DynamicActionFields:function(){return g}});var i=n(1413),a=n(45987),r=n(5128),s=n(7276),l=n(12056),o=n(86059),u=n(99594),d=n(15542),c=n(1669),m=n(3498),v=n(45263),p=["assetId","field","amount","amountUsd","stakingPower"],f=function(e){var t,n,l,d,f,g=e.assetId,x=e.field,h=e.amount,y=e.amountUsd,A=e.stakingPower,w=(0,a.Z)(e,p),S=(0,c.w)(),j=S.stakingData,Z=S.helpers.vaultFunctionsHelper,b=S.selectors,k=b.selectAssetById,C=b.selectVaultById,I=b.selectVaultGauge,M=(0,s.useMemo)((function(){return g&&k&&k(g)}),[g,k]),B=(0,s.useMemo)((function(){return g&&C&&C(g)}),[g,C]),E=(0,s.useMemo)((function(){return g&&I&&I(g)}),[g,I]),P=(0,s.useMemo)((function(){return E&&k&&k(E.id)}),[E,k]),T=(0,s.useMemo)((function(){return(0,u.gA)(M.tvl).plus((0,u.d5)(h))}),[M,h]),D=(0,s.useMemo)((function(){return null===Z||void 0===Z?void 0:Z.getVaultNewApr(M,B,(0,u.gA)(h))}),[M,B,h,Z]),F=(0,s.useMemo)((function(){if((0,u.d5)(D).gt(0)){var e=(0,u.Bs)((0,u.d5)(D).div(100)).times(100),t=M.apyBreakdown?Object.keys(M.apyBreakdown||{}).filter((function(e){return"base"!==e})).reduce((function(e,t){switch(t){case"gauge":var n=null===P||void 0===P?void 0:P.gaugeData;if(n){var i=(0,u.d5)(null===n||void 0===n?void 0:n.totalSupply).plus((0,u.d5)(h)),a=(0,u.d5)(null===n||void 0===n?void 0:n.totalSupply).div(i),r=M.apyBreakdown[t].times(a);return e.plus(r)}return e.plus(M.apyBreakdown[t]);case"harvest":var s=(0,u.gA)(M.tvl).div(T),l=M.apyBreakdown[t].times(s);return e.plus(l);default:return e.plus(M.apyBreakdown[t])}}),(0,u.gA)(0)):(0,u.gA)(0);return(0,u.gA)(e).plus(t)}return(0,u.d5)(null===M||void 0===M?void 0:M.apy)}),[M,h,T,P,D]),U=(0,u.d5)(y).gt(0),L=(0,u.d5)(null===M||void 0===M||null===(t=M.vaultPosition)||void 0===t?void 0:t.underlying.redeemable),_=(0,u.d5)(null===M||void 0===M||null===(n=M.vaultPosition)||void 0===n?void 0:n.usd.redeemable),G=r.Z.maximum(0,(0,u.d5)(null===M||void 0===M||null===(l=M.vaultPosition)||void 0===l?void 0:l.usd.earnings)),V=r.Z.minimum(1,(0,u.d5)(y).div(_)),z=r.Z.minimum(G,V.times(G)),N=r.Z.maximum(0,(0,u.d5)(null===M||void 0===M||null===(d=M.vaultPosition)||void 0===d?void 0:d.usd.earnings).times(null===M||void 0===M?void 0:M.fee)),W=r.Z.minimum(N,(0,u.d5)(z).times(null===M||void 0===M?void 0:M.fee)),O=U&&(0,u.d5)(h).lte(L);switch(x){case"boost":var H=F&&null!==M&&void 0!==M&&null!==(f=M.baseApr)&&void 0!==f&&f.gt(0)?F.div(null===M||void 0===M?void 0:M.baseApr):(0,u.gA)(0);return(0,v.jsxs)(m.xv,(0,i.Z)((0,i.Z)({},w),{},{textStyle:"titleSmall",color:"primary",children:[H.toFixed(2),"x"]}));case"overperformance":var X=(0,u.d5)(y).times((0,u.gA)(null===M||void 0===M?void 0:M.baseApr).div(100)),K=(0,u.d5)(y).times((0,u.gA)(null===M||void 0===M?void 0:M.apy).div(100)),R=U?K.minus(X):null;return(0,v.jsx)(o.Amount.Usd,(0,i.Z)((0,i.Z)({textStyle:"titleSmall",color:"primary"},w),{},{value:R,suffix:"/year"}));case"newApy":return(0,v.jsx)(o.Amount.Percentage,(0,i.Z)((0,i.Z)({textStyle:"titleSmall",color:"primary"},w),{},{value:F}));case"gain":return(0,v.jsx)(o.Amount.Usd,(0,i.Z)((0,i.Z)({textStyle:"titleSmall",color:"primary"},w),{},{value:O?z:null}));case"fee":return(0,v.jsx)(o.Amount.Usd,(0,i.Z)((0,i.Z)({textStyle:"titleSmall",color:"primary"},w),{},{value:O?W:null}));case"netGain":var Y=r.Z.minimum(G.minus(W),(0,u.d5)(z).minus(W));return(0,v.jsx)(o.Amount.Usd,(0,i.Z)((0,i.Z)({textStyle:"titleSmall",color:"primary"},w),{},{value:O?Y:null}));case"coverage":var $=k(null===B||void 0===B?void 0:B.vaultConfig.Tranches.BB.address),q=$.tvl&&T?$.tvl.div(T).times(100):0;return(0,v.jsx)(o.Amount.Percentage,(0,i.Z)((0,i.Z)({textStyle:"titleSmall",color:"primary"},w),{},{value:q}));case"stakingPoolShare":if(!j)return null;var J=(0,u.d5)(h).div(j.stkIDLE.totalSupply.plus((0,u.d5)(h))).times(100);return(0,v.jsx)(o.Amount.Percentage,(0,i.Z)((0,i.Z)({textStyle:"titleSmall",color:"primary"},w),{},{value:J}));case"stkIDLE":case"stkIDLEAfterIncrease":return(0,v.jsx)(o.Amount,(0,i.Z)((0,i.Z)({textStyle:"titleSmall",color:"primary",suffix:" stkIDLE"},w),{},{value:h}));case"stakingApy":if(!j)return null;var Q=(0,u.d5)(A).times(j.maxApr);return(0,v.jsx)(o.Amount.Percentage,(0,i.Z)((0,i.Z)({textStyle:"titleSmall",color:"primary"},w),{},{value:Q}));default:return null}},g=function(e){var t,n=(0,c.w)().selectors.selectVaultById,a=e.assetId,r=e.action,o=(0,s.useMemo)((function(){return a&&n&&n(a)}),[a,n]),u=(0,s.useMemo)((function(){return(null===o||void 0===o?void 0:o.type)&&l.A[o.type]}),[o]);if(null===u||void 0===u||null===(t=u.dynamicActionFields)||void 0===t||!t[r])return null;var p=null===u||void 0===u?void 0:u.dynamicActionFields[r];return(0,v.jsx)(m.gC,{spacing:2,width:"100%",children:p.map((function(t){return(0,v.jsxs)(m.Ug,{pb:2,px:4,width:"100%",alignItems:"center",borderBottom:"1px solid",borderBottomColor:"divider",justifyContent:"space-between",children:[(0,v.jsx)(d.Translation,{component:m.xv,translation:"dynamicActionFields.".concat(t),textStyle:"captionSmall"}),(0,v.jsx)(f,(0,i.Z)((0,i.Z)({},e),{},{field:t}))]},"dynamicField_".concat(t))}))})}},98365:function(e,t,n){n.r(t),n.d(t,{Withdraw:function(){return C}});var i=n(74165),a=n(15861),r=n(29439),s=n(5128),l=n(54447),o=n(99594),u=n(88935),d=n(61617),c=n(15542),m=n(1128),v=n(85267),p=n(1669),f=n(7276),g=n(23023),x=n(4710),h=n(78951),y=n(43127),A=n(3498),w=n(2092),S=n(73131),j=n(66624),Z=n(86393),b=n(75712),k=n(45263),C=function(e){var t=e.itemIndex,n=(0,f.useState)("0"),C=(0,r.Z)(n,2),I=C[0],M=C[1],B=(0,f.useState)(""),E=(0,r.Z)(B,2),P=E[0],T=E[1],D=(0,f.useState)(0),F=(0,r.Z)(D,2),U=F[0],L=F[1],_=(0,f.useState)(!1),G=(0,r.Z)(_,2),V=G[0],z=G[1],N=(0,f.useState)(null),W=(0,r.Z)(N,2),O=W[0],H=W[1],X=(0,f.useState)(!1),K=(0,r.Z)(X,2),R=K[0],Y=K[1],$=(0,u.Y)().account,q=(0,v.m)().searchParams,J=(0,x.useOperativeComponent)(),Q=J.dispatch,ee=J.activeItem,te=J.activeStep,ne=(0,b.useAssetProvider)(),ie=ne.asset,ae=ne.vault,re=ne.underlyingAsset,se=ne.translate,le=(0,g.R)(),oe=le.sendTransaction,ue=le.setGasLimit,de=le.state.transaction,ce=(0,p.w)().selectors,me=ce.selectAssetPriceUsd,ve=ce.selectVaultPrice,pe=ce.selectAssetBalance,fe=ce.selectVaultGauge,ge=ce.selectAssetById,xe=(0,f.useMemo)((function(){return q}),[q]),he=(0,r.Z)(xe,2)[1],ye=(0,f.useCallback)((function(){return Y((function(e){return!e}))}),[Y]),Ae=(0,f.useMemo)((function(){return pe?pe(null===ae||void 0===ae?void 0:ae.id):(0,o.gA)(0)}),[pe,null===ae||void 0===ae?void 0:ae.id]),we=(0,f.useMemo)((function(){return(null===ie||void 0===ie?void 0:ie.id)&&fe&&fe(ie.id)}),[fe,null===ie||void 0===ie?void 0:ie.id]),Se=(0,f.useMemo)((function(){return we&&ge&&ge(we.id)}),[ge,we]),je=(0,f.useMemo)((function(){var e,t;return ae&&"getWithdrawInterestBearingContractSendMethod"in ae&&"paused"===(null===ie||void 0===ie?void 0:ie.status)&&(!("flags"in ae)||void 0===(null===ae||void 0===ae||null===(e=ae.flags)||void 0===e?void 0:e.redeemInterestBearingEnabled)||!(null===ae||void 0===ae||null===(t=ae.flags)||void 0===t||!t.redeemInterestBearingEnabled))}),[ae,ie]),Ze=(0,f.useMemo)((function(){return je&&R?"getWithdrawInterestBearing":"getWithdraw"}),[je,R]),be=(0,f.useMemo)((function(){return"".concat(Ze,"Params")}),[Ze]),ke=(0,f.useMemo)((function(){return"".concat(Ze,"ContractSendMethod")}),[Ze]),Ce=(0,f.useMemo)((function(){if(!pe)return(0,o.gA)(0);var e=pe(null===ae||void 0===ae?void 0:ae.id),t=ve(null===ae||void 0===ae?void 0:ae.id);return e.times(t)}),[pe,ve,null===ae||void 0===ae?void 0:ae.id]),Ie=(0,f.useCallback)((function(){Ce&&M(Ce.toString())}),[Ce]);(0,f.useEffect)((function(){je&&R?(Ie(),z(!0)):z(!1)}),[Ie,z,je,R]);var Me=(0,f.useMemo)((function(){return T(""),!(!(0,o.gA)(I).isNaN()&&!(0,o.gA)(I).lte(0))||!!(0,o.gA)(I).gt(Ce)&&(T(se("trade.errors.insufficientFundsForAmount",{symbol:null===re||void 0===re?void 0:re.name})),!0)}),[I,Ce,re,se]),Be=(0,f.useCallback)((function(){$&&!Me&&ae&&ke in ae&&be in ae&&(0,a.Z)((0,i.Z)().mark((function e(){var t,n,a,r;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=ve(ae.id),n=s.Z.minimum(Ae,(0,o.gA)(I).div(t)),a=ae[be](n),r=ae[ke](a),oe(ae.id,ae.id,r);case 5:case"end":return e.stop()}}),e)})))()}),[$,Me,I,ae,Ae,ve,oe,be,ke]);(0,f.useEffect)((function(){te===t&&"success"===de.status&&M("")}),[de.status,te,t]),(0,f.useEffect)((function(){if(me&&ve&&re&&ae){var e=me(re.id),t=parseFloat((0,o.gA)(I).times(e).toString())||0;L(t)}}),[re,ae,I,ve,me,Q]);var Ee=(0,f.useCallback)((0,a.Z)((0,i.Z)().mark((function e(){var t,n,a,r,s;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(ae&&ke in ae&&be in ae){e.next=2;break}return e.abrupt("return");case 2:if(t="getMethodDefaultGasLimit"in ae?ae.getMethodDefaultGasLimit("withdraw"):0,$&&!Ae.lte(0)){e.next=5;break}return e.abrupt("return",t);case 5:return n={from:null===$||void 0===$?void 0:$.address},a=ae[be](Ae.toFixed()),r=ae[ke](a),e.next=10,(0,o.$K)(r,n);case 10:if(e.t0=e.sent,e.t0){e.next=13;break}e.t0=t;case 13:return s=e.t0,e.abrupt("return",s);case 15:case"end":return e.stop()}}),e)}))),[$,Ae,ae,be,ke]);(0,f.useEffect)((function(){H(null),ee===t&&(0,a.Z)((0,i.Z)().mark((function e(){var t;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ee();case 3:t=e.sent,ue(t),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),H(e.t0.message.toString().split("\n")[0]);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()}),[ee,t,Ee,ue,H]),(0,f.useEffect)((function(){ee===t&&(Q({type:"SET_ASSET",payload:ie}),ve&&ae&&(Q({type:"SET_AMOUNT",payload:(0,o.gA)(I).toString()}),Q({type:"SET_DEFAULT_AMOUNT",payload:(0,o.gA)(I).toString()})))}),[ae,ie,I,ve,ee,t,Q,Be]);var Pe=(0,f.useMemo)((function(){return $?(0,k.jsx)(c.Translation,{component:y.zx,translation:R?"common.withdrawInterestBearing":"common.withdraw",disabled:Me,onClick:Be,variant:"ctaFull"}):(0,k.jsx)(Z.ConnectWalletButton,{variant:"ctaFull"})}),[$,Me,Be,R]),Te=(0,f.useMemo)((function(){return ae&&"messages"in ae?ae.messages:void 0}),[ae]),De=(0,f.useMemo)((function(){return!je||Ae.lte(0)?null:(0,k.jsx)(l.Card.Dark,{px:2,py:3,border:0,children:(0,k.jsxs)(A.gC,{spacing:2,width:"full",justifyContent:"center",children:[(0,k.jsx)(w.Ee,{src:"images/vaults/deprecated.png",width:6,height:6}),(0,k.jsx)(c.Translation,{textAlign:"center",textStyle:"captionSmaller",translation:"trade.actions.redeemInterestBearing.description"}),(0,k.jsx)(c.Translation,{component:S.XZ,size:"md",sx:{">span":{fontSize:"sm"}},translation:"trade.actions.redeemInterestBearing.label",isChecked:R,onChange:function(){return ye()}})]})})}),[Ae,R,ye,je]);return(0,k.jsx)(b.AssetProvider,{flex:1,width:"100%",assetId:null===ie||void 0===ie?void 0:ie.id,children:(0,k.jsxs)(A.gC,{pt:8,flex:1,spacing:6,width:"100%",height:"100%",id:"withdraw-container",alignItems:"space-between",justifyContent:"flex-start",children:[(0,k.jsxs)(A.gC,{flex:1,spacing:6,width:"100%",alignItems:"flex-start",children:[(0,k.jsxs)(A.Ug,{width:"100%",spacing:[3,4],alignItems:"flex-start",children:[(0,k.jsx)(A.xu,{pt:8,children:(0,k.jsx)(d.AssetLabel,{assetId:null===ie||void 0===ie?void 0:ie.id})}),(0,k.jsxs)(A.gC,{spacing:1,width:"100%",alignItems:"flex-start",children:[(0,k.jsx)(l.Card,{px:4,py:2,layerStyle:"cardLight",children:(0,k.jsxs)(A.gC,{spacing:2,alignItems:"flex-start",children:[(0,k.jsx)(m.InputAmount,{amount:I,amountUsd:U,setAmount:M,isDisabled:V}),(0,k.jsxs)(A.Ug,{width:"100%",justifyContent:"space-between",children:[(0,k.jsxs)(A.Ug,{spacing:1,children:[(0,k.jsx)(c.Translation,{component:A.xv,translation:"common.balance",textStyle:"captionSmaller"}),(0,k.jsx)(b.AssetProvider.VaultBalance,{abbreviate:!0,decimals:4,textStyle:"captionSmaller",color:"primary"})]}),(0,k.jsx)(y.zx,{variant:"selector",onClick:Ie,children:"MAX"})]})]})}),P&&(0,k.jsx)(A.xv,{textStyle:"captionSmaller",color:"orange",children:P})]})]}),O?(0,k.jsx)(l.Card.Dark,{p:2,border:0,children:(0,k.jsx)(c.Translation,{textStyle:"captionSmaller",translation:"trade.actions.withdraw.messages.gasEstimateError",params:{supportLink:'<a href="https://discord.com/channels/606071749657755668/606073687799627776">Discord channel</a>',error:O},isHtml:!0,textAlign:"center"})}):Ce.gt(0)&&null!==Te&&void 0!==Te&&Te.withdraw?(0,k.jsx)(l.Card.Dark,{p:2,border:0,children:(0,k.jsx)(c.Translation,{textStyle:"captionSmaller",translation:Te.withdraw,textAlign:"center"})}):(0,o.gA)(null===Se||void 0===Se?void 0:Se.balance).gt(0)&&(0,k.jsx)(l.Card.Dark,{py:2,pl:3,pr:2,border:0,children:(0,k.jsxs)(A.Ug,{spacing:3,width:"full",children:[(0,k.jsx)(c.Translation,{textStyle:"captionSmaller",translation:"trade.actions.withdraw.messages.unstakeFromGauge",textAlign:"left"}),(0,k.jsx)(c.Translation,{component:y.zx,translation:"common.unstake",fontSize:"xs",height:"auto",width:"auto",py:3,px:7,onClick:function(){return he("?tab=gauge")}})]})}),(0,k.jsx)(j.DynamicActionFields,{assetId:null===ie||void 0===ie?void 0:ie.id,action:"withdraw",amount:I,amountUsd:U})]}),(0,k.jsxs)(A.gC,{spacing:4,id:"footer",alignItems:"flex-start",children:[De,(0,k.jsx)(h.EstimatedGasFees,{}),Pe]})]})})}}}]);