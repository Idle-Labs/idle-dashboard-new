"use strict";(self.webpackChunkidle_dashboard_new=self.webpackChunkidle_dashboard_new||[]).push([[1309],{63330:function(e,t,n){n.r(t),n.d(t,{AssetPage:function(){return M}});var s=n(1413),a=n(29439),i=n(76566),r=n(16120),o=n(95173),l=n(98428),c=n(66288),d=n(3717),u=n(86698),p=n(61617),x=n(29482),m=n(97901),f=n(96362),g=n(15542),v=n(98365),h=n(85267),j=n(1669),b=n(75712),y=n(7276),w=n(99594),S=n(61925),C=n(88089),A=n(3498),I=n(37658),k=n(58043),T=n(45263),M=function(){var e=(0,o.s0)(),t=(0,c.X)(),n=t.isMobile,M=t.environment,D=(0,h.m)(),P=D.params,Z=D.location,E=D.searchParams,U=(0,y.useState)(0),z=(0,a.Z)(U,2),B=z[0],_=z[1],F=(0,y.useState)(0),G=(0,a.Z)(F,2),L=G[0],O=G[1],R=(0,y.useState)(),N=(0,a.Z)(R,2),H=N[0],W=N[1],K=(0,y.useMemo)((function(){return E}),[E]),q=(0,a.Z)(K,2),V=q[0],X=q[1],Y=(0,y.useState)({startDate:null,endDate:null}),$=(0,a.Z)(Y,2),Q=$[0],J=$[1],ee=(0,y.useState)(k.WE["6MONTHS"]),te=(0,a.Z)(ee,2),ne=te[0],se=te[1],ae=(0,y.useMemo)((function(){return!!Q.startDate&&!!Q.endDate}),[Q]);(0,y.useEffect)((function(){ae&&se(void 0)}),[ae,se]),(0,y.useEffect)((function(){ne&&J({endDate:null,startDate:null})}),[ne,J]);var ie=(0,j.w)(),re=ie.isPortfolioLoaded,oe=ie.portfolioTimestamp,le=ie.assetsDataTimestamp,ce=ie.isPortfolioAccountReady,de=ie.selectors,ue=de.selectAssetById,pe=de.selectVaultById,xe=de.selectVaultGauge,me=de.selectAssetBalance,fe=de.selectAssetPriceUsd,ge=(0,y.useMemo)((function(){return ue&&ue(P.asset)}),[ue,P.asset]),ve=(0,y.useMemo)((function(){return pe&&pe(P.asset)}),[pe,P.asset]);(0,y.useEffect)((function(){ge&&O(Date.now())}),[ge]);var he=(0,y.useMemo)((function(){if(!ge||!me||null===ge||void 0===ge||!ge.underlyingId||!fe)return(0,w.gA)(0);var e=me(ge.underlyingId),t=fe(ge.underlyingId);return(0,w.d5)(e).times((0,w.d5)(t))}),[ge,me,fe]),je=(0,y.useMemo)((function(){return xe&&xe(P.asset)}),[xe,P.asset]),be=(0,y.useMemo)((function(){return je&&ue&&ue(je.id)}),[ue,je]),ye=(0,y.useMemo)((function(){var e;return be&&"gaugeData"in be&&null!==(e=be.gaugeData)&&void 0!==e&&e.rewards?Object.values(be.gaugeData.rewards).reduce((function(e,t){return e.plus((0,w.d5)(t.balance))}),(0,w.gA)(0)):(0,w.gA)(0)}),[be]);(0,y.useEffect)((function(){if(re&&ue&&Z&&L)return ge?void 0:e(Z.pathname.replace("/".concat(P.asset),""))}),[re,ue,L,ge,P.asset,Z,e]),(0,y.useEffect)((function(){!(ce&&ge&&H!==(null===ge||void 0===ge?void 0:ge.id)&&oe&&le)||oe>le||le>L||((0,w.AV)(ge,he),W(ge.id))}),[ge,oe,he,le,ce,L,H,W]);var we=(0,y.useMemo)((function(){var e=[{id:"earn",label:"navBar.earn",component:i.Earn,actions:[{type:"deposit",component:m.Deposit,label:"common.deposit",steps:[{type:"approve",component:f.Approve,label:"modals.approve.header"}]},{type:"withdraw",label:"common.withdraw",component:v.Withdraw,steps:[]}]}],t=je&&"enabled"in je&&!je.enabled;je&&(!t||(0,w.d5)(null===be||void 0===be?void 0:be.balance).gt(0)||(0,w.d5)(ye).gt(0))&&e.push({id:"gauge",label:"navBar.gauge",component:r.GaugeStaking,icon:t&&((0,w.gA)(null===be||void 0===be?void 0:be.balance).gt(0)||(0,w.d5)(ye).gt(0))?{src:"".concat(k.pm,"vaults/deprecated.png"),tooltip:"trade.vaults.GG.disabled",props:{width:5,height:5}}:null,actions:[{type:"stake",component:m.Deposit,label:"common.stake",steps:[{type:"approve",component:f.Approve,label:"modals.approve.header"}]},{type:"unstake",label:"common.unstake",component:v.Withdraw,steps:[]}]});var n=!(null!==ve&&void 0!==ve&&ve.flags)||void 0===ve.flags.statsEnabled||ve.flags.statsEnabled;return(0,w.xW)("stats",M)&&n&&e.push({id:"stats",label:"navBar.stats",component:u.AssetStats,componentProps:{timeframe:ne,dateRange:Q,assetOnly:!0,showHeader:!1,showAssetStrategy:!0}}),e}),[ve,je,be,ne,Q,M,ye]),Se=(0,y.useMemo)((function(){return V.get("tab")}),[V]);(0,y.useEffect)((function(){if(Se){var e=we.find((function(e){return e.id.toString()===Se.toString()}));if(e){var t=we.indexOf(e);_(t)}else _(0)}else _(0)}),[we,Se,_]);var Ce=(0,y.useMemo)((function(){return we[B]&&"gauge"===we[B].id&&je?je.id:null===ge||void 0===ge?void 0:ge.id}),[we,B,ge,je]),Ae=(0,y.useMemo)((function(){return we[B]}),[we,B]),Ie=(0,y.useMemo)((function(){return Ae.component}),[Ae]),ke=(0,y.useCallback)((function(e){var t=we[e];t&&X("?tab=".concat(t.id))}),[we,X]),Te=(0,y.useMemo)((function(){return(0,T.jsx)(C.mQ,{variant:"unstyled",index:B,width:["100%","auto"],children:(0,T.jsx)(C.td,{children:we.map((function(e,t){return(0,T.jsx)(l.IconTab,{width:["".concat(100/we.length,"%"),"auto"],icon:e.icon,onClick:function(){return ke(t)},children:(0,T.jsx)(g.Translation,{translation:e.label})},"tab_".concat(t))}))})})}),[we,ke,B]),Me=(0,y.useMemo)((function(){return Ae.actions?(0,T.jsx)(I.InteractiveComponent,{vaultId:null===ge||void 0===ge?void 0:ge.id,assetId:Ce,actions:Ae.actions}):null}),[Ae,ge,Ce]),De=(0,y.useMemo)((function(){return(0,T.jsxs)(A.Ug,{mb:[0,"3 !important"],spacing:4,pl:[0,"stats"===Ae.id?5:0],justifyContent:["center","flex-end"],borderLeft:n||"stats"!==Ae.id?"none":"1px solid",borderLeftColor:"divider",children:[(0,T.jsxs)(A.Ug,{spacing:1,children:[(0,T.jsx)(x.ProductTag,{type:null===ge||void 0===ge?void 0:ge.type,fontSize:"md",h:8}),(0,T.jsx)(b.AssetProvider.Strategies,{h:8,w:8})]}),(0,T.jsx)(A.Ug,{pl:4,borderLeft:"1px solid",borderLeftColor:"divider",children:(0,T.jsx)(b.AssetProvider.Protocols,{tooltipDisabled:!0,size:"sm",children:(0,T.jsx)(b.AssetProvider.ProtocolIcon,{size:"sm"})})})]})}),[Ae,ge,n]),Pe=(0,y.useMemo)((function(){return(0,T.jsxs)(A.Kq,{spacing:[0,5],direction:["column","row"],children:["stats"===Ae.id&&(0,T.jsxs)(A.Kq,{spacing:2,mt:[3,"-15px"],width:["full","auto"],direction:["column","row"],alignItems:["auto","center"],justifyContent:["flex-start","center"],children:[(0,T.jsx)(S.TimeframeSelector,{variant:"button",timeframe:ne,setTimeframe:se,width:["100%","auto"],justifyContent:["center","initial"]}),(0,T.jsx)(d.DatePicker,{selected:ae,setDateRange:J})]}),!n&&De]})}),[Ae,n,ne,se,ae,J,De]);return(0,T.jsx)(b.AssetProvider,{wrapFlex:!0,assetId:P.asset,children:(0,T.jsxs)(A.xu,{width:"100%",children:[(0,T.jsx)(A.kC,{my:[10,14],width:"100%",id:"asset-top-header",direction:["column","row"],justifyContent:["center","space-between"],children:(0,T.jsxs)(A.Kq,{width:"100%",spacing:[4,8],alignItems:"center",justifyContent:"center",direction:["column","row"],children:[(0,T.jsx)(p.AssetLabel,{assetId:P.asset,fontSize:"h2",extraFields:["statusBadge"]}),n&&De,(0,T.jsxs)(A.Kq,{flex:1,spacing:0,width:["100%","auto"],justifyContent:"space-between",borderBottom:[0,"1px solid"],direction:["column","row"],borderColor:["divider","divider"],children:[(0,T.jsx)(A.Ug,{width:["full","auto"],borderBottom:["1px solid",0],borderColor:"divider",children:Te}),Pe]})]})}),(0,T.jsxs)(A.Ug,{width:"100%",spacing:[0,10],alignItems:"space-between",children:[(0,T.jsx)(A.Kq,{flex:1,mb:[20,0],spacing:10,width:["100%",.7],children:(0,T.jsx)(Ie,(0,s.Z)({},we[B].componentProps))}),Me]})]})})}},16120:function(e,t,n){n.r(t),n.d(t,{GaugeStaking:function(){return h}});var s=n(29439),a=n(54447),i=n(58043),r=n(86059),o=n(7276),l=n(15542),c=n(1669),d=n(85267),u=n(99594),p=n(75712),x=n(3148),m=n(72258),f=n(3498),g=n(30422),v=n(45263),h=function(){var e,t,n,h,j,b=(0,d.m)().params,y=(0,o.useState)(0),w=(0,s.Z)(y,2),S=w[0],C=w[1],A=(0,o.useState)(),I=(0,s.Z)(A,2),k=I[0],T=I[1],M=(0,c.w)(),D=M.portfolioTimestamp,P=M.assetsDataTimestamp,Z=M.isPortfolioAccountReady,E=M.selectors,U=E.selectAssetById,z=E.selectVaultGauge,B=E.selectAssetBalance,_=E.selectAssetPriceUsd,F=(0,o.useMemo)((function(){return U&&U(b.asset)}),[U,b.asset]),G=(0,o.useMemo)((function(){return F&&z&&z(F.id)}),[z,F]),L=(0,o.useMemo)((function(){return U&&G&&U(G.id)}),[G,U]),O=(0,o.useMemo)((function(){return Object.keys(i.A2).find((function(e){return i.A2[e].route===b.strategy}))}),[b]),R=(0,o.useMemo)((function(){return O&&i.A2[O].color}),[O]),N=(0,o.useMemo)((function(){if(!G)return null;var e=i.A2[G.type];return null!==e&&void 0!==e&&e.carouselItems?(0,v.jsx)(g.StrategyDescriptionCarousel,{color:R,strategy:G.type,delay:1e4}):null}),[G,R]),H=(0,o.useMemo)((function(){var e;return(null===L||void 0===L?void 0:L.vaultPosition)&&(0,u.gA)(null===L||void 0===L||null===(e=L.vaultPosition)||void 0===e?void 0:e.underlying.redeemable).div(L.totalSupply)}),[L]),W=(0,o.useMemo)((function(){if(!L||null===L||void 0===L||!L.underlyingId||!B||!_)return(0,u.gA)(0);var e=B(L.underlyingId),t=_(L.underlyingId);return(0,u.d5)(e).times((0,u.d5)(t))}),[L,B,_]),K=(0,o.useMemo)((function(){return G&&"description"in G&&G.description?(0,v.jsx)(a.Card.Dark,{children:(0,v.jsx)(f.xv,{dangerouslySetInnerHTML:{__html:G.description}})}):null}),[G]);return(0,o.useEffect)((function(){L&&C(Date.now())}),[L]),(0,o.useEffect)((function(){!(Z&&L&&k!==(null===L||void 0===L?void 0:L.id)&&D&&P)||D>P||P>S||((0,u.AV)(L,W),T(L.id))}),[L,D,W,P,Z,S,k,T]),(0,v.jsxs)(f.gC,{spacing:10,width:"100%",children:[K,L.vaultPosition&&(0,v.jsx)(p.AssetProvider,{wrapFlex:!1,assetId:G.id,children:(0,v.jsxs)(f.MI,{width:"100%",columns:[2,4],spacing:[10,14],alignItems:"flex-start",children:[(0,v.jsxs)(f.gC,{spacing:2,justifyContent:"center",children:[(0,v.jsx)(l.Translation,{component:f.xv,translation:"defi.deposited",textStyle:"titleSmall"}),(0,v.jsxs)(f.Ug,{spacing:1,alignItems:"baseline",children:[(0,v.jsx)(p.AssetProvider.Deposited,{textStyle:"heading",fontSize:"h3"}),(0,v.jsx)(p.AssetProvider.Name,{textStyle:"heading",fontSize:"h3"})]})]}),(0,v.jsxs)(f.gC,{spacing:2,justifyContent:"center",children:[(0,v.jsx)(l.Translation,{component:f.xv,translation:"defi.share",textStyle:"titleSmall"}),(0,v.jsx)(p.AssetProvider.GaugeShare,{minValue:.01,textStyle:"heading",fontSize:"h3"})]}),(0,v.jsxs)(f.gC,{spacing:2,justifyContent:"center",children:[(0,v.jsx)(l.Translation,{component:f.xv,translation:"defi.idleDistribution",textStyle:"titleSmall"}),(0,v.jsxs)(f.Ug,{spacing:1,alignItems:"baseline",children:[(0,v.jsx)(p.AssetProvider.GaugeUserDistribution,{suffix:" ".concat(null===(e=G.rewardToken)||void 0===e?void 0:e.token),textStyle:"heading",fontSize:"h3"}),(0,v.jsx)(l.Translation,{component:f.xv,translation:["/","common.day"],textStyle:"captionSmall",textTransform:"lowercase"})]})]}),(0,v.jsxs)(f.gC,{spacing:2,justifyContent:"center",children:[(0,v.jsx)(l.Translation,{component:f.xv,translation:"defi.additionalRewards",textStyle:"titleSmall"}),(0,v.jsx)(f.gC,{spacing:2,children:(null===(t=G.multiRewardsTokens)||void 0===t?void 0:t.length)>0?Object.keys(null===(n=L.gaugeData)||void 0===n?void 0:n.rewards).map((function(e){var t=L.gaugeData.rewards[e];if(e===G.rewardToken.address)return null;var n=U(e);return(0,v.jsxs)(f.Ug,{spacing:1,alignItems:"baseline",children:[(0,v.jsx)(r.Amount,{value:t.rate.times(H),suffix:" ".concat(n.token),textStyle:"heading",fontSize:"h3"}),(0,v.jsx)(l.Translation,{component:f.xv,translation:["/","common.day"],textStyle:"captionSmall",textTransform:"lowercase"})]},"reward_".concat(e))})):(0,v.jsx)(f.xv,{textStyle:"heading",fontSize:"h3",children:"-"})})]})]})}),(0,v.jsxs)(f.gC,{spacing:6,width:"100%",alignItems:"flex-start",children:[(0,v.jsx)(l.Translation,{component:f.X6,as:"h3",size:"md",translation:"defi.rewards"}),(0,v.jsx)(f.gC,{spacing:4,width:"100%",children:(0,u.xb)(null===(h=L.gaugeData)||void 0===h?void 0:h.rewards)?null:Object.keys(null===(j=L.gaugeData)||void 0===j?void 0:j.rewards).map((function(e){var t=L.gaugeData.rewards[e],n=G.getClaimRewardsContractSendMethod(e);return(0,v.jsx)(p.AssetProvider,{wrapFlex:!1,assetId:e,children:(0,v.jsx)(a.Card,{p:6,px:8,width:"100%",children:(0,v.jsxs)(f.Kq,{width:"100%",spacing:[4,0],alignItems:"center",direction:["column","row"],justifyContent:"space-between",children:[(0,v.jsxs)(f.MI,{width:"100%",spacing:[6,0],columns:[2,4],children:[(0,v.jsxs)(f.gC,{spacing:2,alignItems:"flex-start",justifyContent:"flex-start",children:[(0,v.jsx)(l.Translation,{component:f.xv,translation:"defi.asset",textStyle:"captionSmall"}),(0,v.jsx)(p.AssetProvider.GeneralData,{size:"xs",field:"asset"})]}),(0,v.jsxs)(f.gC,{spacing:2,alignItems:"flex-start",justifyContent:"flex-start",children:[(0,v.jsx)(l.Translation,{component:f.xv,translation:"defi.apy",textStyle:"captionSmall"}),(0,v.jsx)(r.Amount.Percentage,{textStyle:"tableCell",value:t.apr})]}),(0,v.jsxs)(f.gC,{spacing:2,alignItems:"flex-start",justifyContent:"flex-start",children:[(0,v.jsx)(l.Translation,{component:f.xv,translation:"defi.dailyDistribution",textStyle:"captionSmall"}),(0,v.jsxs)(f.Ug,{spacing:1,width:"100%",children:[(0,v.jsx)(r.Amount,{textStyle:"tableCell",value:t.rate}),(0,v.jsx)(p.AssetProvider.Name,{textStyle:"tableCell"})]})]}),(0,v.jsxs)(f.gC,{spacing:2,alignItems:"flex-start",justifyContent:"flex-start",children:[(0,v.jsx)(l.Translation,{component:f.xv,translation:"defi.claimable",textStyle:"captionSmall"}),(0,v.jsxs)(f.Ug,{spacing:1,width:"100%",children:[(0,v.jsx)(r.Amount,{textStyle:"tableCell",value:t.balance}),(0,v.jsx)(p.AssetProvider.Name,{textStyle:"tableCell"})]})]})]}),(0,v.jsx)(m.TransactionButton,{text:"defi.claim",vaultId:F.id,assetId:e,contractSendMethod:n,actionType:"claim",amount:t.balance.toString(),width:["100%","150px"],disabled:t.balance.lte(0)})]})})},"reward_".concat(e))}))})]}),(0,v.jsx)(x.AssetGeneralData,{assetId:null===G||void 0===G?void 0:G.id}),N]})}},98428:function(e,t,n){n.r(t),n.d(t,{IconTab:function(){return x}});var s=n(1413),a=n(7276),i=n(79681),r=n(88089),o=n(96699),l=n(43127),c=n(3498),d=n(70820),u=n(2092),p=n(45263),x=a.forwardRef((function(e,t){var n=(0,i.qM)(),a=(0,r.xD)((0,s.Z)((0,s.Z)({},e),{},{ref:t})),x=(0,o.jC)("Tabs",(0,s.Z)((0,s.Z)({},a),{},{variant:"unstyled"}));return(0,p.jsx)(l.zx,(0,s.Z)((0,s.Z)({background:"transparent",borderRadius:0,__css:x.tab},a),{},{children:(0,p.jsxs)(c.Ug,{spacing:2,width:"full",justifyContent:"center",children:[a.children,e.icon&&(0,p.jsx)(d.u,{hasArrow:!0,placement:"top",label:e.icon.tooltip?n(e.icon.tooltip):"",children:(0,p.jsx)(u.Ee,(0,s.Z)({src:e.icon.src},e.icon.props))})]})}))}))},37658:function(e,t,n){n.r(t),n.d(t,{InteractiveComponent:function(){return x}});var s=n(29439),a=n(7276),i=n(55967),r=n(66288),o=n(15542),l=n(3498),c=n(43127),d=n(18147),u=n(4710),p=n(45263),x=function(e){var t=e.assetId,n=e.vaultId,x=e.actions,m=(0,r.X)().isMobile,f=(0,a.useState)(!1),g=(0,s.Z)(f,2),v=g[0],h=g[1],j=(0,a.useState)(!1),b=(0,s.Z)(j,2),y=b[0],w=b[1];return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)(l.gC,{left:0,zIndex:[40,0],spacing:[0,6],id:"right-side",width:["100vw","27em"],height:["100vh","auto"],position:["fixed","relative"],top:[v?0:"100vh",0],bg:m?"rgba(0, 0, 0, 0.5)":void 0,sx:m?{transition:"top 0.3s ease-in-out"}:{},children:[(0,p.jsxs)(l.gC,{bottom:0,spacing:0,width:"100%",height:["100vh","auto"],position:["fixed","relative"],top:[v?0:"100vh",0],sx:m?{transition:"top 0.3s ease-in-out"}:{},children:[m&&(0,p.jsxs)(l.Ug,{px:4,py:2,bg:"card.bg",width:"100%",borderBottom:"1px solid",borderBottomColor:"divider",justifyContent:"space-between",children:[(0,p.jsx)(o.Translation,{alignItems:"center",display:"flex",variant:"unstyled",translation:"common.exit",component:c.zx,leftIcon:(0,p.jsx)(i.sG8,{size:24}),onClick:function(){return h(!1)}}),(0,p.jsx)(o.Translation,{alignItems:"center",display:"flex",variant:"unstyled",translation:["common.show","navBar.transactions"],component:c.zx,onClick:function(){return w(!0)}})]}),(0,p.jsx)(u.OperativeComponent,{flex:1,minHeight:m?"auto":"590px",borderRadius:m?0:void 0,assetId:t,actions:x})]}),(0,p.jsxs)(l.gC,{flex:1,bottom:0,spacing:0,width:"100%",height:["100vh","auto"],position:["fixed","relative"],top:[y?0:"100vh",0],sx:m?{transition:"top 0.3s ease-in-out"}:{},children:[m&&(0,p.jsxs)(l.Ug,{px:4,py:2,bg:"card.bg",width:"100%",borderBottom:"1px solid",borderBottomColor:"divider",justifyContent:"space-between",children:[(0,p.jsx)(o.Translation,{alignItems:"center",display:"flex",variant:"unstyled",translation:"common.back",component:c.zx,leftIcon:(0,p.jsx)(i.sG8,{size:24}),onClick:function(){return w(!1)}}),(0,p.jsx)(o.Translation,{textStyle:"ctaStatic",translation:"assets.assetDetails.assetHistory.transactionHistory",component:l.xv})]}),(0,p.jsx)(d.TransactionList,{assetIds:[n],fullHeightOnMobile:!0,maxH:["100%",600]})]})]}),m&&(0,p.jsx)(l.kC,{p:4,left:0,bottom:0,border:0,width:"100%",zIndex:[10,0],bg:"card.bgDark",position:"fixed",children:(0,p.jsx)(o.Translation,{component:c.zx,translation:["common.start","common.deposit"],variant:"ctaFull",onClick:function(){return h(!0)}})})]})}},96362:function(e,t,n){n.r(t),n.d(t,{Approve:function(){return S}});var s=n(74165),a=n(15861),i=n(29439),r=n(54447),o=n(99594),l=n(87099),c=n(55967),d=n(47174),u=n(72230),p=n(7276),x=n(15542),m=n(1128),f=n(23023),g=n(3498),v=n(65984),h=n(43127),j=n(78951),b=n(4710),y=n(75712),w=n(45263),S=function(e){var t=e.amountUsd,n=e.goBack,S=e.itemIndex,C=(0,d.Y)().account,A=(0,b.useOperativeComponent)(),I=A.defaultAmount,k=A.dispatch,T=A.activeItem,M=(0,p.useState)(I),D=(0,i.Z)(M,2),P=D[0],Z=D[1],E=(0,y.useAssetProvider)(),U=E.underlyingAsset,z=E.vault,B=E.translate,_=E.theme,F=(0,p.useState)(!1),G=(0,i.Z)(F,2),L=G[0],O=G[1],R=(0,p.useState)(I),N=(0,i.Z)(R,2),H=N[0],W=N[1],K=(0,f.R)(),q=K.sendTransaction,V=K.setGasLimit;(0,p.useEffect)((function(){Z(I)}),[I]);var X=(0,p.useCallback)((0,a.Z)((0,s.Z)().mark((function e(){var t,n,a,i;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(z&&"getAllowanceContractSendMethod"in z&&"getAllowanceParams"in z){e.next=2;break}return e.abrupt("return");case 2:if(t={from:null===C||void 0===C?void 0:C.address},n=z.getAllowanceParams(l.Uf),a=z.getAllowanceContractSendMethod(n)){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,(0,o.$K)(a,t);case 9:return i=e.sent,e.abrupt("return",i);case 11:case"end":return e.stop()}}),e)}))),[C,z]),Y=(0,p.useCallback)((function(){if(z&&"getAllowanceContractSendMethod"in z&&"getAllowanceParams"in z){var e=z.getAllowanceParams(H),t=z.getAllowanceContractSendMethod(e);t&&q(z.id,null===U||void 0===U?void 0:U.id,t)}}),[H,z,U,q]);return(0,p.useEffect)((function(){var e=L?P:l.Uf;W(e),T===S&&k({type:"SET_AMOUNT",payload:e})}),[L,P,k,T,S]),(0,p.useEffect)((function(){T===S&&(0,a.Z)((0,s.Z)().mark((function e(){var t;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,X();case 2:t=e.sent,V(t);case 4:case"end":return e.stop()}}),e)})))()}),[T,S,X,V]),(0,w.jsxs)(g.gC,{flex:1,width:"100%",alignItems:"flex-start",children:[(0,w.jsx)(u.NavBar,{goBack:n,translation:"modals.approve.header",params:{asset:null===U||void 0===U?void 0:U.name}}),(0,w.jsx)(g.kC,{p:14,pt:20,flex:1,children:(0,w.jsxs)(g.gC,{spacing:6,children:[(0,w.jsx)(c.PG4,{size:72}),(0,w.jsx)(x.Translation,{component:g.xv,prefix:"".concat(B("modals.approve.routerName")," "),translation:"modals.approve.body",params:{asset:null===U||void 0===U?void 0:U.name},textStyle:"heading",fontSize:"h3",textAlign:"center"}),(0,w.jsxs)(g.gC,{width:"100%",spacing:6,children:[(0,w.jsxs)(g.Ug,{py:2,width:"100%",justifyContent:"space-between",borderTop:"1px solid ".concat(_.colors.divider),borderBottom:"1px solid ".concat(_.colors.divider),children:[(0,w.jsx)(x.Translation,{component:g.xv,translation:"trade.allowance",textStyle:"captionSmall"}),(0,w.jsxs)(g.Ug,{spacing:1,children:[(0,w.jsx)(x.Translation,{component:g.xv,translation:"trade.unlimited",textStyle:["captionSmall","clickable"],fontWeight:700,color:L?"ctaDisabled":"primary",onClick:function(){return O(!1)}}),(0,w.jsx)(v.r,{size:"sm",isChecked:L,onChange:function(e){return O(e.target.checked)}}),(0,w.jsx)(x.Translation,{component:g.xv,translation:"trade.exact",textStyle:["captionSmall","clickable"],fontWeight:700,color:L?"primary":"ctaDisabled",onClick:function(){return O(!0)}})]})]}),L&&(0,w.jsxs)(g.Ug,{children:[(0,w.jsx)(y.AssetProvider.Icon,{size:"sm"}),(0,w.jsx)(r.Card,{px:4,py:2,layerStyle:"cardLight",children:(0,w.jsx)(m.InputAmount,{inputHeight:6,amount:P,amountUsd:t,setAmount:Z})})]})]}),(0,w.jsx)(x.Translation,{component:h.zx,translation:"common.approve",onClick:Y,variant:"ctaFull"})]})}),(0,w.jsx)(j.EstimatedGasFees,{})]})}},97901:function(e,t,n){n.r(t),n.d(t,{Deposit:function(){return D}});var s=n(74165),a=n(15861),i=n(29439),r=n(5128),o=n(54447),l=n(87099),c=n(4432),d=n(13708),u=n(47174),p=n(61617),x=n(15542),m=n(39177),f=n(1128),g=n(85267),v=n(1669),h=n(7276),j=n(23023),b=n(43127),y=n(3498),w=n(2092),S=n(78951),C=n(4710),A=n(66624),I=n(86393),k=n(75712),T=n(99594),M=n(45263),D=function(e){var t=e.itemIndex,n=(0,h.useState)(""),D=(0,i.Z)(n,2),P=D[0],Z=D[1],E=(0,h.useState)("0"),U=(0,i.Z)(E,2),z=U[0],B=U[1],_=(0,h.useState)(0),F=(0,i.Z)(_,2),G=F[0],L=F[1],O=(0,u.Y)().account,R=(0,g.m)().searchParams,N=(0,j.R)(),H=N.sendTransaction,W=N.setGasLimit,K=N.state.transaction,q=(0,v.w)().selectors,V=q.selectAssetPriceUsd,X=q.selectAssetBalance,Y=(0,k.useAssetProvider)(),$=Y.asset,Q=Y.vault,J=Y.underlyingAsset,ee=Y.translate,te=(0,C.useOperativeComponent)(),ne=te.dispatch,se=te.activeItem,ae=te.activeStep,ie=te.executeAction,re=te.setActionIndex,oe=(0,h.useMemo)((function(){return R}),[R]),le=(0,i.Z)(oe,1)[0],ce=(0,h.useMemo)((function(){var e;return Q&&"flags"in Q&&(null===(e=Q.flags)||void 0===e?void 0:e.referralEnabled)}),[Q]),de=(0,h.useMemo)((function(){var e;return Q&&"flags"in Q&&(null===(e=Q.flags)||void 0===e?void 0:e.depositsDisabled)}),[Q]),ue=(0,h.useMemo)((function(){if(ce){var e=le.get("_referral");if((0,T.fF)(e)&&e!==l.r_)return e}}),[ce,le]),pe=(0,h.useMemo)((function(){return X?X(null===J||void 0===J?void 0:J.id):(0,T.gA)(0)}),[X,null===J||void 0===J?void 0:J.id]);(0,h.useEffect)((function(){if(V&&J){var e=V(J.id),t=parseFloat((0,T.gA)(z).times(e).toString())||0;L(t)}}),[J,z,V,ne]),(0,h.useEffect)((function(){ie||ae!==t||"success"!==K.status||B("")}),[ie,K.status,ae,t]);var xe=(0,h.useMemo)((function(){return Q&&(!("enabled"in Q)||Q.enabled)&&$&&"deprecated"!==(null===$||void 0===$?void 0:$.status)}),[Q,$]),me=(0,h.useMemo)((function(){return Z(""),!(xe&&!de&&"paused"!==(null===$||void 0===$?void 0:$.status))||(!(!(0,T.gA)(z).isNaN()&&!(0,T.gA)(z).lte(0))||!!(0,T.gA)(z).gt(pe)&&(Z(ee("trade.errors.insufficientFundsForAmount",{symbol:null===J||void 0===J?void 0:J.name})),!0))}),[$,z,xe,de,pe,J,ee]),fe=(0,h.useCallback)((0,a.Z)((0,s.Z)().mark((function e(){var t,n,a;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(J&&Q&&"getAllowanceContract"in Q){e.next=2;break}return e.abrupt("return",(0,T.gA)(0));case 2:if(null!==O&&void 0!==O&&O.address){e.next=4;break}return e.abrupt("return",(0,T.gA)(0));case 4:if(t=Q.getAllowanceContract()){e.next=7;break}return e.abrupt("return",(0,T.gA)(0));case 7:return n=(0,T.WP)(Q),e.next=10,(0,T.RC)(t,O.address,n);case 10:return a=e.sent,e.abrupt("return",(0,T.I0)(a,J.decimals));case 12:case"end":return e.stop()}}),e)}))),[J,Q,null===O||void 0===O?void 0:O.address]),ge=(0,h.useCallback)((function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];O&&!me&&Q&&"getDepositContractSendMethod"in Q&&"getDepositParams"in Q&&(0,a.Z)((0,s.Z)().mark((function t(){var n,a,i;return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e){t.next=6;break}return t.next=3,fe();case 3:t.t0=t.sent,t.next=7;break;case 6:t.t0=(0,T.gA)(z);case 7:t.t0.gte(z)?(a=ue&&"flags"in Q&&null!==(n=Q.flags)&&void 0!==n&&n.referralEnabled?Q.getDepositParams(z,ue):Q.getDepositParams(z),i=Q.getDepositContractSendMethod(a),(0,d.tM)($,G),H(Q.id,null===J||void 0===J?void 0:J.id,i)):ne({type:"SET_ACTIVE_STEP",payload:1});case 9:case"end":return t.stop()}}),t)})))()}),[O,me,ue,z,G,Q,$,J,ne,fe,H]),ve=(0,h.useCallback)((function(){null!==J&&void 0!==J&&J.balance&&B(J.balance.toString())}),[J]),he=(0,h.useCallback)((0,a.Z)((0,s.Z)().mark((function e(){var t,n,a,i,o,l,c,d,u;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Q&&"getDepositContractSendMethod"in Q&&"getDepositParams"in Q){e.next=2;break}return e.abrupt("return");case 2:return n=Q.getMethodDefaultGasLimit("deposit"),e.next=5,fe();case 5:if(a=e.sent,O&&!pe.lte(0)&&!a.lte(0)){e.next=8;break}return e.abrupt("return",n);case 8:return i=r.Z.minimum(pe,a),o={from:null===O||void 0===O?void 0:O.address},l=i.toFixed(),c=ue&&"flags"in Q&&null!==(t=Q.flags)&&void 0!==t&&t.referralEnabled?Q.getDepositParams(l,ue):Q.getDepositParams(l),d=Q.getDepositContractSendMethod(c),e.next=15,(0,T.$K)(d,o);case 15:if(e.t0=e.sent,e.t0){e.next=18;break}e.t0=n;case 18:return u=e.t0,e.abrupt("return",u);case 20:case"end":return e.stop()}}),e)}))),[O,Q,ue,fe,pe]);(0,h.useEffect)((function(){se===t&&(0,a.Z)((0,s.Z)().mark((function e(){var t;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,he();case 2:t=e.sent,W(t);case 4:case"end":return e.stop()}}),e)})))()}),[se,t,he,W]),(0,h.useEffect)((function(){se===t&&(ne({type:"SET_AMOUNT",payload:z}),ne({type:"SET_DEFAULT_AMOUNT",payload:z}),ne({type:"SET_ASSET",payload:J}),ie&&(ge(!1),ne({type:"SET_EXECUTE_ACTION",payload:!1})))}),[z,se,J,t,ne,ie,ge]);var je=(0,h.useMemo)((function(){return O?(0,M.jsx)(x.Translation,{component:b.zx,translation:"common.deposit",disabled:me,onClick:ge,variant:"ctaFull"}):(0,M.jsx)(I.ConnectWalletButton,{variant:"ctaFull"})}),[O,me,ge]),be=(0,h.useMemo)((function(){return ue?(0,M.jsx)(o.Card.Dark,{py:2,pl:3,pr:2,border:0,children:(0,M.jsxs)(y.gC,{spacing:1,children:[(0,M.jsx)(x.Translation,{textStyle:"captionSmaller",translation:"defi.depositWithReferral"}),(0,M.jsx)(m.AddressLink,{address:ue,text:ue,fontSize:"sm"})]})}):null}),[ue]),ye=(0,h.useMemo)((function(){return Q&&"messages"in Q?Q.messages:void 0}),[Q]),we=(0,h.useMemo)((function(){return!xe&&pe.gt(0)?(0,M.jsx)(o.Card.Dark,{py:2,pl:3,pr:2,border:0,children:(0,M.jsxs)(y.Ug,{spacing:3,width:"full",children:[(0,M.jsx)(w.Ee,{src:"".concat(c.pm,"vaults/deprecated.png"),width:6,height:6}),(0,M.jsx)(x.Translation,{textStyle:"captionSmaller",translation:"trade.vaults.".concat(null===$||void 0===$?void 0:$.type,".disabled"),textAlign:"left"}),(0,M.jsx)(x.Translation,{component:b.zx,translation:"trade.vaults.".concat(null===$||void 0===$?void 0:$.type,".disabledCta"),fontSize:"xs",height:"auto",width:"auto",py:3,px:7,onClick:function(){return re(1)}})]})}):$&&"production"!==(null===$||void 0===$?void 0:$.status)?(0,M.jsx)(o.Card.Dark,{p:2,border:0,children:(0,M.jsx)(y.gC,{spacing:2,width:"full",justifyContent:"center",children:(0,M.jsx)(x.Translation,{textStyle:"captionSmaller",translation:"trade.actions.deposit.messages.".concat($.status),textAlign:"center"})})}):(null===ye||void 0===ye?void 0:ye.deposit)&&(0,M.jsx)(o.Card.Dark,{p:2,border:0,children:(0,M.jsx)(x.Translation,{textStyle:"captionSmaller",translation:ye.deposit,isHtml:!0,textAlign:"center"})})}),[$,xe,pe,ye,re]);return(0,M.jsx)(k.AssetProvider,{flex:1,width:"100%",assetId:null===$||void 0===$?void 0:$.underlyingId,children:(0,M.jsxs)(y.gC,{pt:8,flex:1,spacing:6,height:"100%",id:"deposit-container",alignItems:"space-between",justifyContent:"flex-start",children:[(0,M.jsxs)(y.gC,{flex:1,spacing:6,width:"100%",alignItems:"flex-start",children:[(0,M.jsxs)(y.Ug,{width:"100%",spacing:[3,4],alignItems:"flex-start",children:[(0,M.jsx)(y.xu,{pt:8,children:(0,M.jsx)(p.AssetLabel,{assetId:null===$||void 0===$?void 0:$.id})}),(0,M.jsxs)(y.gC,{spacing:1,width:"100%",alignItems:"flex-start",children:[(0,M.jsx)(o.Card,{px:4,py:2,layerStyle:"cardLight",children:(0,M.jsxs)(y.gC,{spacing:2,alignItems:"flex-start",children:[(0,M.jsx)(f.InputAmount,{amount:z,amountUsd:G,setAmount:B}),(0,M.jsxs)(y.Ug,{width:"100%",justifyContent:"space-between",children:[(0,M.jsxs)(y.Ug,{spacing:1,children:[(0,M.jsx)(x.Translation,{component:y.xv,translation:"common.balance",textStyle:"captionSmaller"}),(0,M.jsx)(k.AssetProvider.Balance,{abbreviate:!0,decimals:4,textStyle:"captionSmaller",color:"primary"})]}),(0,M.jsx)(b.zx,{variant:"selector",onClick:ve,children:"MAX"})]})]})}),P&&(0,M.jsx)(y.xv,{textStyle:"captionSmaller",color:"orange",children:P})]})]}),be,we,(0,M.jsx)(A.DynamicActionFields,{assetId:null===$||void 0===$?void 0:$.id,action:"deposit",amount:z,amountUsd:G})]}),(0,M.jsxs)(y.gC,{spacing:4,id:"footer",alignItems:"flex-start",children:[(0,M.jsx)(S.EstimatedGasFees,{}),je]})]})})}}}]);