"use strict";(self.webpackChunkidle_dashboard_new=self.webpackChunkidle_dashboard_new||[]).push([[4872],{54872:function(t,e,a){a.r(e),a.d(e,{BalanceChart:function(){return c}});var r=a(3498),n=a(7276),i=a(64771),o=a(86510),s=a(15034),u=a(45263),c=function(t){var e=t.assetIds,a=t.accountId,c=t.timeframe,l=t.strategies,d=t.isRainbowChart,f=t.setPercentChange,h=t.color,b=void 0===h?"chart.stroke":h,m=t.margins,v=void 0===m?{top:0,right:0,bottom:0,left:0}:m,p=(0,s.k)({assetIds:e,accountId:a,timeframe:c,strategies:l}),g=p.balanceChartData,y=p.balanceChartDataLoading,k=g.total;(0,n.useEffect)((function(){return f((0,o.gB)(k))}),[k,f]);return(0,u.jsx)(r.xu,{width:"full",p:0,height:"350px",children:(0,u.jsx)(i.Graph,{color:b,margins:v,formatFn:function(t){return"$".concat((0,o.dm)(t))},data:g,isRainbowChart:d,loading:y,isLoaded:!y})})}},15034:function(t,e,a){a.d(e,{k:function(){return d}});var r=a(1413),n=a(29439),i=a(66549),o=a.n(i),s=a(5128),u=a(7276),c=a(92505),l=a(86510),d=function(t){var e=t.assetIds,a=t.strategies,i=t.timeframe,d=t.useDollarConversion,f=void 0===d||d,h=(0,c.w)(),b=h.isPortfolioLoaded,m=h.historicalPrices,v=h.historicalPricesUsd,p=h.selectors,g=p.selectAssetsByIds,y=p.selectVaultTransactions,k=p.selectAssetHistoricalPriceByTimestamp,w=p.selectAssetHistoricalPriceUsdByTimestamp,x=(0,u.useState)(!0),C=(0,n.Z)(x,2),O=C[0],A=C[1],j=(0,u.useMemo)((function(){return g?g(e).filter((function(t){return!a||!t.type||a.includes(t.type)})):[]}),[e,a,g]),D=(0,u.useMemo)((function(){return i?(0,l.pM)(i):0}),[i]),I=(0,u.useMemo)((function(){var t={total:[],rainbow:[]};if(!b||(0,l.xb)(m)||(0,l.xb)(v))return t;var e=j.reduce((function(t,e){if(null===e||void 0===e||!e.id)return t;var a=e.id,r=y(a);if(!r.length)return t;var n=r.reduce((function(t,e){var a=+o()(1e3*+e.timeStamp).startOf("day").valueOf();switch(e.action){case"deposit":t.total=t.total.plus(e.idleAmount);break;case"redeem":t.total=s.Z.maximum(0,t.total.minus(e.idleAmount))}return t.byDate[a]=t.total,t}),{total:(0,l.gA)(0),byDate:{}});return Object.keys(n.byDate).forEach((function(a){t[a]||(t[a]={}),e.id&&(t[a][e.id]=parseFloat(n.byDate[a].toFixed(8)))})),t}),{});if((0,l.xb)(e))return t;for(var a=+Object.keys(e).sort()[0],n=+o()().endOf("day").valueOf(),i=(0,l.Up)(a,n),u={},c=0,d=null;c<i.length;c++){var h=i[c];u[h]=(0,r.Z)((0,r.Z)({},d?u[d]:{}),e[h]),d=h}var p={},g={};return Object.keys(u).forEach((function(t){var e=u[t];Object.keys(e).forEach((function(a){var r=j.find((function(t){return t.id===a})),n=null===r||void 0===r?void 0:r.underlyingId,i=k(a,t)||p[a];if(i&&(e[a]=parseFloat((0,l.gA)(e[a]).times((0,l.gA)(i.value)).toFixed(8)),p[a]=i),f){var o=w(n,t)||g[a];o&&(e[a]=parseFloat((0,l.gA)(e[a]).times((0,l.gA)(o.value)).toFixed(8)),g[a]=o)}})),e.total=Object.values(e).reduce((function(t,e){return t+e}),0)})),t.total=Object.keys(u).reduce((function(t,e){return e<D||t.push({date:parseInt(e),value:u[e].total}),t}),[]),t.rainbow=Object.keys(u).reduce((function(t,e){return e<D||t.push((0,r.Z)({date:parseInt(e),total:u[e].total},u[e])),t}),[]),t}),[j,f,D,y,b,m,v,k,w]);return(0,u.useEffect)((function(){if(I.rainbow.length)return A(!1),function(){A(!0)}}),[I]),{assets:j,balanceChartData:I,balanceChartDataLoading:O}}}}]);