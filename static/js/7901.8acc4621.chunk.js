"use strict";(self.webpackChunkidle_dashboard_new=self.webpackChunkidle_dashboard_new||[]).push([[7901,6624],{97901:function(e,t,n){n.r(t),n.d(t,{Deposit:function(){return C}});var a=n(74165),i=n(15861),r=n(29439),s=n(5128),l=n(54447),o=n(4432),u=n(13708),d=n(88935),c=n(61617),v=n(15542),m=n(1128),p=n(1669),x=n(7276),f=n(23023),g=n(43127),y=n(3498),A=n(2092),h=n(78951),S=n(4710),b=n(66624),j=n(86393),Z=n(7386),w=n(99594),k=n(45263),C=function(e){var t=e.itemIndex,n=(0,x.useState)(""),C=(0,r.Z)(n,2),I=C[0],M=C[1],E=(0,x.useState)("0"),D=(0,r.Z)(E,2),P=D[0],T=D[1],U=(0,x.useState)(0),B=(0,r.Z)(U,2),F=B[0],_=B[1],L=(0,d.Y)().account,N=(0,f.R)(),G=N.sendTransaction,O=N.setGasLimit,V=N.state.transaction,z=(0,p.w)().selectors,R=z.selectAssetPriceUsd,W=z.selectAssetBalance,X=(0,Z.useAssetProvider)(),H=X.asset,K=X.vault,Y=X.underlyingAsset,$=X.translate,q=(0,S.useOperativeComponent)(),J=q.dispatch,Q=q.activeItem,ee=q.activeStep,te=q.executeAction,ne=q.setActionIndex,ae=(0,x.useMemo)((function(){return W?W(null===Y||void 0===Y?void 0:Y.id):(0,w.gA)(0)}),[W,null===Y||void 0===Y?void 0:Y.id]);(0,x.useEffect)((function(){if(R&&Y){var e=R(Y.id),t=parseFloat((0,w.gA)(P).times(e).toString())||0;_(t)}}),[Y,P,R,J]),(0,x.useEffect)((function(){te||ee!==t||"success"!==V.status||T("")}),[te,V.status,ee,t]);var ie=(0,x.useMemo)((function(){return K&&(!("enabled"in K)||K.enabled)}),[K]),re=(0,x.useMemo)((function(){return M(""),!ie||(!(!(0,w.gA)(P).isNaN()&&!(0,w.gA)(P).lte(0))||!!(0,w.gA)(P).gt(ae)&&(M($("trade.errors.insufficientFundsForAmount",{symbol:null===Y||void 0===Y?void 0:Y.name})),!0))}),[P,ie,ae,Y,$]),se=(0,x.useCallback)((0,i.Z)((0,a.Z)().mark((function e(){var t,n,i;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Y&&K&&"getAllowanceContract"in K){e.next=2;break}return e.abrupt("return",(0,w.gA)(0));case 2:if(null!==L&&void 0!==L&&L.address){e.next=4;break}return e.abrupt("return",(0,w.gA)(0));case 4:if(t=K.getAllowanceContract()){e.next=7;break}return e.abrupt("return",(0,w.gA)(0));case 7:return n=(0,w.WP)(K),e.next=10,(0,w.RC)(t,L.address,n);case 10:return i=e.sent,e.abrupt("return",(0,w.I0)(i,Y.decimals));case 12:case"end":return e.stop()}}),e)}))),[Y,K,null===L||void 0===L?void 0:L.address]),le=(0,x.useCallback)((function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];L&&!re&&K&&"getDepositContractSendMethod"in K&&"getDepositParams"in K&&(0,i.Z)((0,a.Z)().mark((function t(){var n,i;return(0,a.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e){t.next=6;break}return t.next=3,se();case 3:t.t0=t.sent,t.next=7;break;case 6:t.t0=(0,w.gA)(P);case 7:t.t0.gte(P)?(n=K.getDepositParams(P),i=K.getDepositContractSendMethod(n),(0,u.tM)(H,F),G(K.id,null===Y||void 0===Y?void 0:Y.id,i)):J({type:"SET_ACTIVE_STEP",payload:1});case 9:case"end":return t.stop()}}),t)})))()}),[L,re,P,F,K,H,Y,J,se,G]),oe=(0,x.useCallback)((function(){null!==Y&&void 0!==Y&&Y.balance&&T(Y.balance.toString())}),[Y]),ue=(0,x.useCallback)((0,i.Z)((0,a.Z)().mark((function e(){var t,n,i,r,l,o,u;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(K&&"getDepositContractSendMethod"in K&&"getDepositParams"in K){e.next=2;break}return e.abrupt("return");case 2:return t=K.getMethodDefaultGasLimit("deposit"),e.next=5,se();case 5:if(n=e.sent,L&&!ae.lte(0)&&!n.lte(0)){e.next=8;break}return e.abrupt("return",t);case 8:return i=s.Z.minimum(ae,n),r={from:null===L||void 0===L?void 0:L.address},l=K.getDepositParams(i.toFixed()),o=K.getDepositContractSendMethod(l),e.next=14,(0,w.$K)(o,r);case 14:if(e.t0=e.sent,e.t0){e.next=17;break}e.t0=t;case 17:return u=e.t0,e.abrupt("return",u);case 19:case"end":return e.stop()}}),e)}))),[L,K,se,ae]);(0,x.useEffect)((function(){Q===t&&(0,i.Z)((0,a.Z)().mark((function e(){var t;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ue();case 2:t=e.sent,O(t);case 4:case"end":return e.stop()}}),e)})))()}),[Q,t,ue,O]),(0,x.useEffect)((function(){Q===t&&(J({type:"SET_AMOUNT",payload:P}),J({type:"SET_DEFAULT_AMOUNT",payload:P}),J({type:"SET_ASSET",payload:Y}),te&&(le(!1),J({type:"SET_EXECUTE_ACTION",payload:!1})))}),[P,Q,Y,t,J,te,le]);var de=(0,x.useMemo)((function(){return L?(0,k.jsx)(v.Translation,{component:g.zx,translation:"common.deposit",disabled:re,onClick:le,variant:"ctaFull"}):(0,k.jsx)(j.ConnectWalletButton,{variant:"ctaFull"})}),[L,re,le]),ce=(0,x.useMemo)((function(){return!ie&&ae.gt(0)?(0,k.jsx)(l.Card.Dark,{py:2,pl:3,pr:2,border:0,children:(0,k.jsxs)(y.Ug,{spacing:3,width:"full",children:[(0,k.jsx)(A.Ee,{src:"".concat(o.pm,"vaults/deprecated.png"),width:6,height:6}),(0,k.jsx)(v.Translation,{textStyle:"captionSmaller",translation:"trade.vaults.".concat(null===H||void 0===H?void 0:H.type,".disabled"),textAlign:"left"}),(0,k.jsx)(v.Translation,{component:g.zx,translation:"trade.vaults.".concat(null===H||void 0===H?void 0:H.type,".disabledCta"),fontSize:"xs",height:"auto",width:"auto",py:3,px:7,onClick:function(){return ne(1)}})]})}):K&&"status"in K&&K.status&&(0,k.jsx)(l.Card.Dark,{p:2,border:0,children:(0,k.jsx)(v.Translation,{textStyle:"captionSmaller",translation:"trade.actions.deposit.messages.".concat(null===K||void 0===K?void 0:K.status),textAlign:"center"})})}),[H,K,ie,ae,ne]);return(0,k.jsx)(Z.AssetProvider,{flex:1,width:"100%",assetId:null===H||void 0===H?void 0:H.underlyingId,children:(0,k.jsxs)(y.gC,{pt:8,flex:1,spacing:6,height:"100%",id:"deposit-container",alignItems:"space-between",justifyContent:"flex-start",children:[(0,k.jsxs)(y.gC,{flex:1,spacing:6,width:"100%",alignItems:"flex-start",children:[(0,k.jsxs)(y.Ug,{width:"100%",spacing:[3,4],alignItems:"flex-start",children:[(0,k.jsx)(y.xu,{pt:8,children:(0,k.jsx)(c.AssetLabel,{assetId:null===H||void 0===H?void 0:H.id})}),(0,k.jsxs)(y.gC,{spacing:1,width:"100%",alignItems:"flex-start",children:[(0,k.jsx)(l.Card,{px:4,py:2,layerStyle:"cardLight",children:(0,k.jsxs)(y.gC,{spacing:2,alignItems:"flex-start",children:[(0,k.jsx)(m.InputAmount,{amount:P,amountUsd:F,setAmount:T}),(0,k.jsxs)(y.Ug,{width:"100%",justifyContent:"space-between",children:[(0,k.jsxs)(y.Ug,{spacing:1,children:[(0,k.jsx)(v.Translation,{component:y.xv,translation:"common.balance",textStyle:"captionSmaller"}),(0,k.jsx)(Z.AssetProvider.Balance,{abbreviate:!0,decimals:4,textStyle:"captionSmaller",color:"primary"})]}),(0,k.jsx)(g.zx,{variant:"selector",onClick:oe,children:"MAX"})]})]})}),I&&(0,k.jsx)(y.xv,{textStyle:"captionSmaller",color:"orange",children:I})]})]}),ce,(0,k.jsx)(b.DynamicActionFields,{assetId:null===H||void 0===H?void 0:H.id,action:"deposit",amount:P,amountUsd:F})]}),(0,k.jsxs)(y.gC,{spacing:4,id:"footer",alignItems:"flex-start",children:[(0,k.jsx)(h.EstimatedGasFees,{}),de]})]})})}},66624:function(e,t,n){n.r(t),n.d(t,{DynamicActionFields:function(){return f}});var a=n(1413),i=n(44925),r=n(5128),s=n(7276),l=n(12056),o=n(86059),u=n(99594),d=n(15542),c=n(1669),v=n(3498),m=n(45263),p=["assetId","field","amount","amountUsd","stakingPower"],x=function(e){var t,n,l,d,x,f=e.assetId,g=e.field,y=e.amount,A=e.amountUsd,h=e.stakingPower,S=(0,i.Z)(e,p),b=(0,c.w)(),j=b.stakingData,Z=b.helpers.vaultFunctionsHelper,w=b.selectors,k=w.selectAssetById,C=w.selectVaultById,I=w.selectVaultGauge,M=(0,s.useMemo)((function(){return f&&k&&k(f)}),[f,k]),E=(0,s.useMemo)((function(){return f&&C&&C(f)}),[f,C]),D=(0,s.useMemo)((function(){return f&&I&&I(f)}),[f,I]),P=(0,s.useMemo)((function(){return D&&k&&k(D.id)}),[D,k]),T=(0,s.useMemo)((function(){return(0,u.gA)(M.tvl).plus((0,u.d5)(y))}),[M,y]),U=(0,s.useMemo)((function(){return null===Z||void 0===Z?void 0:Z.getVaultNewApr(M,E,(0,u.gA)(y))}),[M,E,y,Z]),B=(0,s.useMemo)((function(){if((0,u.d5)(U).gt(0)){var e=(0,u.Bs)((0,u.d5)(U).div(100)).times(100),t=M.apyBreakdown?Object.keys(M.apyBreakdown||{}).filter((function(e){return"base"!==e})).reduce((function(e,t){switch(t){case"gauge":var n=null===P||void 0===P?void 0:P.gaugeData;if(n){var a=(0,u.d5)(null===n||void 0===n?void 0:n.totalSupply).plus((0,u.d5)(y)),i=(0,u.d5)(null===n||void 0===n?void 0:n.totalSupply).div(a),r=M.apyBreakdown[t].times(i);return e.plus(r)}return e.plus(M.apyBreakdown[t]);case"harvest":var s=(0,u.gA)(M.tvl).div(T),l=M.apyBreakdown[t].times(s);return e.plus(l);default:return e.plus(M.apyBreakdown[t])}}),(0,u.gA)(0)):(0,u.gA)(0);return(0,u.gA)(e).plus(t)}return(0,u.d5)(null===M||void 0===M?void 0:M.apy)}),[M,y,T,P,U]),F=(0,u.d5)(A).gt(0),_=(0,u.d5)(null===M||void 0===M||null===(t=M.vaultPosition)||void 0===t?void 0:t.underlying.redeemable),L=(0,u.d5)(null===M||void 0===M||null===(n=M.vaultPosition)||void 0===n?void 0:n.usd.redeemable),N=r.Z.maximum(0,(0,u.d5)(null===M||void 0===M||null===(l=M.vaultPosition)||void 0===l?void 0:l.usd.earnings)),G=r.Z.minimum(1,(0,u.d5)(A).div(L)),O=r.Z.minimum(N,G.times(N)),V=r.Z.maximum(0,(0,u.d5)(null===M||void 0===M||null===(d=M.vaultPosition)||void 0===d?void 0:d.usd.earnings).times(null===M||void 0===M?void 0:M.fee)),z=r.Z.minimum(V,(0,u.d5)(O).times(null===M||void 0===M?void 0:M.fee)),R=F&&(0,u.d5)(y).lte(_);switch(g){case"boost":var W=B&&null!==M&&void 0!==M&&null!==(x=M.baseApr)&&void 0!==x&&x.gt(0)?B.div(null===M||void 0===M?void 0:M.baseApr):(0,u.gA)(0);return(0,m.jsxs)(v.xv,(0,a.Z)((0,a.Z)({},S),{},{textStyle:"titleSmall",color:"primary",children:[W.toFixed(2),"x"]}));case"overperformance":var X=(0,u.d5)(A).times((0,u.gA)(null===M||void 0===M?void 0:M.baseApr).div(100)),H=(0,u.d5)(A).times((0,u.gA)(null===M||void 0===M?void 0:M.apy).div(100)),K=F?H.minus(X):null;return(0,m.jsx)(o.Amount.Usd,(0,a.Z)((0,a.Z)({textStyle:"titleSmall",color:"primary"},S),{},{value:K,suffix:"/year"}));case"newApy":return(0,m.jsx)(o.Amount.Percentage,(0,a.Z)((0,a.Z)({textStyle:"titleSmall",color:"primary"},S),{},{value:B}));case"gain":return(0,m.jsx)(o.Amount.Usd,(0,a.Z)((0,a.Z)({textStyle:"titleSmall",color:"primary"},S),{},{value:R?O:null}));case"fee":return(0,m.jsx)(o.Amount.Usd,(0,a.Z)((0,a.Z)({textStyle:"titleSmall",color:"primary"},S),{},{value:R?z:null}));case"netGain":var Y=r.Z.minimum(N.minus(z),(0,u.d5)(O).minus(z));return(0,m.jsx)(o.Amount.Usd,(0,a.Z)((0,a.Z)({textStyle:"titleSmall",color:"primary"},S),{},{value:R?Y:null}));case"coverage":var $=k(null===E||void 0===E?void 0:E.vaultConfig.Tranches.BB.address),q=$.tvl&&T?$.tvl.div(T).times(100):0;return(0,m.jsx)(o.Amount.Percentage,(0,a.Z)((0,a.Z)({textStyle:"titleSmall",color:"primary"},S),{},{value:q}));case"stakingPoolShare":if(!j)return null;var J=(0,u.d5)(y).div(j.stkIDLE.totalSupply.plus((0,u.d5)(y))).times(100);return(0,m.jsx)(o.Amount.Percentage,(0,a.Z)((0,a.Z)({textStyle:"titleSmall",color:"primary"},S),{},{value:J}));case"stkIDLE":case"stkIDLEAfterIncrease":return(0,m.jsx)(o.Amount,(0,a.Z)((0,a.Z)({textStyle:"titleSmall",color:"primary",suffix:" stkIDLE"},S),{},{value:y}));case"stakingApy":if(!j)return null;var Q=(0,u.d5)(h).times(j.maxApr);return(0,m.jsx)(o.Amount.Percentage,(0,a.Z)((0,a.Z)({textStyle:"titleSmall",color:"primary"},S),{},{value:Q}));default:return null}},f=function(e){var t,n=(0,c.w)().selectors.selectVaultById,i=e.assetId,r=e.action,o=(0,s.useMemo)((function(){return i&&n&&n(i)}),[i,n]),u=(0,s.useMemo)((function(){return(null===o||void 0===o?void 0:o.type)&&l.A[o.type]}),[o]);if(null===u||void 0===u||null===(t=u.dynamicActionFields)||void 0===t||!t[r])return null;var p=null===u||void 0===u?void 0:u.dynamicActionFields[r];return(0,m.jsx)(v.gC,{spacing:2,width:"100%",children:p.map((function(t){return(0,m.jsxs)(v.Ug,{pb:2,px:4,width:"100%",alignItems:"center",borderBottom:"1px solid",borderBottomColor:"divider",justifyContent:"space-between",children:[(0,m.jsx)(d.Translation,{component:v.xv,translation:"dynamicActionFields.".concat(t),textStyle:"captionSmall"}),(0,m.jsx)(x,(0,a.Z)((0,a.Z)({},e),{},{field:t}))]},"dynamicField_".concat(t))}))})}}}]);