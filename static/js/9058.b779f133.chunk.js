"use strict";(self.webpackChunkidle_dashboard_new=self.webpackChunkidle_dashboard_new||[]).push([[9058],{59058:function(t,n,e){e.r(n),e.d(n,{Unstake:function(){return S}});var i=e(74165),a=e(15861),o=e(813),s=e(42828),r=e(33482),l=e(55967),c=e(82172),d=e(7276),u=e(43127),x=e(3498),p=e(15542),h=e(1669),g=e(23023),m=e(78951),v=e(53465),f=e(86393),k=e(75712),w=e(20910),j=e(45263),S=function(t){var n,e,S,C=t.itemIndex,y=t.chainIds,T=void 0===y?[]:y,E=(0,k.useAssetProvider)(),M=E.asset,b=E.vault,A=(0,c.Y)(),z=A.account,P=A.setChainId,W=A.checkChainEnabled,I=(0,v.useOperativeComponent)(),Z=I.dispatch,_=I.activeItem,F=I.setActionIndex,D=(0,h.w)(),L=D.stakingData,U=D.selectors.selectVaultPrice,N=(0,g.R)(),Y=N.sendTransaction,O=N.setGasLimit,B=N.state.block,G=(0,d.useMemo)((function(){return W(T)}),[T,W]),H=(0,d.useMemo)((function(){var t;return(0,w.d5)(null===L||void 0===L||null===(t=L.position)||void 0===t?void 0:t.deposited)}),[L]),q=(0,d.useMemo)((function(){var t,n;return!(null===L||void 0===L||null===(t=L.position)||void 0===t||!t.lockEnd||!B)&&(0,w.qF)(null===L||void 0===L||null===(n=L.position)||void 0===n?void 0:n.lockEnd).isSameOrBefore((0,w.qF)(1e3*B.timestamp))}),[L,B]),K=(0,d.useMemo)((function(){var t,n;return null!==L&&void 0!==L&&null!==(t=L.position)&&void 0!==t&&t.lockEnd?(0,w.p6)(null===L||void 0===L||null===(n=L.position)||void 0===n?void 0:n.lockEnd,"YYYY-MM-DD HH:mm",!0):null}),[L]),R=(0,d.useCallback)((function(){z&&q&&b&&"getWithdrawContractSendMethod"in b&&"getWithdrawParams"in b&&b instanceof r.y&&(0,a.Z)((0,i.Z)().mark((function t(){var n,e;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=b.getWithdrawParams(),e=b.getWithdrawContractSendMethod(n),Y(b.id,b.id,e);case 3:case"end":return t.stop()}}),t)})))()}),[z,q,b,Y]),V=(0,d.useCallback)((0,a.Z)((0,i.Z)().mark((function t(){var n,e,a,o,s;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(b&&"getWithdrawContractSendMethod"in b&&"getWithdrawParams"in b&&b instanceof r.y){t.next=2;break}return t.abrupt("return");case 2:if(n=b.getMethodDefaultGasLimit("unstake"),z&&q){t.next=5;break}return t.abrupt("return",n);case 5:return e={from:null===z||void 0===z?void 0:z.address},a=b.getWithdrawParams(),o=b.getWithdrawContractSendMethod(a),t.next=10,(0,w.$K)(o,e);case 10:if(t.t0=t.sent,t.t0){t.next=13;break}t.t0=n;case 13:return s=t.t0,t.abrupt("return",s);case 15:case"end":return t.stop()}}),t)}))),[z,b,q]);(0,d.useEffect)((function(){_===C&&(0,a.Z)((0,i.Z)().mark((function t(){var n;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,V();case 2:n=t.sent,O(n);case 4:case"end":return t.stop()}}),t)})))()}),[_,C,V,O]),(0,d.useEffect)((function(){_===C&&(Z({type:"SET_ASSET",payload:M}),U&&b&&(Z({type:"SET_AMOUNT",payload:(0,w.gA)(H).toString()}),Z({type:"SET_DEFAULT_AMOUNT",payload:(0,w.gA)(H).toString()})))}),[b,M,H,U,_,C,Z,R]);var $=(0,d.useMemo)((function(){return z?(0,j.jsx)(p.Translation,{component:u.zx,translation:"common.withdraw",disabled:!q,onClick:R,variant:"ctaFull"}):(0,j.jsx)(f.ConnectWalletButton,{variant:"ctaFull"})}),[z,q,R]);return(0,j.jsx)(k.AssetProvider,{flex:1,width:"100%",assetId:null===M||void 0===M?void 0:M.id,children:(0,j.jsxs)(x.gC,{flex:1,spacing:6,width:"100%",height:"100%",id:"withdraw-container",alignItems:"space-between",justifyContent:"flex-start",pt:G&&null!==L&&void 0!==L&&null!==(n=L.position)&&void 0!==n&&n.lockEnd?8:0,children:[(0,j.jsx)(x.gC,{flex:1,spacing:0,id:"confirm-on-wallet",alignItems:"flex-start",children:G?null!==L&&void 0!==L&&null!==(e=L.position)&&void 0!==e&&e.lockEnd?q?(0,j.jsx)(x.M5,{py:14,flex:1,px:[4,10],width:"100%",children:(0,j.jsxs)(x.gC,{spacing:6,children:[(0,j.jsx)(l.ppH,{size:72}),(0,j.jsxs)(x.gC,{spacing:4,children:[(0,j.jsx)(p.Translation,{component:x.xv,translation:"staking.lockExpired",textStyle:"heading",fontSize:"h3",textAlign:"center"}),(0,j.jsx)(p.Translation,{component:x.xv,translation:"staking.canWithdrawLock",params:{amount:(0,w.dm)(H),asset:null===M||void 0===M?void 0:M.name},textStyle:"captionSmall",textAlign:"center"})]})]})}):(0,j.jsxs)(x.gC,{py:20,flex:1,spacing:6,px:[6,10],width:"100%",children:[(0,j.jsx)(l.FKe,{size:72}),(0,j.jsxs)(x.gC,{spacing:4,children:[(0,j.jsx)(p.Translation,{component:x.xv,translation:"staking.lockNotExpired",textStyle:"heading",fontSize:"h3",textAlign:"center"}),(0,j.jsx)(p.Translation,{component:x.xv,translation:"staking.waitUntilLockExpired",params:{lockEndDate:K},textStyle:"captionSmall",textAlign:"center"}),(0,j.jsx)(p.Translation,{component:u.zx,translation:"staking.increaseLock",onClick:function(){return F(0)},variant:"ctaPrimary",px:10})]})]}):(0,j.jsx)(x.M5,{px:6,flex:1,width:"100%",children:(0,j.jsxs)(x.gC,{spacing:5,children:[(0,j.jsx)(p.Translation,{component:x.xv,translation:"staking.noStake",textStyle:"heading",fontSize:"h3",textAlign:"center"}),(0,j.jsx)(p.Translation,{component:x.xv,translation:"staking.stakeBeforeUnstake",textStyle:"captionSmall",textAlign:"center"}),(0,j.jsx)(p.Translation,{component:u.zx,translation:"common.stake",onClick:function(){return F(0)},variant:"ctaPrimary",px:10})]})}):(0,j.jsx)(x.M5,{px:10,flex:1,width:"100%",children:(0,j.jsxs)(x.gC,{spacing:6,children:[(0,j.jsx)(s.p8b,{size:72}),(0,j.jsxs)(x.gC,{spacing:4,children:[(0,j.jsx)(p.Translation,{component:x.xv,translation:"staking.networkNotSupported",textStyle:"heading",fontSize:"h3",textAlign:"center"}),(0,j.jsx)(p.Translation,{component:x.xv,translation:"staking.switchToMainnet",textStyle:"captionSmall",textAlign:"center"}),(0,j.jsx)(p.Translation,{component:u.zx,translation:"common.switchNetwork",onClick:function(){return P(o.zS)},variant:"ctaPrimary",px:10})]})]})})}),(null===L||void 0===L||null===(S=L.position)||void 0===S?void 0:S.lockEnd)&&q&&(0,j.jsxs)(x.gC,{spacing:4,id:"footer",alignItems:"flex-start",children:[q&&(0,j.jsx)(m.EstimatedGasFees,{}),$]})]})})}}}]);