"use strict";(self.webpackChunkidle_dashboard_new=self.webpackChunkidle_dashboard_new||[]).push([[4872],{54872:function(t,e,a){a.r(e),a.d(e,{BalanceChart:function(){return m},BalanceChartProvider:function(){return b},useBalanceChartProvider:function(){return v}});var n=a(1413),r=a(93433),o=a(20910),i=a(45327),l=a(3498),s=a(86059),u=a(66288),c=a(7276),d=a(15034),f=a(45263),h=(0,c.createContext)({assets:[],balanceChartData:{total:[],rainbow:[]},balanceChartDataLoading:!1}),v=function(){return(0,c.useContext)(h)};function b(t){var e=t.children,a=t.assetIds,n=t.accountId,r=t.timeframe,o=t.strategies,i=t.allowFlatChart,l=void 0===i||i,s=(0,d.k)({assetIds:a,accountId:n,timeframe:r,strategies:o,allowFlatChart:l});return(0,f.jsx)(h.Provider,{value:s,children:e})}var m=function(t){var e=t.isRainbowChart,a=t.height,n=void 0===a?"350px":a,r=t.setPercentChange,s=t.maxMinEnabled,u=void 0===s||s,d=t.loadingEnabled,h=void 0===d||d,b=t.color,m=void 0===b?"chart.stroke":b,g=t.gradientEnabled,p=void 0===g||g,C=t.margins,x=void 0===C?{top:0,right:0,bottom:0,left:0}:C,y=v(),w=y.balanceChartData,k=y.balanceChartDataLoading,j=w.total;(0,c.useEffect)((function(){return r((0,o.gB)(j))}),[j,r]);return(0,f.jsx)(l.xu,{width:"full",p:0,height:n,children:(0,f.jsx)(i.Graph,{color:m,margins:x,formatFn:function(t){return"$".concat((0,o.dm)(t))},data:w,maxMinEnabled:u,isRainbowChart:e,gradientEnabled:p,isLoaded:!k,loading:k&&h})})};b.BalanceChart=m,b.BalanceChangeUsd=function(t){var e=v().balanceChartData,a=(0,o.d5)(e.total[0].value),i=(0,o.d5)((0,r.Z)(e.total).pop().value).minus(a),l=i.lt(0)?"loss":"gain",u=i.gt(0)?"+":"";return(0,f.jsx)(s.Amount.Usd,(0,n.Z)({prefix:u,value:i,color:l},t))},b.BalanceChangePercentage=function(t){var e=(0,u.X)().theme,a=v().balanceChartData,i=(0,o.d5)(a.total[0].value),c=(0,o.d5)((0,r.Z)(a.total).pop().value),d=i.gt(0)?c.div(i).minus(1).times(100):(0,o.d5)(0),h=d.lt(0)?"loss":"gain",b=d.gt(0)?"+":"";return(0,f.jsx)(l.xu,{py:"3px",px:2,bgColor:"".concat(e.colors[h],"20"),children:(0,f.jsx)(s.Amount.Percentage,(0,n.Z)({prefix:b,value:d,color:h},t))})}},15034:function(t,e,a){a.d(e,{k:function(){return d}});var n=a(1413),r=a(29439),o=a(66549),i=a.n(o),l=a(5128),s=a(7276),u=a(1669),c=a(20910),d=function(t){var e=t.assetIds,a=t.strategies,o=t.timeframe,d=t.allowFlatChart,f=void 0!==d&&d,h=t.useDollarConversion,v=void 0===h||h,b=(0,u.w)(),m=b.isPortfolioLoaded,g=b.historicalPrices,p=b.historicalPricesUsd,C=b.selectors,x=C.selectAssetsByIds,y=C.selectVaultTransactions,w=C.selectAssetHistoricalPriceByTimestamp,k=C.selectAssetHistoricalPriceUsdByTimestamp,j=(0,s.useState)(!0),D=(0,r.Z)(j,2),A=D[0],O=D[1],P=(0,s.useMemo)((function(){return x?x(e).filter((function(t){return!a||!t.type||a.includes(t.type)})):[]}),[e,a,x]),B=(0,s.useMemo)((function(){return o?(0,c.pM)(o):0}),[o]),E=(0,s.useMemo)((function(){var t={total:[],rainbow:[]};if(!m||(0,c.xb)(g)||(0,c.xb)(p))return t;var e=P.reduce((function(t,e){if(null===e||void 0===e||!e.id)return t;var a=e.id,n=y(a);if(!n.length)return t;var r=n.reduce((function(t,e){var a=+i()(1e3*+e.timeStamp).startOf("day").valueOf();switch(e.action){case"deposit":t.total=t.total.plus(e.idleAmount);break;case"redeem":t.total=l.Z.maximum(0,t.total.minus(e.idleAmount))}return t.byDate[a]=t.total,t}),{total:(0,c.gA)(0),byDate:{}});return Object.keys(r.byDate).forEach((function(a){t[a]||(t[a]={}),e.id&&(t[a][e.id]=parseFloat(r.byDate[a].toFixed(8)))})),t}),{});if((0,c.xb)(e)){if(!f)return t;e[B]=0}for(var a=+Object.keys(e).sort()[0],r=+i()().endOf("day").valueOf(),o=(0,c.Up)(a,r),s={},u=0,d=null;u<o.length;u++){var h=o[u];s[h]=(0,n.Z)((0,n.Z)({},d?s[d]:{}),e[h]),d=h}var b={},C={};return Object.keys(s).forEach((function(t){var e=s[t];Object.keys(e).forEach((function(a){var n=P.find((function(t){return t.id===a})),r=null===n||void 0===n?void 0:n.underlyingId,o=w(a,t)||b[a];if(o&&(e[a]=parseFloat((0,c.gA)(e[a]).times((0,c.gA)(o.value)).toFixed(8)),b[a]=o),v){var i=k(r,t)||C[a];i&&(e[a]=parseFloat((0,c.gA)(e[a]).times((0,c.gA)(i.value)).toFixed(8)),C[a]=i)}})),e.total=Object.values(e).reduce((function(t,e){return t+e}),0)})),t.total=Object.keys(s).reduce((function(t,e){return e<B||t.push({date:parseInt(e),value:s[e].total}),t}),[]),t.rainbow=Object.keys(s).reduce((function(t,e){return e<B||t.push((0,n.Z)({date:parseInt(e),total:s[e].total},s[e])),t}),[]),t}),[P,v,B,y,m,g,p,w,k]);return(0,s.useEffect)((function(){if(E.rainbow.length)return O(!1),function(){O(!0)}}),[E]),{assets:P,balanceChartData:E,balanceChartDataLoading:A}}}}]);