"use strict";(self.webpackChunkidle_dashboard_new=self.webpackChunkidle_dashboard_new||[]).push([[4872],{54872:function(t,e,a){a.r(e),a.d(e,{BalanceChart:function(){return c}});var r=a(3498),n=a(7276),i=a(45327),o=a(99594),s=a(15034),u=a(45263),c=function(t){var e=t.assetIds,a=t.accountId,c=t.timeframe,l=t.strategies,d=t.isRainbowChart,f=t.setPercentChange,h=t.allowFlatChart,v=void 0===h||h,b=t.color,m=void 0===b?"chart.stroke":b,p=t.loadingEnabled,g=void 0===p||p,y=t.margins,w=void 0===y?{top:0,right:0,bottom:0,left:0}:y,k=(0,s.k)({assetIds:e,accountId:a,timeframe:c,strategies:l,allowFlatChart:v}),C=k.balanceChartData,x=k.balanceChartDataLoading,O=C.total;(0,n.useEffect)((function(){return f((0,o.gB)(O))}),[O,f]);return(0,u.jsx)(r.xu,{width:"full",p:0,height:"350px",children:(0,u.jsx)(i.Graph,{color:m,margins:w,formatFn:function(t){return"$".concat((0,o.dm)(t))},data:C,isRainbowChart:d,isLoaded:!x,loading:x&&g})})}},15034:function(t,e,a){a.d(e,{k:function(){return d}});var r=a(1413),n=a(29439),i=a(66549),o=a.n(i),s=a(5128),u=a(7276),c=a(1669),l=a(99594),d=function(t){var e=t.assetIds,a=t.strategies,i=t.timeframe,d=t.allowFlatChart,f=void 0!==d&&d,h=t.useDollarConversion,v=void 0===h||h,b=(0,c.w)(),m=b.isPortfolioLoaded,p=b.historicalPrices,g=b.historicalPricesUsd,y=b.selectors,w=y.selectAssetsByIds,k=y.selectVaultTransactions,C=y.selectAssetHistoricalPriceByTimestamp,x=y.selectAssetHistoricalPriceUsdByTimestamp,O=(0,u.useState)(!0),A=(0,n.Z)(O,2),F=A[0],j=A[1],D=(0,u.useMemo)((function(){return w?w(e).filter((function(t){return!a||!t.type||a.includes(t.type)})):[]}),[e,a,w]),I=(0,u.useMemo)((function(){return i?(0,l.pM)(i):0}),[i]),E=(0,u.useMemo)((function(){var t={total:[],rainbow:[]};if(!m||(0,l.xb)(p)||(0,l.xb)(g))return t;var e=D.reduce((function(t,e){if(null===e||void 0===e||!e.id)return t;var a=e.id,r=k(a);if(!r.length)return t;var n=r.reduce((function(t,e){var a=+o()(1e3*+e.timeStamp).startOf("day").valueOf();switch(e.action){case"deposit":t.total=t.total.plus(e.idleAmount);break;case"redeem":t.total=s.Z.maximum(0,t.total.minus(e.idleAmount))}return t.byDate[a]=t.total,t}),{total:(0,l.gA)(0),byDate:{}});return Object.keys(n.byDate).forEach((function(a){t[a]||(t[a]={}),e.id&&(t[a][e.id]=parseFloat(n.byDate[a].toFixed(8)))})),t}),{});if((0,l.xb)(e)){if(!f)return t;e[I]=0}for(var a=+Object.keys(e).sort()[0],n=+o()().endOf("day").valueOf(),i=(0,l.Up)(a,n),u={},c=0,d=null;c<i.length;c++){var h=i[c];u[h]=(0,r.Z)((0,r.Z)({},d?u[d]:{}),e[h]),d=h}var b={},y={};return Object.keys(u).forEach((function(t){var e=u[t];Object.keys(e).forEach((function(a){var r=D.find((function(t){return t.id===a})),n=null===r||void 0===r?void 0:r.underlyingId,i=C(a,t)||b[a];if(i&&(e[a]=parseFloat((0,l.gA)(e[a]).times((0,l.gA)(i.value)).toFixed(8)),b[a]=i),v){var o=x(n,t)||y[a];o&&(e[a]=parseFloat((0,l.gA)(e[a]).times((0,l.gA)(o.value)).toFixed(8)),y[a]=o)}})),e.total=Object.values(e).reduce((function(t,e){return t+e}),0)})),t.total=Object.keys(u).reduce((function(t,e){return e<I||t.push({date:parseInt(e),value:u[e].total}),t}),[]),t.rainbow=Object.keys(u).reduce((function(t,e){return e<I||t.push((0,r.Z)({date:parseInt(e),total:u[e].total},u[e])),t}),[]),t}),[D,v,I,k,m,p,g,C,x]);return(0,u.useEffect)((function(){if(E.rainbow.length)return j(!1),function(){j(!0)}}),[E]),{assets:D,balanceChartData:E,balanceChartDataLoading:F}}}}]);